<!DOCTYPE html>
<html>
<head>
  <title>angular-ux-datagrid.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="doc-style.css" />
  <script src="doc-filelist.js"></script>
  <script>
    var relativeDir = "", thisFile = "Users/wes/PhpstormProjects/wes/webux/ux-datagrid//angular-ux-datagrid.js", defaultSidebar = true;
  </script>
  <script src="doc-script.js"></script>
</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">
      <div class="heading h2">
        <a href="#configs">Configs</a>
      </div>
      <div class="heading h3">
        <a href="#isios">isIOS</a>
      </div>
      <div class="heading h3">
        <a href="#states">states</a>
      </div>
      <div class="heading h3">
        <a href="#events">events</a>
      </div>
      <div class="heading h4">
        <a href="#notifying%20events">Notifying Events</a>
      </div>
      <div class="heading h4">
        <a href="#driving%20events">Driving Events</a>
      </div>
      <div class="heading h4">
        <a href="#log%20events">Log Events</a>
      </div>
      <div class="heading h3">
        <a href="#options">options</a>
      </div>
      <div class="heading h3">
        <a href="#coreaddons">coreAddons</a>
      </div>
      <div class="heading h3">
        <a href="#addons">addons</a>
      </div>
      <div class="heading h2">
        <a href="#ux.css">ux.CSS</a>
      </div>
      <div class="heading h2">
        <a href="#ux.each">ux.each</a>
      </div>
      <div class="heading h3">
        <a href="#extend">extend</a>
      </div>
      <div class="heading h2">
        <a href="#datagrid%20directive">Datagrid Directive</a>
      </div>
      <div class="heading h3">
        <a href="#init">init</a>
      </div>
      <div class="heading h3">
        <a href="#setupexports">setupExports</a>
      </div>
      <div class="heading h3">
        <a href="#createconent">createConent</a>
      </div>
      <div class="heading h3">
        <a href="#getclassesfromoldcontent">getClassesFromOldContent</a>
      </div>
      <div class="heading h3">
        <a href="#filteroldcontent">filterOldContent</a>
      </div>
      <div class="heading h3">
        <a href="#getcontent">getContent</a>
      </div>
      <div class="heading h3">
        <a href="#start">start</a>
      </div>
      <div class="heading h3">
        <a href="#waitforelementready">waitForElementReady</a>
      </div>
      <div class="heading h3">
        <a href="#addlisteners">addListeners</a>
      </div>
      <div class="heading h3">
        <a href="#setupchangewatcher">setupChangeWatcher</a>
      </div>
      <div class="heading h3">
        <a href="#ondatachangefromwatcher">onDataChangeFromWatcher</a>
      </div>
      <div class="heading h3">
        <a href="#updateviewportheight">updateViewportHeight</a>
      </div>
      <div class="heading h3">
        <a href="#isready">isReady</a>
      </div>
      <div class="heading h3">
        <a href="#calculateviewportheight">calculateViewportHeight</a>
      </div>
      <div class="heading h3">
        <a href="#onresize">onResize</a>
      </div>
      <div class="heading h2">
        <a href="#swapitem">swapItem</a>
      </div>
      <div class="heading h3">
        <a href="#getscope">getScope</a>
      </div>
      <div class="heading h3">
        <a href="#getrowitem">getRowItem</a>
      </div>
      <div class="heading h3">
        <a href="#getrowelm">getRowElm</a>
      </div>
      <div class="heading h3">
        <a href="#iscompiled">isCompiled</a>
      </div>
      <div class="heading h3">
        <a href="#getrowindex">getRowIndex</a>
      </div>
      <div class="heading h3">
        <a href="#getrowindexfromelement">getRowIndexFromElement</a>
      </div>
      <div class="heading h3">
        <a href="#getrowoffset">getRowOffset</a>
      </div>
      <div class="heading h3">
        <a href="#getrowheight">getRowHeight</a>
      </div>
      <div class="heading h3">
        <a href="#getviewportheight">getViewportHeight</a>
      </div>
      <div class="heading h3">
        <a href="#getcontentheight">getContentHeight</a>
      </div>
      <div class="heading h3">
        <a href="#createdom">createDom</a>
      </div>
      <div class="heading h3">
        <a href="#compilerow">compileRow</a>
      </div>
      <div class="heading h3">
        <a href="#buildrows">buildRows</a>
      </div>
      <div class="heading h3">
        <a href="#ready">ready</a>
      </div>
      <div class="heading h3">
        <a href="#firereadyevent">fireReadyEvent</a>
      </div>
      <div class="heading h3">
        <a href="#safedigest">safeDigest</a>
      </div>
      <div class="heading h3">
        <a href="#applyeventcounts">applyEventCounts</a>
      </div>
      <div class="heading h3">
        <a href="#addevents">addEvents</a>
      </div>
      <div class="heading h3">
        <a href="#addevent">addEvent</a>
      </div>
      <div class="heading h3">
        <a href="#subtractevents">subtractEvents</a>
      </div>
      <div class="heading h3">
        <a href="#subtractevent">subtractEvent</a>
      </div>
      <div class="heading h3">
        <a href="#deactivatescope">deactivateScope</a>
      </div>
      <div class="heading h3">
        <a href="#activatescope">activateScope</a>
      </div>
      <div class="heading h3">
        <a href="#isactive">isActive</a>
      </div>
      <div class="heading h3">
        <a href="#getoffsetindex">getOffsetIndex</a>
      </div>
      <div class="heading h3">
        <a href="#getstartingindex">getStartingIndex</a>
      </div>
      <div class="heading h3">
        <a href="#updateheightvalues">updateHeightValues</a>
      </div>
      <div class="heading h3">
        <a href="#updaterowwatchers">updateRowWatchers</a>
      </div>
      <div class="heading h3">
        <a href="#deactivatelist">deactivateList</a>
      </div>
      <div class="heading h3">
        <a href="#updatelinks">updateLinks</a>
      </div>
      <div class="heading h3">
        <a href="#resetminmax">resetMinMax</a>
      </div>
      <div class="heading h3">
        <a href="#updateminmax">updateMinMax</a>
      </div>
      <div class="heading h3">
        <a href="#beforerenderafterdatachange">beforeRenderAfterDataChange</a>
      </div>
      <div class="heading h3">
        <a href="#afterrenderafterdatachange">afterRenderAfterDataChange</a>
      </div>
      <div class="heading h3">
        <a href="#readytorender">readyToRender</a>
      </div>
      <div class="heading h3">
        <a href="#render">render</a>
      </div>
      <div class="heading h3">
        <a href="#update">update</a>
      </div>
      <div class="heading h3">
        <a href="#dirtycheckdata">dirtyCheckData</a>
      </div>
      <div class="heading h3">
        <a href="#dirtycheckitemtemplate">dirtyCheckItemTemplate</a>
      </div>
      <div class="heading h3">
        <a href="#mapdata">mapData</a>
      </div>
      <div class="heading h3">
        <a href="#updatescope">updateScope</a>
      </div>
      <div class="heading h3">
        <a href="#ondatachanged">onDataChanged</a>
      </div>
      <div class="heading h3">
        <a href="#reset">reset</a>
      </div>
      <div class="heading h3">
        <a href="#forcerenderscope">forceRenderScope</a>
      </div>
      <div class="heading h3">
        <a href="#onrowtemplatechange">onRowTemplateChange</a>
      </div>
      <div class="heading h3">
        <a href="#updateheights">updateHeights</a>
      </div>
      <div class="heading h3">
        <a href="#islogevent">isLogEvent</a>
      </div>
      <div class="heading h3">
        <a href="#dispatch">dispatch</a>
      </div>
      <div class="heading h3">
        <a href="#destroyscopes">destroyScopes</a>
      </div>
      <div class="heading h3">
        <a href="#destroy">destroy</a>
      </div>
      <div class="heading h3">
        <a href="#uxdatagrid">uxDatagrid</a>
      </div>
      <div class="heading h3">
        <a href="#chunkmodel">chunkModel</a>
      </div>
      <div class="heading h3">
        <a href="#updateallchunkheights">updateAllChunkHeights</a>
      </div>
      <div class="heading h3">
        <a href="#getarrayfromindexes">getArrayFromIndexes</a>
      </div>
      <div class="heading h3">
        <a href="#getitembyindexes">getItemByIndexes</a>
      </div>
      <div class="heading h3">
        <a href="#getdomrowbyindexes">getDomRowByIndexes</a>
      </div>
      <div class="heading h3">
        <a href="#unrendered">unrendered</a>
      </div>
      <div class="heading h2">
        <a href="#computedstyles">computedStyles</a>
      </div>
      <div class="heading h2">
        <a href="#checkallcompiled">checkAllCompiled</a>
      </div>
      <div class="heading h2">
        <a href="#iscompiled">isCompiled</a>
      </div>
      <div class="heading h3">
        <a href="#reset">reset</a>
      </div>
      <div class="heading h2">
        <a href="#disablenonvisiblechunks">disableNonVisibleChunks</a>
      </div>
      <div class="heading h3">
        <a href="#destroy">destroy</a>
      </div>
      <div class="heading h4">
        <a href="#chunkarray">ChunkArray</a>
      </div>
      <div class="heading h5">
        <a href="#chunkarray.prototype.getchildstr">ChunkArray.prototype.getChildStr</a>
      </div>
      <div class="heading h5">
        <a href="#updateheight">updateHeight</a>
      </div>
      <div class="heading h5">
        <a href="#calculatetop">calculateTop</a>
      </div>
      <div class="heading h5">
        <a href="#forceheightrecal">forceHeightReCal</a>
      </div>
      <div class="heading h5">
        <a href="#setdirtyheight">setDirtyHeight</a>
      </div>
      <div class="heading h5">
        <a href="#getid">getId</a>
      </div>
      <div class="heading h5">
        <a href="#destroy">destroy</a>
      </div>
      <div class="heading h3">
        <a href="#normalize">normalize</a>
      </div>
      <div class="heading h3">
        <a href="#setdata">setData</a>
      </div>
      <div class="heading h3">
        <a href="#getdata">getData</a>
      </div>
      <div class="heading h3">
        <a href="#getoriginaldata">getOriginalData</a>
      </div>
      <div class="heading h2">
        <a href="#getoriginalindexofitem">getOriginalIndexOfItem</a>
      </div>
      <div class="heading h3">
        <a href="#finditem">findItem</a>
      </div>
      <div class="heading h3">
        <a href="#getnormalizedindex">getNormalizedIndex</a>
      </div>
      <div class="heading h3">
        <a href="#replace">replace</a>
      </div>
      <div class="heading h3">
        <a href="#destroy">destroy</a>
      </div>
      <div class="heading h2">
        <a href="#templatemodel">templateModel</a>
      </div>
      <div class="heading h3">
        <a href="#gettemplate">getTemplate</a>
      </div>
    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container"><div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
      <tr>
        <td class="docs">
          <h1>angular-ux-datagrid.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>uxDatagrid v.1.0.0
(c) 2014, WebUX
<a href='https://github.com/webux/ux-angularjs-datagrid'>https://github.com/webux/ux-angularjs-datagrid</a>
License: MIT.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">exports</span><span class="p">,</span> <span class="nx">global</span><span class="p">){</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">errors</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">E1000</span><span class="o">:</span> <span class="s2">&quot;Datagrid cannot have a height of 0&quot;</span><span class="p">,</span>
    <span class="nx">E1001</span><span class="o">:</span> <span class="s2">&quot;RENDER STATE INVALID. The only valid render states are those on ux.datagrid.states&quot;</span><span class="p">,</span>
    <span class="nx">E1002</span><span class="o">:</span> <span class="s2">&quot;Unable to render. Invalid activeRange.&quot;</span><span class="p">,</span>
    <span class="nx">E1101</span><span class="o">:</span> <span class="s2">&quot;Script templates that are used for datagrid rows must have a height greater than 0. This may be because the grid is not yet attached to the dom preventing it from calculating heights.&quot;</span><span class="p">,</span>
    <span class="nx">E1102</span><span class="o">:</span> <span class="s2">&quot;at least one template is required. There were no row templates found for the datagrid.&quot;</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="configs">
  <h2>
    <a href="#configs" name="configs" class="pilcrow">&#182;</a>
    Configs
  </h2>
</div>


<p>ux.datagrid is a highly performant scrolling list for desktop and mobile devices that leverages
the browsers ability to gpu cache the dom structure with fast startup times and optimized rendering
that allows the gpu to maintain its snapshots as long as possible.</p>
  </div>
  <div class="body"><p>Create the default module of ux if it doesn't already exist.</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="kd">var</span> <span class="nx">module</span><span class="p">,</span> <span class="nx">isIOS</span> <span class="o">=</span> <span class="o">!!</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/(iPad|iPhone|iPod)/g</span><span class="p">);</span>

<span class="k">try</span> <span class="p">{</span>
    <span class="nx">module</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s2">&quot;ux&quot;</span><span class="p">,</span> <span class="p">[</span> <span class="s2">&quot;ng&quot;</span> <span class="p">]);</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">module</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s2">&quot;ux&quot;</span><span class="p">);</span>
<span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>Create the datagrid namespace.
add the default options for the datagrid. These can be overridden by passing your own options to each
instance of the grid. In your HTML templates you can provide the object that will override these settings
on a per grid basis.</p>
  </div>
  <div class="body"><div ux-datagrid="mylist"
         options="{debug:{all:1, Flow:0}}">...</div>

<p>These options are then available to other addons to configure them.</p>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span> <span class="o">=</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="isios">
  <h3>
    <a href="#isios" name="isios" class="pilcrow">&#182;</a>
    <a name="isIOS">isIOS</a>
  </h3>
</div>


<p>iOS does not natively support smooth scrolling without a css attribute. <code>-webkit-overflow-scrolling: touch</code>
however with this attribute iOS would crash if you try to change the scroll with javascript, or turn it on and off.
So a <a href="#virtualScroll">virtualScroll</a> was implemented for iOS to make it scroll using translate3d.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">isIOS</span><span class="o">:</span> <span class="nx">isIOS</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="states">
  <h3>
    <a href="#states" name="states" class="pilcrow">&#182;</a>
    <a name="states">states</a>
  </h3>
</div>


<ul>
<li><strong><a name="states.BUILDING">BUILDING</a></strong>: is the startup phase of the grid before it is ready to perform the first render. This may include
waiting for the dom heights be available.</li>
<li><strong><a name="states.ON_READY">ON_READY</a></strong>: this means that the grid is ready for rendering.</li>
</ul>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">states</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">BUILDING</span><span class="o">:</span> <span class="s2">&quot;datagrid:building&quot;</span><span class="p">,</span>
        <span class="nx">READY</span><span class="o">:</span> <span class="s2">&quot;datagrid:ready&quot;</span>
    <span class="p">},</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="events">
  <h3>
    <a href="#events" name="events" class="pilcrow">&#182;</a>
    <a name="events">events</a>
  </h3>
</div>


<p>The events are in three categories based on if they notify of something that happened in the grid then they
start with an ON_ or if they are driving the behavior of the datagrid, or they are logging events.</p>


<div class="pilwrap" id="notifying%20events">
  <h4>
    <a href="#notifying%20events" name="notifying%20events" class="pilcrow">&#182;</a>
    Notifying Events
  </h4>
</div>


<ul>
<li><strong><a name="events.ON_INIT">ON_INIT</a></strong> when the datagrid has added the addons and is now starting.</li>
<li><strong><a name="events.ON_LISTENERS_READY">ON_LISTENERS_READY</a></strong> Datagrid is now listening. Feel free to fire your events that direct it's behavior.</li>
<li><strong><a name="events.ON_READY">ON_READY</a></strong> the datagrid is all setup with templates, viewHeight, and data and is ready to render.</li>
<li><strong><a name="events.ON_STARTUP_COMPLETE">ON_STARTUP_COMPLETE</a></strong> when the datagrid has finished its first render.</li>
<li><strong><a name="events.ON_BEFORE_RENDER">ON_BEFORE_RENDER</a></strong> the datagrid is just about to add needed chunks, perform compiling of uncompiled rows, and update and digest the active scopes.</li>
<li><strong><a name="events.ON_AFTER_RENDER">ON_AFTER_RENDER</a></strong> chunked dome was added if needed, active rows are compiled, and active scopes are digested.</li>
<li><strong><a name="events.ON_BEFORE_UPDATE_WATCHERS">ON_BEFORE_UPDATE_WATCHERS</a></strong> Before the active set of watchers is changed.</li>
<li><strong><a name="events.ON_AFTER_UPDATE_WATCHERS">ON_AFTER_UPDATE_WATCHERS</a></strong> After the active set of watchers is changed and digested and activeRange is updated.</li>
<li><strong><a name="events.ON_BEFORE_DATA_CHANGE">ON_BEFORE_DATA_CHANGE</a></strong> A data change watcher has fired. The change has not happened yet.</li>
<li><strong><a name="events.ON_BEFORE_RENDER_AFTER_DATA_CHANGE">ON_BEFORE_RENDER_AFTER_DATA_CHANGE</a></strong> When ever a data change is fired. Just before the render happens.</li>
<li><strong><a name="events.ON_RENDER_AFTER_DATA_CHANGE">ON_RENDER_AFTER_DATA_CHANGE</a></strong> When a render finishes and a data change was what caused it.</li>
<li><strong><a name="events.ON_ROW_TEMPLATE_CHANGE">ON_ROW_TEMPLATE_CHANGE</a></strong> When we change the template that is matched with the row.</li>
<li><strong><a name="events.ON_SCROLL">ON_SCROLL</a></strong> When a scroll change is captured by the datagrid.</li>
<li><strong><a name="events.ON_BEFORE_RESET">ON_BEFORE_RESET</a></strong> Before the dom is reset this event is fired. Every addon should listen to this event and clean up any listeners
that are necessary when this happens so the dom can be cleaned up for the reset.</li>
<li><strong><a name="events.ON_AFTER_RESET">ON_AFTER_RESET</a></strong> After the reset the listeners from the addon can be put back on allowing the reset data to have been completely cleared.</li>
</ul>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">ON_INIT</span><span class="o">:</span> <span class="s2">&quot;datagrid:onInit&quot;</span><span class="p">,</span>
        <span class="nx">ON_LISTENERS_READY</span><span class="o">:</span> <span class="s2">&quot;datagrid:onListenersReady&quot;</span><span class="p">,</span>
        <span class="nx">ON_READY</span><span class="o">:</span> <span class="s2">&quot;datagrid:onReady&quot;</span><span class="p">,</span>
        <span class="nx">ON_STARTUP_COMPLETE</span><span class="o">:</span> <span class="s2">&quot;datagrid:onStartupComplete&quot;</span><span class="p">,</span>
        <span class="nx">ON_BEFORE_RENDER</span><span class="o">:</span> <span class="s2">&quot;datagrid:onBeforeRender&quot;</span><span class="p">,</span>
        <span class="nx">ON_AFTER_RENDER</span><span class="o">:</span> <span class="s2">&quot;datagrid:onAfterRender&quot;</span><span class="p">,</span>
        <span class="nx">ON_BEFORE_UPDATE_WATCHERS</span><span class="o">:</span> <span class="s2">&quot;datagrid:onBeforeUpdateWatchers&quot;</span><span class="p">,</span>
        <span class="nx">ON_AFTER_UPDATE_WATCHERS</span><span class="o">:</span> <span class="s2">&quot;datagrid:onAfterUpdateWatchers&quot;</span><span class="p">,</span>
        <span class="nx">ON_BEFORE_DATA_CHANGE</span><span class="o">:</span> <span class="s2">&quot;datagrid:onBeforeDataChange&quot;</span><span class="p">,</span>
        <span class="nx">ON_AFTER_DATA_CHANGE</span><span class="o">:</span> <span class="s2">&quot;datagrid:onAfterDataChange&quot;</span><span class="p">,</span>
        <span class="nx">ON_BEFORE_RENDER_AFTER_DATA_CHANGE</span><span class="o">:</span> <span class="s2">&quot;datagrid:onBeforeRenderAfterDataChange&quot;</span><span class="p">,</span>
        <span class="nx">ON_RENDER_AFTER_DATA_CHANGE</span><span class="o">:</span> <span class="s2">&quot;datagrid:onRenderAfterDataChange&quot;</span><span class="p">,</span>
        <span class="nx">ON_ROW_TEMPLATE_CHANGE</span><span class="o">:</span> <span class="s2">&quot;datagrid:onRowTemplateChange&quot;</span><span class="p">,</span>
        <span class="nx">ON_SCROLL</span><span class="o">:</span> <span class="s2">&quot;datagrid:onScroll&quot;</span><span class="p">,</span>
        <span class="nx">ON_BEFORE_RESET</span><span class="o">:</span> <span class="s2">&quot;datagrid:onBeforeReset&quot;</span><span class="p">,</span>
        <span class="nx">ON_AFTER_RESET</span><span class="o">:</span> <span class="s2">&quot;datagrid:onAfterReset&quot;</span><span class="p">,</span>
        <span class="nx">ON_AFTER_HEIGHTS_UPDATED</span><span class="o">:</span> <span class="s2">&quot;datagrid:onAfterHeightsUpdated&quot;</span><span class="p">,</span>
        <span class="nx">ON_AFTER_HEIGHTS_UPDATED_RENDER</span><span class="o">:</span> <span class="s2">&quot;datagrid:onAfterHeightsUpdatedRender&quot;</span><span class="p">,</span>
        <span class="nx">ON_BEFORE_ROW_DEACTIVATE</span><span class="o">:</span> <span class="s2">&quot;datagrid:onBeforeRowDeactivate&quot;</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7">&#182;</a>
</div>
<p>handy for knowing when to remove jquery listeners.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">ON_AFTER_ROW_ACTIVATE</span><span class="o">:</span> <span class="s2">&quot;datagrid:onAFterRowActivate&quot;</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8">&#182;</a>
</div>
<p>handy for turning jquery listeners back on.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">ON_ROW_COMPILE</span><span class="o">:</span> <span class="s2">&quot;datagrid:onRowCompile&quot;</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="driving%20events">
  <h4>
    <a href="#driving%20events" name="driving%20events" class="pilcrow">&#182;</a>
    Driving Events
  </h4>
</div>


<ul>
<li><strong><a name="events.RESIZE">RESIZE</a></strong> tells the datagrid to resize. This will update all height calculations.</li>
<li><strong><a name="events.UPDATE">UPDATE</a></strong> force the datagrid to re-evaluate the data and render.</li>
<li><strong><a name="events.SCROLL_TO_INDEX">SCROLL_TO_INDEX</a></strong> scroll the item at that index to the top.</li>
<li><strong><a name="events.SCROLL_TO_ITEM">SCROLL_TO_ITEM</a></strong> scroll that item to the top.</li>
<li><strong><a name="events.SCROLL_INTO_VIEW">SCROLL_INTO_VIEW</a></strong> if the item is above the scroll area, scroll it to the top. If is is below scroll it to the bottom. If it is in the middle, do nothing.</li>
</ul>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">RESIZE</span><span class="o">:</span> <span class="s2">&quot;datagrid:resize&quot;</span><span class="p">,</span>
        <span class="nx">UPDATE</span><span class="o">:</span> <span class="s2">&quot;datagrid:update&quot;</span><span class="p">,</span>
        <span class="nx">SCROLL_TO_INDEX</span><span class="o">:</span> <span class="s2">&quot;datagrid:scrollToIndex&quot;</span><span class="p">,</span>
        <span class="nx">SCROLL_TO_ITEM</span><span class="o">:</span> <span class="s2">&quot;datagrid:scrollToItem&quot;</span><span class="p">,</span>
        <span class="nx">SCROLL_INTO_VIEW</span><span class="o">:</span> <span class="s2">&quot;datagrid:scrollIntoView&quot;</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="log%20events">
  <h4>
    <a href="#log%20events" name="log%20events" class="pilcrow">&#182;</a>
    Log Events
  </h4>
</div>


<ul>
<li><strong><a name="events.LOG">LOG</a></strong> An event to be picked up if the gridLogger is added to the addons or any other listener for logging.</li>
<li><strong><a name="events.INFO">INFO</a></strong> An event to be picked up if the gridLogger is added to the addons or any other listener for logging.</li>
<li><strong><a name="events.WARN">WARN</a></strong> An event to be picked up if the gridLogger is added to the addons or any other listener for logging.</li>
<li><strong><a name="events.ERROR">ERROR</a></strong> An event to be picked up if the gridLogger is added to the addons or any other listener for logging.</li>
</ul>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">LOG</span><span class="o">:</span> <span class="s2">&quot;datagrid:log&quot;</span><span class="p">,</span>
        <span class="nx">INFO</span><span class="o">:</span> <span class="s2">&quot;datagrid:info&quot;</span><span class="p">,</span>
        <span class="nx">WARN</span><span class="o">:</span> <span class="s2">&quot;datagrid:warn&quot;</span><span class="p">,</span>
        <span class="nx">ERROR</span><span class="o">:</span> <span class="s2">&quot;datagrid:error&quot;</span>
    <span class="p">},</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="options">
  <h3>
    <a href="#options" name="options" class="pilcrow">&#182;</a>
    <a name="options">options</a>
  </h3>
</div>

  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12">&#182;</a>
</div>
<ul>
<li><strong><a name="options.asyc">async</a></strong> this changes the flow manager into not allowing async actions to allow unti tests to perform synchronously.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">async</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13">&#182;</a>
</div>
<ul>
<li><strong><a name="options.updateDelay">updateDelay</a></strong> used by the scrollModel so that it gives cushion after the grid has stopped scrolling before rendering.
while faster times on this make it render faster, it can cause it to rencer multiple times because the scrollbar is not completely stopped and may decrease
scrolling performance. if &lt; 100ms this fires too often.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">updateDelay</span><span class="o">:</span> <span class="mi">100</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14">&#182;</a>
</div>
<ul>
<li><strong><a name="options.creepRender.enable">creepRender.enable</a></strong> allow the rendering after the scrolling has stopped to creep in both directions away from the
visible area. This can affect performance in a couple of ways. It will make it so more rows are rendered so scrolling will not have to wait for them, however if
the device is slower this may affect performance in scrolling because the render has to finish before the touch events will work causing a delay in reaction to
touch events.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">creepRender</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">enable</span><span class="o">:</span> <span class="kc">true</span>
        <span class="p">},</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15">&#182;</a>
</div>
<ul>
<li><strong><a name="creepStartDelay">creepStartDelay</a></strong>
when the creep render starts. How long after the scrolling has stopped.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">creepStartDelay</span><span class="o">:</span> <span class="mi">1</span><span class="nx">e3</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16">&#182;</a>
</div>
<ul>
<li><strong><a name="options.cushion">cushion</a></strong> this it used by the updateRowWatchers and what rows it will update. It can be handy for debugging to make sure only
the correct rows are digesting by making the value positive it will take off space from the top and bottom of the viewport that number of pixels to match what
rows are activated and which ones are not. Also a negative number will cause the grid to render past the viewable area and digest rows that are out of view.
In short it is a debugging cushion about what is activated to see them working.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">cushion</span><span class="o">:</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span>
        <span class="nx">chunks</span><span class="o">:</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17">&#182;</a>
</div>
<ul>
<li><strong><a name="options.chunks.detachDom">chunks.detachDom</a></strong> this is used when you want the chunks to be absolute positioned and
chunks that are out of view are hidden to minimize the gpu snapshot. Values are numbers or boolean.
100 will 100 rows above and below the viewport area. A true will evaluate to 0 above and below. A 0 will equate to false and not do a detach.
So the value must be true or a whole number to enable it.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">detachDom</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18">&#182;</a>
</div>
<ul>
<li><strong><a name="options.chunks.size">chunks.size</a></strong> this is used to determine how large each chunk should be. Chunks are made recursively
so if you pass 8 items and they are chunked at 2 then you would have 2 chunks each with 2 chunks each with 2 rows.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">size</span><span class="o">:</span> <span class="mi">50</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19">&#182;</a>
</div>
<ul>
<li><strong><a name="options.chunks.chunkClass">chunks.chunkClass</a></strong> the class assigned to each chunk in the datagrid. This can be customized on a per grid basis since options
can be overridden so that styles or selection may differ from one grid to the next.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">chunkClass</span><span class="o">:</span> <span class="s2">&quot;datagrid-chunk&quot;</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20">&#182;</a>
</div>
<ul>
<li><strong><a name="options.chunks.chunkDisabledClass">chunkDisabledClass</a></strong>
a css class that is added to dom elements that are not containing visible rows.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">chunkDisabledClass</span><span class="o">:</span> <span class="s2">&quot;datagrid-chunk-disabled&quot;</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21">&#182;</a>
</div>
<ul>
<li><strong><a name="options.chunks.chunkReadyClass">chunks.chunkReadyClass</a></strong> after the chunk is added. The chunk ready class is added to all for css
transitions on newly created chunks.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">chunkReadyClass</span><span class="o">:</span> <span class="s2">&quot;datagrid-chunk-ready&quot;</span>
        <span class="p">},</span>
        <span class="nx">scrollModel</span><span class="o">:</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22">&#182;</a>
</div>
<ul>
<li><strong><a name="options.scrollModel.speed">scrollModel.speed</a></strong> the factor of speed multiplication when determining how far the scroller should coast in manual mode.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">speed</span><span class="o">:</span> <span class="mi">5</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23">&#182;</a>
</div>
<ul>
<li><strong><a name="options.scrollModel.manual">scrollModel.manual</a></strong> if set to true then touch move events will be used to scroll and calculate coasting.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">manual</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-24" id="section-24">&#182;</a>
</div>
<ul>
<li><strong><a name="options.scrollModel.simulateClick">scrollModel.simulateClick</a></strong> defaulted to true for android, and false for iOS.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">simulateClick</span><span class="o">:</span> <span class="o">!</span><span class="nx">isIOS</span>
        <span class="p">},</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-25" id="section-25">&#182;</a>
</div>
<ul>
<li><strong><a name="options.compiledClass">compiledClass</a></strong> after a row has been compiled the uncompiled class is removed and compiled is added.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">compiledClass</span><span class="o">:</span> <span class="s2">&quot;compiled&quot;</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-26" id="section-26">&#182;</a>
</div>
<ul>
<li><strong><a name="options.uncompiledClass">uncompiledClass</a></strong> before a dom row is rendered it is compiled. The compiled row will have {{}} still in the code
because the row has not been digested yet. If the user scrolls they can see this. So the uncompiledClass is used to allow the css to hide rows that are not
yet compiled. Once they are compiled and digested the uncompiledClass will be removed from that dom row.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">uncompiledClass</span><span class="o">:</span> <span class="s2">&quot;uncompiled&quot;</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-27" id="section-27">&#182;</a>
</div>
<ul>
<li><strong><a name="contentClass">contentClass</a></strong> the name of the css class assigned to the content div.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">contentClass</span><span class="o">:</span> <span class="s2">&quot;datagrid-content&quot;</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-28" id="section-28">&#182;</a>
</div>
<ul>
<li><strong><a name="rowClass">rowClass</a></strong> the css class assigned to every row.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">rowClass</span><span class="o">:</span> <span class="s2">&quot;datagrid-row&quot;</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-29" id="section-29">&#182;</a>
</div>
<ul>
<li><strong><a name="options.renderThreshold">renderThreshold</a></strong> this value is used by the creepRenderModel to allow the render to process for this amount of ms in
both directions from the current visible area and then it will wait and process again as many rows as it can in this timeframe.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">renderThreshold</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-30" id="section-30">&#182;</a>
</div>
<ul>
<li><strong><a name="options.renderThresholdWait">renderThresholdWait</a></strong> used in conjunction with options.renderThreshold this will wait this amount of time before
trying to render more rows.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">renderThresholdWait</span><span class="o">:</span> <span class="mi">50</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-31" id="section-31">&#182;</a>
</div>
<ul>
<li><strong><a name="options.renderWhileScrolling">renderWhileScrolling</a></strong> cause the grid to render while scrolling. This can will drastically reduce scrolling performance.
this can be optimized by setting a number of milliseconds between each render while scrolling.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">renderWhileScrolling</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-32" id="section-32">&#182;</a>
</div>
<ul>
<li><strong><a name="options.creepLimit">creepLimit</a></strong> used with options.renderThreshold and options.renderThresholdWait this will give a maximum amount of renders
that can be done before the creep render is turned off.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">creepLimit</span><span class="o">:</span> <span class="mi">500</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-33" id="section-33">&#182;</a>
</div>
<ul>
<li><strong><a name="options.smartUpdate">smartUpdate</a></strong> when this is enabled if the array changes the order of things but not the templates that they render in then
this will not do a normal reset, but will just re-render the visible area with the changes and as you scroll the changes will update.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">smartUpdate</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="coreaddons">
  <h3>
    <a href="#coreaddons" name="coreaddons" class="pilcrow">&#182;</a>
    <a name="coreAddons">coreAddons</a>
  </h3>
</div>


<p>the core addons are the ones that are built into the angular-ux-datagrid. This array is used when the grid starts up
to add all of these addons before optional addons are added. You can add core addons to the datagrid by adding these directly to this array, however it is not
recommended.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">coreAddons</span><span class="o">:</span> <span class="p">[]</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="addons">
  <h3>
    <a href="#addons" name="addons" class="pilcrow">&#182;</a>
    addons
  </h3>
</div>


<p>The addons module is used to pass injected names directly to the directive and then have them applied
to the instance. Each of the addons is expected to be a factory that takes at least one argument which
is the instance being passed to it. They can ask for additional ones as well and they will be injected
in from angular's injector.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">module</span><span class="p">.</span><span class="nx">factory</span><span class="p">(</span><span class="s2">&quot;gridAddons&quot;</span><span class="p">,</span> <span class="p">[</span> <span class="s2">&quot;$injector&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$injector</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">function</span> <span class="nx">applyAddons</span><span class="p">(</span><span class="nx">addons</span><span class="p">,</span> <span class="nx">instance</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">addons</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="nx">result</span><span class="p">,</span> <span class="nx">addon</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">result</span> <span class="o">=</span> <span class="nx">$injector</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">addons</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">result</span> <span class="o">===</span> <span class="s2">&quot;function&quot;</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-36" id="section-36">&#182;</a>
</div>
<p>It is expected that each addon be a function. inst is the instance that is injected.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">addon</span> <span class="o">=</span> <span class="nx">$injector</span><span class="p">.</span><span class="nx">invoke</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="nx">instance</span><span class="p">,</span> <span class="p">{</span>
                    <span class="nx">inst</span><span class="o">:</span> <span class="nx">instance</span>
                <span class="p">});</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-37" id="section-37">&#182;</a>
</div>
<p>they must have returned a null? what was the point. Throw an error.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;Addons expect a function to pass the grid instance to.&quot;</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">addons</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-38" id="section-38">&#182;</a>
</div>
<p>addons can be a single item, array, or comma/space separated string.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">addons</span> <span class="o">=</span> <span class="nx">addons</span> <span class="k">instanceof</span> <span class="nb">Array</span> <span class="o">?</span> <span class="nx">addons</span> <span class="o">:</span> <span class="nx">addons</span> <span class="o">&amp;&amp;</span> <span class="nx">addons</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/,/g</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\s+/g</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="o">||</span> <span class="p">[];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">instance</span><span class="p">.</span><span class="nx">addons</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">addons</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">addons</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">addons</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">addons</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">applyAddons</span><span class="p">(</span><span class="nx">addons</span><span class="p">,</span> <span class="nx">instance</span><span class="p">);</span>
    <span class="p">};</span>
<span class="p">}</span> <span class="p">]);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-39" id="section-39">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p><strong>charPack</strong> given a character it will repeat it until the amount specified.
example: charPack('0', 3) => '000'</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">char</span>
      <span class="dox_type">String</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">amount</span>
      <span class="dox_type">Number</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="kd">function</span> <span class="nx">charPack</span><span class="p">(</span><span class="kr">char</span><span class="p">,</span> <span class="nx">amount</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">str</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="nx">amount</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">str</span> <span class="o">+=</span> <span class="kr">char</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">str</span><span class="p">;</span>
<span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="ux.css">
  <h2>
    <a href="#ux.css" name="ux.css" class="pilcrow">&#182;</a>
    ux.CSS
  </h2>
</div>


<p>Create custom style sheets. This has a performance increase over modifying the style on multiple dom
elements because you can create the sheet or override it and then all with that classname update by the browser
instead of the manual insertion into style attributes per dom node.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">exports</span><span class="p">.</span><span class="nx">css</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">CSS</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">customStyleSheets</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">cache</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">cnst</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">head</span><span class="o">:</span> <span class="s2">&quot;head&quot;</span><span class="p">,</span>
        <span class="nx">screen</span><span class="o">:</span> <span class="s2">&quot;screen&quot;</span><span class="p">,</span>
        <span class="nx">string</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
        <span class="nx">object</span><span class="o">:</span> <span class="s2">&quot;object&quot;</span>
    <span class="p">};</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-41" id="section-41">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p><strong>createCustomStyleSheet</strong> given a name creates a new styleSheet.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">name</span>
      <span class="dox_type">Strng</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">createCustomStyleSheet</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">getCustomSheet</span><span class="p">(</span><span class="nx">name</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">customStyleSheets</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">createStyleSheet</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">getCustomSheet</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-42" id="section-42">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p><strong>getCustomSheet</strong> get one of the custom created sheets.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">name</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getCustomSheet</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">customStyleSheets</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-43" id="section-43">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p><strong>createStyleSheet</strong> does the heavy lifting of creating a style sheet.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">name</span>
      <span class="dox_type">String</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">createStyleSheet</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">document</span><span class="p">.</span><span class="nx">styleSheets</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="nx">cnst</span><span class="p">.</span><span class="nx">head</span><span class="p">).</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">styleSheet</span><span class="p">,</span> <span class="nx">mediaType</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">media</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">styleSheets</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nb">document</span><span class="p">.</span><span class="nx">styleSheets</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">styleSheets</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">disabled</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">continue</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="nx">media</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">styleSheets</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">media</span><span class="p">;</span>
                <span class="nx">mediaType</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">media</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">mediaType</span> <span class="o">===</span> <span class="nx">cnst</span><span class="p">.</span><span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">media</span> <span class="o">===</span> <span class="s2">&quot;&quot;</span> <span class="o">||</span> <span class="nx">media</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">cnst</span><span class="p">.</span><span class="nx">screen</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">styleSheet</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">styleSheets</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                    <span class="p">}</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">mediaType</span> <span class="o">===</span> <span class="nx">cnst</span><span class="p">.</span><span class="nx">object</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">media</span><span class="p">.</span><span class="nx">mediaText</span> <span class="o">===</span> <span class="s2">&quot;&quot;</span> <span class="o">||</span> <span class="nx">media</span><span class="p">.</span><span class="nx">mediaText</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">cnst</span><span class="p">.</span><span class="nx">screen</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">styleSheet</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">styleSheets</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">styleSheet</span> <span class="o">!==</span> <span class="s2">&quot;undefined&quot;</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">styleSheetElement</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;style&quot;</span><span class="p">);</span>
        <span class="nx">styleSheetElement</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">&quot;text/css&quot;</span><span class="p">;</span>
        <span class="nx">styleSheetElement</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="nx">cnst</span><span class="p">.</span><span class="nx">head</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">styleSheetElement</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nb">document</span><span class="p">.</span><span class="nx">styleSheets</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">styleSheets</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">disabled</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">continue</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">styleSheet</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">styleSheets</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">name</span><span class="o">:</span> <span class="nx">name</span><span class="p">,</span>
            <span class="nx">styleSheet</span><span class="o">:</span> <span class="nx">styleSheet</span>
        <span class="p">};</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-44" id="section-44">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p><strong>createClass</strong> creates a class on a custom style sheet.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">sheetName</span>
      <span class="dox_type">String</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">selector</span>
      <span class="dox_type">String</span>
      <span><ul>
<li>example: ".datagrid"</li>
</ul></span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">style</span>
      <span class="dox_type">String</span>
      <span><ul>
<li>example: "height:20px;width:40px;color:blue;"</li>
</ul></span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">createClass</span><span class="p">(</span><span class="nx">sheetName</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">style</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">sheet</span> <span class="o">=</span> <span class="nx">getCustomSheet</span><span class="p">(</span><span class="nx">sheetName</span><span class="p">)</span> <span class="o">||</span> <span class="nx">createCustomStyleSheet</span><span class="p">(</span><span class="nx">sheetName</span><span class="p">),</span> <span class="nx">styleSheet</span> <span class="o">=</span> <span class="nx">sheet</span><span class="p">.</span><span class="nx">styleSheet</span><span class="p">,</span> <span class="nx">i</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">styleSheet</span><span class="p">.</span><span class="nx">addRule</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">styleSheet</span><span class="p">.</span><span class="nx">rules</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">styleSheet</span><span class="p">.</span><span class="nx">rules</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">selectorText</span> <span class="o">&amp;&amp;</span> <span class="nx">styleSheet</span><span class="p">.</span><span class="nx">rules</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">selectorText</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span> <span class="o">===</span> <span class="nx">selector</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">())</span> <span class="p">{</span>
                    <span class="nx">styleSheet</span><span class="p">.</span><span class="nx">rules</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">cssText</span> <span class="o">=</span> <span class="nx">style</span><span class="p">;</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="nx">styleSheet</span><span class="p">.</span><span class="nx">addRule</span><span class="p">(</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">style</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">styleSheet</span><span class="p">.</span><span class="nx">insertRule</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">styleSheet</span><span class="p">.</span><span class="nx">cssRules</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">styleSheet</span><span class="p">.</span><span class="nx">cssRules</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">selectorText</span> <span class="o">&amp;&amp;</span> <span class="nx">styleSheet</span><span class="p">.</span><span class="nx">cssRules</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">selectorText</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span> <span class="o">===</span> <span class="nx">selector</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">())</span> <span class="p">{</span>
                    <span class="nx">styleSheet</span><span class="p">.</span><span class="nx">cssRules</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">cssText</span> <span class="o">=</span> <span class="nx">style</span><span class="p">;</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="nx">styleSheet</span><span class="p">.</span><span class="nx">insertRule</span><span class="p">(</span><span class="nx">selector</span> <span class="o">+</span> <span class="s2">&quot;{&quot;</span> <span class="o">+</span> <span class="nx">style</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-45" id="section-45">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p><strong>getSelector</strong> given a selector this will find that selector in the stylesheets. Not just the custom ones.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">selector</span>
      <span class="dox_type">String</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getSelector</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">ilen</span><span class="p">,</span> <span class="nx">sheet</span><span class="p">,</span> <span class="nx">classes</span><span class="p">,</span> <span class="nx">result</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">selector</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">||</span> <span class="nx">selector</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">cache</span><span class="p">[</span><span class="nx">selector</span><span class="p">])</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">cache</span><span class="p">[</span><span class="nx">selector</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">ilen</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">styleSheets</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ilen</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">sheet</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">styleSheets</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="nx">classes</span> <span class="o">=</span> <span class="nx">sheet</span><span class="p">.</span><span class="nx">rules</span> <span class="o">||</span> <span class="nx">sheet</span><span class="p">.</span><span class="nx">cssRules</span><span class="p">;</span>
            <span class="nx">result</span> <span class="o">=</span> <span class="nx">getRules</span><span class="p">(</span><span class="nx">classes</span><span class="p">,</span> <span class="nx">selector</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-46" id="section-46">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p><strong>getRules</strong> given a set of classes and a selector it will get the rules for a style sheet.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">classes</span>
      <span class="dox_type">CSSRules</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">selector</span>
      <span class="dox_type">String</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getRules</span><span class="p">(</span><span class="nx">classes</span><span class="p">,</span> <span class="nx">selector</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">jlen</span><span class="p">,</span> <span class="nx">cls</span><span class="p">,</span> <span class="nx">result</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">classes</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">jlen</span> <span class="o">=</span> <span class="nx">classes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">jlen</span><span class="p">;</span> <span class="nx">j</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">cls</span> <span class="o">=</span> <span class="nx">classes</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">cls</span><span class="p">.</span><span class="nx">cssRules</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">result</span> <span class="o">=</span> <span class="nx">getRules</span><span class="p">(</span><span class="nx">cls</span><span class="p">.</span><span class="nx">cssRules</span><span class="p">,</span> <span class="nx">selector</span><span class="p">);</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">cls</span><span class="p">.</span><span class="nx">selectorText</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">expression</span> <span class="o">=</span> <span class="s2">&quot;(\b)*&quot;</span> <span class="o">+</span> <span class="nx">selector</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;\\.&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;([^-a-zA-Z0-9]|,|$)&quot;</span><span class="p">,</span> <span class="nx">matches</span> <span class="o">=</span> <span class="nx">cls</span><span class="p">.</span><span class="nx">selectorText</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">expression</span><span class="p">);</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">matches</span> <span class="o">&amp;&amp;</span> <span class="nx">matches</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">cache</span><span class="p">[</span><span class="nx">selector</span><span class="p">]</span> <span class="o">=</span> <span class="nx">cls</span><span class="p">.</span><span class="nx">style</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-47" id="section-47">&#182;</a>
</div>
<p>cache the value</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                        <span class="k">return</span> <span class="nx">cls</span><span class="p">.</span><span class="nx">style</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-48" id="section-48">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p><strong>getCSSValue</strong> return the css value of a property given the selector and the property.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">selector</span>
      <span class="dox_type">String</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">property</span>
      <span class="dox_type">String</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getCSSValue</span><span class="p">(</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">property</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">cls</span> <span class="o">=</span> <span class="nx">getSelector</span><span class="p">(</span><span class="nx">selector</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">cls</span> <span class="o">&amp;&amp;</span> <span class="nx">cls</span><span class="p">[</span><span class="nx">property</span><span class="p">]</span> <span class="o">!==</span> <span class="kc">undefined</span> <span class="o">?</span> <span class="nx">cls</span><span class="p">[</span><span class="nx">property</span><span class="p">]</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-49" id="section-49">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p><strong>setCSSValue</strong> overwrite a css value given a selector, property, and new value.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">selector</span>
      <span class="dox_type">String</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">property</span>
      <span class="dox_type">String</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">value
</span>
      <span class="dox_type">String</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">setCSSValue</span><span class="p">(</span><span class="nx">selector</span><span class="p">,</span> <span class="nx">property</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">cls</span> <span class="o">=</span> <span class="nx">getSelector</span><span class="p">(</span><span class="nx">selector</span><span class="p">);</span>
        <span class="nx">cls</span><span class="p">[</span><span class="nx">property</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-50" id="section-50">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p><strong>ux.CSS API</strong></p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="k">return</span> <span class="p">{</span>
        <span class="nx">createdStyleSheets</span><span class="o">:</span> <span class="p">[],</span>
        <span class="nx">createStyleSheet</span><span class="o">:</span> <span class="nx">createStyleSheet</span><span class="p">,</span>
        <span class="nx">createClass</span><span class="o">:</span> <span class="nx">createClass</span><span class="p">,</span>
        <span class="nx">getCSSValue</span><span class="o">:</span> <span class="nx">getCSSValue</span><span class="p">,</span>
        <span class="nx">setCSSValue</span><span class="o">:</span> <span class="nx">setCSSValue</span><span class="p">,</span>
        <span class="nx">getSelector</span><span class="o">:</span> <span class="nx">getSelector</span>
    <span class="p">};</span>
<span class="p">}();</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="ux.each">
  <h2>
    <a href="#ux.each" name="ux.each" class="pilcrow">&#182;</a>
    ux.each
  </h2>
</div>


<p>Like angular.forEach except that you can pass additional arguments to it that will be available
in the iteration function. It is optimized to use while loops where possible instead of for loops for speed.
Like Lo-Dash.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">list</span>
      <span class="dox_type">Array\Object</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">method</span>
      <span class="dox_type">Function</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">data</span>
      <span class="dox_type">*=</span>
      <span><em>additional arguments passes are available in the iteration function</em></span>
    </div>
  </div>
</div>

<p><em>example:</em></p>


<div class="highlight"><pre><code> <span class="kd">function</span> <span class="nx">myMethod</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">,</span> <span class="nx">arg1</span><span class="p">,</span> <span class="nx">arg2</span><span class="p">,</span> <span class="nx">arg3</span><span class="p">)</span> <span class="p">{</span>
     <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">arg1</span><span class="p">,</span> <span class="nx">arg2</span><span class="p">,</span> <span class="nx">arg3</span><span class="p">);</span>
 <span class="p">}</span>
 <span class="nx">ux</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">myList</span><span class="p">,</span> <span class="nx">myMethod</span><span class="p">,</span> <span class="nx">arg1</span><span class="p">,</span> <span class="nx">arg2</span><span class="p">,</span> <span class="nx">arg3</span><span class="p">);</span>
</code></pre></div>


        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="kd">function</span> <span class="nx">each</span><span class="p">(</span><span class="nx">list</span><span class="p">,</span> <span class="nx">method</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span><span class="p">,</span> <span class="nx">result</span><span class="p">,</span> <span class="nx">extraArgs</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">extraArgs</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">array</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);</span>
        <span class="nx">extraArgs</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">list</span> <span class="o">&amp;&amp;</span> <span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">len</span> <span class="o">=</span> <span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">result</span> <span class="o">=</span> <span class="nx">method</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">[</span> <span class="nx">list</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">list</span> <span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">extraArgs</span><span class="p">));</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">result</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">list</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">list</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">i</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">result</span> <span class="o">=</span> <span class="nx">method</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">[</span> <span class="nx">list</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">list</span> <span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">extraArgs</span><span class="p">));</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">result</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">list</span> <span class="k">instanceof</span> <span class="nb">Array</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">list</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">list</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">i</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">result</span> <span class="o">=</span> <span class="nx">method</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">[</span> <span class="nx">list</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">list</span> <span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">extraArgs</span><span class="p">));</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">result</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">list</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">each</span> <span class="o">=</span> <span class="nx">each</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-52" id="section-52">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p><strong>filter</strong> built on the same concepts as each. So that you can pass additional arguments.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">list</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">method</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">data</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="kd">function</span> <span class="nx">filter</span><span class="p">(</span><span class="nx">list</span><span class="p">,</span> <span class="nx">method</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span><span class="p">,</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">extraArgs</span><span class="p">,</span> <span class="nx">response</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">extraArgs</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">array</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);</span>
        <span class="nx">extraArgs</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">list</span> <span class="o">&amp;&amp;</span> <span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">len</span> <span class="o">=</span> <span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">response</span> <span class="o">=</span> <span class="nx">method</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">[</span> <span class="nx">list</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">list</span> <span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">extraArgs</span><span class="p">));</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">list</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
            <span class="p">}</span>
            <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">list</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">list</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">i</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">response</span> <span class="o">=</span> <span class="nx">method</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">[</span> <span class="nx">list</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">list</span> <span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">extraArgs</span><span class="p">));</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">list</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">filter</span> <span class="o">=</span> <span class="nx">filter</span><span class="p">;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-53" id="section-53">&#182;</a>
</div>
<div class="dox">
  <div class="summary">
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">target</span>
      <span class="dox_type">Object</span>
      <span><ul>
<li>the object to apply the methods to.</li>
</ul></span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">scope</span>
      <span class="dox_type">Object</span>
      <span><ul>
<li>the object that the methods will be applied from</li>
</ul></span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">map</span>
      <span class="dox_type">object</span>
      <span><ul>
<li>custom names of what methods to map from scope. such as <em>$emit</em> and <em>$broadcast</em>.</li>
</ul></span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="kd">function</span> <span class="nx">dispatcher</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">scope</span><span class="p">,</span> <span class="nx">map</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">listeners</span> <span class="o">=</span> <span class="p">{};</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-54" id="section-54">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p><strong>off</strong> removeEventListener from this object instance. given the event listened for and the callback reference.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">event</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">callback
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">off</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">;</span>
        <span class="nx">list</span> <span class="o">=</span> <span class="nx">listeners</span><span class="p">[</span><span class="nx">event</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">list</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">index</span> <span class="o">=</span> <span class="nx">list</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">list</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">list</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-55" id="section-55">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p><strong>on</strong> addEventListener to this object instance.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">event</span>
      <span class="dox_type">String</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">callback</span>
      <span class="dox_type">Function</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">on</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">listeners</span><span class="p">[</span><span class="nx">event</span><span class="p">]</span> <span class="o">=</span> <span class="nx">listeners</span><span class="p">[</span><span class="nx">event</span><span class="p">]</span> <span class="o">||</span> <span class="p">[];</span>
        <span class="nx">listeners</span><span class="p">[</span><span class="nx">event</span><span class="p">].</span><span class="nx">push</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
        <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">off</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
        <span class="p">};</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-56" id="section-56">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p><strong>fire</strong> fire the callback with arguments.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">callback</span>
      <span class="dox_type">Function</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">args</span>
      <span class="dox_type">Array</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">fire</span><span class="p">(</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">callback</span> <span class="o">&amp;&amp;</span> <span class="nx">callback</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">target</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-57" id="section-57">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p><strong>dispatch</strong> fire the event and any arguments that are passed.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">event
</span>
      <span class="dox_type">String</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">dispatch</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">listeners</span><span class="p">[</span><span class="nx">event</span><span class="p">])</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">list</span> <span class="o">=</span> <span class="nx">listeners</span><span class="p">[</span><span class="nx">event</span><span class="p">],</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
            <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">fire</span><span class="p">(</span><span class="nx">list</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">arguments</span><span class="p">);</span>
                <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-58" id="section-58">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p><strong>Dispatcher API</strong>
- on: add event listener
- off: remove event listener
- dispatch: fire event.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="k">if</span> <span class="p">(</span><span class="nx">scope</span> <span class="o">&amp;&amp;</span> <span class="nx">map</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">target</span><span class="p">.</span><span class="nx">on</span> <span class="o">=</span> <span class="nx">scope</span><span class="p">[</span><span class="nx">map</span><span class="p">.</span><span class="nx">on</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">scope</span><span class="p">[</span><span class="nx">map</span><span class="p">.</span><span class="nx">on</span><span class="p">].</span><span class="nx">bind</span><span class="p">(</span><span class="nx">scope</span><span class="p">);</span>
        <span class="nx">target</span><span class="p">.</span><span class="nx">off</span> <span class="o">=</span> <span class="nx">scope</span><span class="p">[</span><span class="nx">map</span><span class="p">.</span><span class="nx">off</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">scope</span><span class="p">[</span><span class="nx">map</span><span class="p">.</span><span class="nx">off</span><span class="p">].</span><span class="nx">bind</span><span class="p">(</span><span class="nx">scope</span><span class="p">);</span>
        <span class="nx">target</span><span class="p">.</span><span class="nx">dispatch</span> <span class="o">=</span> <span class="nx">scope</span><span class="p">[</span><span class="nx">map</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">].</span><span class="nx">bind</span><span class="p">(</span><span class="nx">scope</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">target</span><span class="p">.</span><span class="nx">on</span> <span class="o">=</span> <span class="nx">on</span><span class="p">;</span>
        <span class="nx">target</span><span class="p">.</span><span class="nx">off</span> <span class="o">=</span> <span class="nx">off</span><span class="p">;</span>
        <span class="nx">target</span><span class="p">.</span><span class="nx">dispatch</span> <span class="o">=</span> <span class="nx">dispatch</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="extend">
  <h3>
    <a href="#extend" name="extend" class="pilcrow">&#182;</a>
    <a name="extend">extend</a>
  </h3>
</div>


<p>Perform a deep extend.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">destination</span>
      <span class="dox_type">Object</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">source
return</span>
      <span class="dox_type">Object=</span>
      <span>{Object|destination}</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="kd">function</span> <span class="nx">extend</span><span class="p">(</span><span class="nx">destination</span><span class="p">,</span> <span class="nx">source</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">array</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(</span><span class="nx">arguments</span><span class="p">),</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="nx">item</span><span class="p">,</span> <span class="nx">j</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">item</span> <span class="o">=</span> <span class="nx">args</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="k">in</span> <span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">destination</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">destination</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">===</span> <span class="s2">&quot;object&quot;</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">destination</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">extend</span><span class="p">(</span><span class="nx">destination</span><span class="p">[</span><span class="nx">j</span><span class="p">],</span> <span class="nx">item</span><span class="p">[</span><span class="nx">j</span><span class="p">]);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">item</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="k">instanceof</span> <span class="nb">Array</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">destination</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">extend</span><span class="p">([],</span> <span class="nx">item</span><span class="p">[</span><span class="nx">j</span><span class="p">]);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">item</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">item</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">===</span> <span class="s2">&quot;object&quot;</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">destination</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">extend</span><span class="p">({},</span> <span class="nx">item</span><span class="p">[</span><span class="nx">j</span><span class="p">]);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">destination</span><span class="p">[</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">item</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">destination</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">extend</span> <span class="o">=</span> <span class="nx">extend</span><span class="p">;</span>

<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">exports</span><span class="p">.</span><span class="nx">uid</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">UID</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">c</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="mi">36</span><span class="p">).</span><span class="nx">toUpperCase</span><span class="p">();</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">str</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">str</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span> <span class="o">+</span> <span class="nx">str</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">str</span><span class="p">;</span>
    <span class="p">};</span>
<span class="p">})();</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-60" id="section-60">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p><strong>toArray</strong> Convert arguments or objects to an array.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">obj</span>
      <span class="dox_type">Object</span>
      <span class="dox_type">Arguments</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="kd">function</span> <span class="nx">toArray</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">obj</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
            <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">i</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">obj</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
<span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-61" id="section-61">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p><strong>sort</strong> apply array sort with a custom compare function.</p>

<blockquote>
  <p>The ECMAScript standard does not guarantee Array.sort is a stable sort.
  According to the ECMA spec, when two objects are determined to be equal in a custom sort,
  JavaScript is not required to leave those two objects in the same order.
  replace sort from ECMAScript with this bubble sort to make it accurate</p>
</blockquote>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="kd">function</span> <span class="nx">sort</span><span class="p">(</span><span class="nx">ary</span><span class="p">,</span> <span class="nx">compareFn</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">len</span><span class="p">,</span> <span class="nx">v</span><span class="p">,</span> <span class="nx">rlen</span><span class="p">,</span> <span class="nx">holder</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">compareFn</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-62" id="section-62">&#182;</a>
</div>
<p>default compare function.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">compareFn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">a</span> <span class="o">&gt;</span> <span class="nx">b</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="nx">a</span> <span class="o">&lt;</span> <span class="nx">b</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">};</span>
    <span class="p">}</span>
    <span class="nx">len</span> <span class="o">=</span> <span class="nx">ary</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="nx">rlen</span> <span class="o">=</span> <span class="nx">len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">c</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">c</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">v</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">v</span> <span class="o">&lt;</span> <span class="nx">rlen</span><span class="p">;</span> <span class="nx">v</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">compareFn</span><span class="p">(</span><span class="nx">ary</span><span class="p">[</span><span class="nx">v</span><span class="p">],</span> <span class="nx">ary</span><span class="p">[</span><span class="nx">v</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">holder</span> <span class="o">=</span> <span class="nx">ary</span><span class="p">[</span><span class="nx">v</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
                <span class="nx">ary</span><span class="p">[</span><span class="nx">v</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">ary</span><span class="p">[</span><span class="nx">v</span><span class="p">];</span>
                <span class="nx">ary</span><span class="p">[</span><span class="nx">v</span><span class="p">]</span> <span class="o">=</span> <span class="nx">holder</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">ary</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">util</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">util</span> <span class="o">||</span> <span class="p">{};</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">array</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">array</span> <span class="o">||</span> <span class="p">{};</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">array</span><span class="p">.</span><span class="nx">toArray</span> <span class="o">=</span> <span class="nx">toArray</span><span class="p">;</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">array</span><span class="p">.</span><span class="nx">sort</span> <span class="o">=</span> <span class="nx">sort</span><span class="p">;</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">logWrapper</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">LogWrapper</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">instance</span><span class="p">,</span> <span class="nx">theme</span><span class="p">,</span> <span class="nx">dispatch</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">theme</span> <span class="o">=</span> <span class="nx">theme</span> <span class="o">||</span> <span class="s2">&quot;black&quot;</span><span class="p">;</span>
    <span class="nx">dispatch</span> <span class="o">=</span> <span class="nx">dispatch</span> <span class="o">||</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">dispatch</span> <span class="o">||</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{};</span>
    <span class="nx">instance</span><span class="p">.</span><span class="nx">$logName</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
    <span class="nx">instance</span><span class="p">.</span><span class="nx">log</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">info</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">warn</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">error</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{};</span>
    <span class="nx">instance</span><span class="p">.</span><span class="nx">log</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">log</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="p">[</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">LOG</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">theme</span> <span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">array</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(</span><span class="nx">arguments</span><span class="p">));</span>
        <span class="nx">dispatch</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
    <span class="p">};</span>
    <span class="nx">instance</span><span class="p">.</span><span class="nx">info</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">info</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="p">[</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">INFO</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">theme</span> <span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">array</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(</span><span class="nx">arguments</span><span class="p">));</span>
        <span class="nx">dispatch</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
    <span class="p">};</span>
    <span class="nx">instance</span><span class="p">.</span><span class="nx">warn</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">warn</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="p">[</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">WARN</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">theme</span> <span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">array</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(</span><span class="nx">arguments</span><span class="p">));</span>
        <span class="nx">dispatch</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
    <span class="p">};</span>
    <span class="nx">instance</span><span class="p">.</span><span class="nx">error</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">error</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="p">[</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ERROR</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">theme</span> <span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">array</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(</span><span class="nx">arguments</span><span class="p">));</span>
        <span class="nx">dispatch</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
    <span class="p">};</span>
    <span class="nx">instance</span><span class="p">.</span><span class="nx">destroyLogger</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">instance</span><span class="p">.</span><span class="nx">logger</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">instance</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;destroy&quot;</span><span class="p">);</span>
            <span class="nx">instance</span><span class="p">.</span><span class="nx">logger</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
            <span class="nx">instance</span><span class="p">.</span><span class="nx">logger</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="k">return</span> <span class="nx">instance</span><span class="p">;</span>
<span class="p">};</span>

<span class="kd">function</span> <span class="nx">Flow</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">dispatch</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">running</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">intv</span><span class="p">,</span> <span class="nx">current</span> <span class="o">=</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">list</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">history</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">historyLimit</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="nx">uniqueMethods</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">execStartTime</span><span class="p">,</span> <span class="nx">execEndTime</span><span class="p">,</span> <span class="nx">timeouts</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">consoleMethodStyle</span> <span class="o">=</span> <span class="s2">&quot;color:#666666;&quot;</span><span class="p">;</span>
    <span class="kd">function</span> <span class="nx">getMethodName</span><span class="p">(</span><span class="nx">method</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-63" id="section-63">&#182;</a>
</div>
<p>TODO: there might be a faster way to get the function name.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">return</span> <span class="nx">method</span><span class="p">.</span><span class="nx">toString</span><span class="p">().</span><span class="nx">split</span><span class="p">(</span><span class="sr">/\b/</span><span class="p">)[</span><span class="mi">2</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">createItem</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">delay</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">label</span><span class="o">:</span> <span class="nx">getMethodName</span><span class="p">(</span><span class="nx">method</span><span class="p">),</span>
            <span class="nx">method</span><span class="o">:</span> <span class="nx">method</span><span class="p">,</span>
            <span class="nx">args</span><span class="o">:</span> <span class="nx">args</span> <span class="o">||</span> <span class="p">[],</span>
            <span class="nx">delay</span><span class="o">:</span> <span class="nx">delay</span>
        <span class="p">};</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">unique</span><span class="p">(</span><span class="nx">method</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">getMethodName</span><span class="p">(</span><span class="nx">method</span><span class="p">);</span>
        <span class="nx">uniqueMethods</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">method</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">clearSimilarItemsFromList</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">list</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">label</span> <span class="o">===</span> <span class="nx">item</span><span class="p">.</span><span class="nx">label</span> <span class="o">&amp;&amp;</span> <span class="nx">list</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">!==</span> <span class="nx">current</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;clear duplicate item %c%s&quot;</span><span class="p">,</span> <span class="nx">consoleMethodStyle</span><span class="p">,</span> <span class="nx">item</span><span class="p">.</span><span class="nx">label</span><span class="p">);</span>
                <span class="nx">list</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
                <span class="nx">i</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="nx">len</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">add</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">delay</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="nx">createItem</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">delay</span><span class="p">),</span> <span class="nx">index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">uniqueMethods</span><span class="p">[</span><span class="nx">item</span><span class="p">.</span><span class="nx">label</span><span class="p">])</span> <span class="p">{</span>
            <span class="nx">clearSimilarItemsFromList</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">list</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">running</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">next</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-64" id="section-64">&#182;</a>
</div>
<p>this puts it right after the one currently running.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">insert</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">delay</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">list</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">createItem</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">args</span><span class="p">,</span> <span class="nx">delay</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">remove</span><span class="p">(</span><span class="nx">method</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">clearSimilarItemsFromList</span><span class="p">({</span>
            <span class="nx">label</span><span class="o">:</span> <span class="nx">getMethodName</span><span class="p">(</span><span class="nx">method</span><span class="p">)</span>
        <span class="p">});</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">timeout</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">time</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">intv</span><span class="p">,</span> <span class="nx">item</span> <span class="o">=</span> <span class="nx">createItem</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="p">[],</span> <span class="nx">time</span><span class="p">),</span> <span class="nx">startTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">(),</span> <span class="nx">timeoutCall</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;exec timeout method %c%s %sms&quot;</span><span class="p">,</span> <span class="nx">consoleMethodStyle</span><span class="p">,</span> <span class="nx">item</span><span class="p">.</span><span class="nx">label</span><span class="p">,</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">-</span> <span class="nx">startTime</span><span class="p">);</span>
            <span class="nx">method</span><span class="p">();</span>
        <span class="p">};</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;wait for timeout method %c%s&quot;</span><span class="p">,</span> <span class="nx">consoleMethodStyle</span><span class="p">,</span> <span class="nx">item</span><span class="p">.</span><span class="nx">label</span><span class="p">);</span>
        <span class="nx">intv</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">timeoutCall</span><span class="p">,</span> <span class="nx">time</span><span class="p">);</span>
        <span class="nx">timeouts</span><span class="p">[</span><span class="nx">intv</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">intv</span><span class="p">);</span>
            <span class="k">delete</span> <span class="nx">timeouts</span><span class="p">[</span><span class="nx">intv</span><span class="p">];</span>
        <span class="p">};</span>
        <span class="k">return</span> <span class="nx">intv</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">stopTimeout</span><span class="p">(</span><span class="nx">intv</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">timeouts</span><span class="p">[</span><span class="nx">intv</span><span class="p">])</span> <span class="nx">timeouts</span><span class="p">[</span><span class="nx">intv</span><span class="p">]();</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">getArguments</span><span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="nx">fn</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span> <span class="nx">match</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/\(.*\)/</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">match</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">match</span><span class="p">(</span><span class="sr">/([\$\w])+/gm</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">hasDoneArg</span><span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">getArguments</span><span class="p">(</span><span class="nx">fn</span><span class="p">);</span>
        <span class="k">return</span> <span class="o">!!</span><span class="p">(</span><span class="nx">args</span> <span class="o">&amp;&amp;</span> <span class="nx">args</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;done&quot;</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">done</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">execEndTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;finish %c%s took %dms&quot;</span><span class="p">,</span> <span class="nx">consoleMethodStyle</span><span class="p">,</span> <span class="nx">current</span><span class="p">.</span><span class="nx">label</span><span class="p">,</span> <span class="nx">execEndTime</span> <span class="o">-</span> <span class="nx">execStartTime</span><span class="p">);</span>
        <span class="nx">current</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">addToHistory</span><span class="p">(</span><span class="nx">list</span><span class="p">.</span><span class="nx">shift</span><span class="p">());</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">next</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">execEndTime</span> <span class="o">-</span> <span class="nx">execStartTime</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-65" id="section-65">&#182;</a>
</div>
<p>Keep a history of what methods were executed for debugging. Keep up to the limit.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">addToHistory</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">history</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">history</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="nx">historyLimit</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">history</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">next</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">current</span> <span class="o">&amp;&amp;</span> <span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">current</span> <span class="o">=</span> <span class="nx">list</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">async</span> <span class="o">&amp;&amp;</span> <span class="nx">current</span><span class="p">.</span><span class="nx">delay</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;  delay for %c%s %sms&quot;</span><span class="p">,</span> <span class="nx">consoleMethodStyle</span><span class="p">,</span> <span class="nx">current</span><span class="p">.</span><span class="nx">label</span><span class="p">,</span> <span class="nx">current</span><span class="p">.</span><span class="nx">delay</span><span class="p">);</span>
                <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">intv</span><span class="p">);</span>
                <span class="nx">intv</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">exec</span><span class="p">,</span> <span class="nx">current</span><span class="p">.</span><span class="nx">delay</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">exec</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">exec</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;start method %c%s&quot;</span><span class="p">,</span> <span class="nx">consoleMethodStyle</span><span class="p">,</span> <span class="nx">current</span><span class="p">.</span><span class="nx">label</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">methodHasDoneArg</span> <span class="o">=</span> <span class="nx">hasDoneArg</span><span class="p">(</span><span class="nx">current</span><span class="p">.</span><span class="nx">method</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">methodHasDoneArg</span><span class="p">)</span> <span class="nx">current</span><span class="p">.</span><span class="nx">args</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">done</span><span class="p">);</span>
        <span class="nx">execStartTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
        <span class="nx">current</span><span class="p">.</span><span class="nx">method</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">current</span><span class="p">.</span><span class="nx">args</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">methodHasDoneArg</span><span class="p">)</span> <span class="nx">done</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">running</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="nx">next</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">clear</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">current</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">item</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;clear&quot;</span><span class="p">);</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">list</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">item</span> <span class="o">=</span> <span class="nx">list</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">len</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;  remove %s from flow&quot;</span><span class="p">,</span> <span class="nx">item</span><span class="p">.</span><span class="nx">label</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">length</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">destroy</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">intv</span><span class="p">);</span>
        <span class="nx">list</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">inst</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">inst</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">logWrapper</span><span class="p">(</span><span class="s2">&quot;Flow&quot;</span><span class="p">,</span> <span class="nx">inst</span> <span class="o">||</span> <span class="p">{},</span> <span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="nx">dispatch</span><span class="p">);</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">async</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s2">&quot;async&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">async</span> <span class="o">:</span> <span class="kc">true</span><span class="p">;</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">debug</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">debug</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">insert</span> <span class="o">=</span> <span class="nx">insert</span><span class="p">;</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">add</span> <span class="o">=</span> <span class="nx">add</span><span class="p">;</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">unique</span> <span class="o">=</span> <span class="nx">unique</span><span class="p">;</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">remove</span> <span class="o">=</span> <span class="nx">remove</span><span class="p">;</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">timeout</span> <span class="o">=</span> <span class="nx">timeout</span><span class="p">;</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">stopTimeout</span> <span class="o">=</span> <span class="nx">stopTimeout</span><span class="p">;</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">run</span> <span class="o">=</span> <span class="nx">run</span><span class="p">;</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">clear</span> <span class="o">=</span> <span class="nx">clear</span><span class="p">;</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="nx">length</span><span class="p">;</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">destroy</span> <span class="o">=</span> <span class="nx">destroy</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">inst</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">Flow</span> <span class="o">=</span> <span class="nx">Flow</span><span class="p">;</span>

<span class="cm">/*global each, charPack, Flow, exports, module */</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary"><p><a name="ux.datagrid"></a></p>


<div class="pilwrap" id="datagrid%20directive">
  <h2>
    <a href="#datagrid%20directive" name="datagrid%20directive" class="pilcrow">&#182;</a>
    Datagrid Directive
  </h2>
</div>


<p>The datagrid manages the <code>core addons</code> to build the initial list and provide the public api necessary
to communicate with other addons.
Datagrid uses script templates inside of the dom to create your elements. Addons that are added to the addon
attribute.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">scope</span>
      <span class="dox_type">Scope</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">element</span>
      <span class="dox_type">DOMElement</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">attr</span>
      <span class="dox_type">Object</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">$compile</span>
      <span class="dox_type">Function</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="kd">function</span> <span class="nx">Datagrid</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">attr</span><span class="p">,</span> <span class="nx">$compile</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-67" id="section-67">&#182;</a>
</div>
<p><strong><a name="flow">flow</a></strong> flow management for methods of the datagrid. Keeping functions firing in the correct order especially if async methods are executed.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">flow</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-68" id="section-68">&#182;</a>
</div>
<p><strong><a name="waitCount">waitCount</a></strong> waiting to render. If it fails too many times. it will die.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">waitCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-69" id="section-69">&#182;</a>
</div>
<p><strong><a name="changeWatcherSet">changeWatcherSet</a></strong> flag for change watchers.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">changeWatcherSet</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-70" id="section-70">&#182;</a>
</div>
<p><strong><a name="unwatchers">unwatchers</a></strong> list of scope listeners that we want to clear on destroy</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">unwatchers</span> <span class="o">=</span> <span class="p">[];</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-71" id="section-71">&#182;</a>
</div>
<p><strong><a name="content">content</a></strong> the dom element with all of the chunks.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">content</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-72" id="section-72">&#182;</a>
</div>
<p><strong><a name="oldContent">oldContent</a></strong> the temporary content when the grid is being reset.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">oldContent</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-73" id="section-73">&#182;</a>
</div>
<p><strong><a name="scopes">scopes</a></strong> the array of all scopes that have been compiled.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">scopes</span> <span class="o">=</span> <span class="p">[];</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-74" id="section-74">&#182;</a>
</div>
<p><strong><a name="active">active</a></strong> the scopes that are currently active.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">active</span> <span class="o">=</span> <span class="p">[];</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-75" id="section-75">&#182;</a>
</div>
<p><strong><a name="lastVisibleScrollStart">lastVisibleScrollStart</a></strong> cached index to improve render loop by starting where it left off.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">lastVisibleScrollStart</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-76" id="section-76">&#182;</a>
</div>
<p><strong><a name="rowOffsets">rowOffsets</a></strong> cache for the heights of the rows for faster height calculations.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">rowOffsets</span> <span class="o">=</span> <span class="p">{};</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-77" id="section-77">&#182;</a>
</div>
<p><strong><a name="viewHeight">viewHeight</a></strong> the visual area height.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">viewHeight</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-78" id="section-78">&#182;</a>
</div>
<p><strong><a name="options">options</a></strong> configs that are shared through the datagrid and addons.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">options</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-79" id="section-79">&#182;</a>
</div>
<p><strong><a href="#states">states</a></strong> local reference to the states constants</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">states</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">states</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-80" id="section-80">&#182;</a>
</div>
<p><strong><a href="#events">events</a></strong> local reference to the events constants</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">events</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-81" id="section-81">&#182;</a>
</div>
<p><strong><a name="state">state</a></strong> <code>state</code> of the app. Building || Ready.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">state</span> <span class="o">=</span> <span class="nx">states</span><span class="p">.</span><span class="nx">BUILDING</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-82" id="section-82">&#182;</a>
</div>
<p><strong><a name="values">values</a></strong> <code>values</code> is the object that is used to share data for scrolling and other shared values.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">values</span> <span class="o">=</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-83" id="section-83">&#182;</a>
</div>
<ul>
<li><a name="values.dirty"></a>if the data is dirty and a render has not happended since the data change.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">dirty</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-84" id="section-84">&#182;</a>
</div>
<ul>
<li><a name="values.scroll"></a>current scroll value of the grid</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">scroll</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-85" id="section-85">&#182;</a>
</div>
<ul>
<li><a name="values.speed"></a>current speed of the scroll</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">speed</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-86" id="section-86">&#182;</a>
</div>
<ul>
<li><a name="values.absSpeed"></a>current absSpeed of the grid.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">absSpeed</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-87" id="section-87">&#182;</a>
</div>
<ul>
<li><a name="values.scrollPercent"></a>the current percent position of the scroll.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">scrollPercent</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-88" id="section-88">&#182;</a>
</div>
<ul>
<li><a name="values.touchDown"></a>if there is currently a touch start and not a touch end. Since touch is used for scrolling on a touch device. Ignored for desktop.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">touchDown</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-89" id="section-89">&#182;</a>
</div>
<ul>
<li><a name="values.scrollingStopIntv"></a>interval that allows waits for checks to know when the scrolling has stopped and a render is needed.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">scrollingStopIntv</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-90" id="section-90">&#182;</a>
</div>
<ul>
<li><a name="values.activeRange"></a>the current range of active scopes.</li>
</ul>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">activeRange</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">min</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nx">max</span><span class="o">:</span> <span class="mi">0</span>
        <span class="p">}</span>
    <span class="p">};</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-91" id="section-91">&#182;</a>
</div>
<p><a name="logEvents"></a>listing the log events so they can be ignored if needed.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">logEvents</span> <span class="o">=</span> <span class="p">[</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">LOG</span><span class="p">,</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">INFO</span><span class="p">,</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">WARN</span><span class="p">,</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ERROR</span> <span class="p">];</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-92" id="section-92">&#182;</a>
</div>
<p><a name="inst"></a>the instance of the datagrid that will be referenced by all addons.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">inst</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">eventLogger</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">startupComplete</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">gcIntv</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-93" id="section-93">&#182;</a>
</div>
<p>wrap the instance for logging.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">exports</span><span class="p">.</span><span class="nx">logWrapper</span><span class="p">(</span><span class="s2">&quot;datagrid event&quot;</span><span class="p">,</span> <span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="nx">dispatch</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="init">
  <h3>
    <a href="#init" name="init" class="pilcrow">&#182;</a>
    <a name="init">init</a>
  </h3>
</div>


<p>Initialize the datagrid. Add unique methods to the flow control.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">init</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">unique</span><span class="p">(</span><span class="nx">reset</span><span class="p">);</span>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">unique</span><span class="p">(</span><span class="nx">render</span><span class="p">);</span>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">unique</span><span class="p">(</span><span class="nx">updateRowWatchers</span><span class="p">);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="setupexports">
  <h3>
    <a href="#setupexports" name="setupexports" class="pilcrow">&#182;</a>
    <a name="setupExports">setupExports</a>
  </h3>
</div>


<p>Build out the public api variables for the datagrid.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">setupExports</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">uid</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">uid</span><span class="p">();</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">scope</span><span class="p">.</span><span class="nx">$eval</span><span class="p">(</span><span class="nx">attr</span><span class="p">.</span><span class="nx">gridName</span><span class="p">)</span> <span class="o">||</span> <span class="s2">&quot;datagrid&quot;</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">scope</span> <span class="o">=</span> <span class="nx">scope</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">element</span> <span class="o">=</span> <span class="nx">element</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">attr</span> <span class="o">=</span> <span class="nx">attr</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">rowsLength</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">scopes</span> <span class="o">=</span> <span class="nx">scopes</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">data</span> <span class="o">||</span> <span class="p">[];</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">unwatchers</span> <span class="o">=</span> <span class="nx">unwatchers</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span> <span class="o">=</span> <span class="nx">values</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">start</span> <span class="o">=</span> <span class="nx">start</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">update</span> <span class="o">=</span> <span class="nx">update</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">reset</span> <span class="o">=</span> <span class="nx">reset</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">isReady</span> <span class="o">=</span> <span class="nx">isReady</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">isStartupComplete</span> <span class="o">=</span> <span class="nx">isStartupComplete</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">forceRenderScope</span> <span class="o">=</span> <span class="nx">forceRenderScope</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">dispatch</span> <span class="o">=</span> <span class="nx">dispatch</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">activateScope</span> <span class="o">=</span> <span class="nx">activateScope</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">deactivateScope</span> <span class="o">=</span> <span class="nx">deactivateScope</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">render</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">render</span><span class="p">);</span>
        <span class="p">};</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">updateHeights</span> <span class="o">=</span> <span class="nx">updateHeights</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">getOffsetIndex</span> <span class="o">=</span> <span class="nx">getOffsetIndex</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">isActive</span> <span class="o">=</span> <span class="nx">isActive</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">isCompiled</span> <span class="o">=</span> <span class="nx">isCompiled</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">swapItem</span> <span class="o">=</span> <span class="nx">swapItem</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">getScope</span> <span class="o">=</span> <span class="nx">getScope</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">getRowItem</span> <span class="o">=</span> <span class="nx">getRowItem</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">getRowElm</span> <span class="o">=</span> <span class="nx">getRowElm</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">getRowIndex</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getIndexOf</span> <span class="o">=</span> <span class="nx">getRowIndex</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">getRowOffset</span> <span class="o">=</span> <span class="nx">getRowOffset</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">getRowHeight</span> <span class="o">=</span> <span class="nx">getRowHeight</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">getViewportHeight</span> <span class="o">=</span> <span class="nx">getViewportHeight</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">getContentHeight</span> <span class="o">=</span> <span class="nx">getContentHeight</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">getContent</span> <span class="o">=</span> <span class="nx">getContent</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">safeDigest</span> <span class="o">=</span> <span class="nx">safeDigest</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">getRowIndexFromElement</span> <span class="o">=</span> <span class="nx">getRowIndexFromElement</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">updateViewportHeight</span> <span class="o">=</span> <span class="nx">updateViewportHeight</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">calculateViewportHeight</span> <span class="o">=</span> <span class="nx">calculateViewportHeight</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">options</span><span class="p">,</span> <span class="nx">scope</span><span class="p">.</span><span class="nx">$eval</span><span class="p">(</span><span class="nx">attr</span><span class="p">.</span><span class="nx">options</span><span class="p">)</span> <span class="o">||</span> <span class="p">{});</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">flow</span> <span class="o">=</span> <span class="nx">flow</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Flow</span><span class="p">({</span>
            <span class="nx">async</span><span class="o">:</span> <span class="nx">options</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s2">&quot;async&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="o">!!</span><span class="nx">options</span><span class="p">.</span><span class="nx">async</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nx">debug</span><span class="o">:</span> <span class="nx">options</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s2">&quot;debug&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="nx">options</span><span class="p">.</span><span class="nx">debug</span> <span class="o">:</span> <span class="mi">0</span>
        <span class="p">},</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-96" id="section-96">&#182;</a>
</div>
<p>this needs to be set immediatly so that it will be available to other views.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">grouped</span> <span class="o">=</span> <span class="nx">scope</span><span class="p">.</span><span class="nx">$eval</span><span class="p">(</span><span class="nx">attr</span><span class="p">.</span><span class="nx">grouped</span><span class="p">);</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">gc</span> <span class="o">=</span> <span class="nx">forceGarbageCollection</span><span class="p">;</span>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">init</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-97" id="section-97">&#182;</a>
</div>
<p>initialize core.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">run</span><span class="p">();</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="createconent">
  <h3>
    <a href="#createconent" name="createconent" class="pilcrow">&#182;</a>
    <a name="createContent">createConent</a>
  </h3>
</div>


<p>The <a href="#content">content</a> dom element is the only direct child created by the datagrid.
It is used so append all of the <code>chunks</code> so that the it can be scrolled.
If the dom element is provided with the class <a href="#content">content</a> then that dom element will be used
allowing the user to add custom classes directly tot he <a href="#content">content</a> dom element.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">createContent</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">contents</span> <span class="o">=</span> <span class="nx">element</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">contentClass</span><span class="p">),</span> <span class="nx">cnt</span><span class="p">,</span> <span class="nx">classes</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">contentClass</span><span class="p">;</span>
        <span class="nx">contents</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">contents</span><span class="p">,</span> <span class="nx">filterOldContent</span><span class="p">);</span>
        <span class="nx">cnt</span> <span class="o">=</span> <span class="nx">contents</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">cnt</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-99" id="section-99">&#182;</a>
</div>
<p>if there is an old one. Pull the classes from it.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">classes</span> <span class="o">=</span> <span class="nx">cnt</span><span class="p">.</span><span class="nx">className</span> <span class="o">||</span> <span class="nx">options</span><span class="p">.</span><span class="nx">contentClass</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">cnt</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">classes</span> <span class="o">=</span> <span class="nx">getClassesFromOldContent</span><span class="p">()</span> <span class="o">||</span> <span class="nx">classes</span><span class="p">;</span>
            <span class="nx">cnt</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">element</span><span class="p">(</span><span class="s1">&#39;&lt;div class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">classes</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&lt;/div&gt;&#39;</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">chunks</span><span class="p">.</span><span class="nx">detachDom</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">cnt</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="s2">&quot;relative&quot;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">element</span><span class="p">.</span><span class="nx">prepend</span><span class="p">(</span><span class="nx">cnt</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">cnt</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
            <span class="nx">cnt</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">element</span><span class="p">(</span><span class="nx">cnt</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">cnt</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="getclassesfromoldcontent">
  <h3>
    <a href="#getclassesfromoldcontent" name="getclassesfromoldcontent" class="pilcrow">&#182;</a>
    <a name="getClassesFromOldContent">getClassesFromOldContent</a>
  </h3>
</div>


<p>If the old content exists it may have been an original dom element passed to the datagrid. If so we want
to keep that dom elements classes in tact.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getClassesFromOldContent</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">classes</span><span class="p">,</span> <span class="nx">index</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">oldContent</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-101" id="section-101">&#182;</a>
</div>
<p>let's get classes from it.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">classes</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">array</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(</span><span class="nx">oldContent</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">classList</span><span class="p">);</span>
            <span class="nx">index</span> <span class="o">=</span> <span class="nx">classes</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">&quot;old-&quot;</span> <span class="o">+</span> <span class="nx">options</span><span class="p">.</span><span class="nx">contentClass</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">classes</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="nx">classes</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="filteroldcontent">
  <h3>
    <a href="#filteroldcontent" name="filteroldcontent" class="pilcrow">&#182;</a>
    <a name="filterOldContent">filterOldContent</a>
  </h3>
</div>


<p>filter the list of content dom to remove any references to the [oldContent][#oldContent].</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">cnt</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">index</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">list</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">filterOldContent</span><span class="p">(</span><span class="nx">cnt</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">element</span><span class="p">(</span><span class="nx">cnt</span><span class="p">).</span><span class="nx">hasClass</span><span class="p">(</span><span class="s2">&quot;old-&quot;</span> <span class="o">+</span> <span class="nx">options</span><span class="p">.</span><span class="nx">contentClass</span><span class="p">)</span> <span class="o">?</span> <span class="kc">false</span> <span class="o">:</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="getcontent">
  <h3>
    <a href="#getcontent" name="getcontent" class="pilcrow">&#182;</a>
    <a name="getContent">getContent</a>
  </h3>
</div>


<p>return the reference to the content div.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getContent</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">content</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="start">
  <h3>
    <a href="#start" name="start" class="pilcrow">&#182;</a>
    <a name="start">start</a>
  </h3>
</div>


<p><code>start</code> is called after the addons are added.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">start</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_INIT</span><span class="p">);</span>
        <span class="nx">content</span> <span class="o">=</span> <span class="nx">createContent</span><span class="p">();</span>
        <span class="nx">waitForElementReady</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="waitforelementready">
  <h3>
    <a href="#waitforelementready" name="waitforelementready" class="pilcrow">&#182;</a>
    <a name="waitForElementReady">waitForElementReady</a>
  </h3>
</div>


<p>this waits for the body element because if the grid has been constructed, but no heights are showing
it is usually because the grid has not been attached to the document yet. So wait for the heights
to be available, but only wait a little then exit.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">count
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">waitForElementReady</span><span class="p">(</span><span class="nx">count</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">inst</span><span class="p">.</span><span class="nx">element</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">offsetHeight</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">count</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-106" id="section-106">&#182;</a>
</div>
<p>if they are doing custom compiling. They may compile before addit it to the dom.
allow a pass to happen just in case.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">waitForElementReady</span><span class="p">,</span> <span class="p">[</span> <span class="nx">count</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">],</span> <span class="mi">0</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-107" id="section-107">&#182;</a>
</div>
<p>retry.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">flow</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s2">&quot;Datagrid: Dom Element does not have a height.&quot;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">templateModel</span> <span class="o">&amp;&amp;</span> <span class="nx">options</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">.</span><span class="nx">templates</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">.</span><span class="nx">createTemplatesFromData</span><span class="p">,</span> <span class="p">[</span> <span class="nx">options</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">.</span><span class="nx">templates</span> <span class="p">],</span> <span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">.</span><span class="nx">createTemplates</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-108" id="section-108">&#182;</a>
</div>
<p>allow element to be added to dom.
if the templates have different heights. Then they are dynamic.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="kd">function</span> <span class="nx">updateDynamicRowHeights</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">options</span><span class="p">.</span><span class="nx">dynamicRowHeights</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">.</span><span class="nx">dynamicHeights</span><span class="p">();</span>
        <span class="p">});</span>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">addListeners</span><span class="p">);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="addlisteners">
  <h3>
    <a href="#addlisteners" name="addlisteners" class="pilcrow">&#182;</a>
    <a name="addListeners">addListeners</a>
  </h3>
</div>


<p>Adds listeners. Notice that all listeners are added to the unwatchers array so that they can be cleared
before references are removed to avoid memory leaks with circular references amd to prevent events from
being listened to while the destroy is happening.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">addListeners</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">unwatchFirstRender</span> <span class="o">=</span> <span class="nx">scope</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_BEFORE_RENDER_AFTER_DATA_CHANGE</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">unwatchFirstRender</span><span class="p">();</span>
            <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">onStartupComplete</span><span class="p">);</span>
        <span class="p">});</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;resize&quot;</span><span class="p">,</span> <span class="nx">onResize</span><span class="p">);</span>
        <span class="nx">unwatchers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">scope</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">UPDATE</span><span class="p">,</span> <span class="nx">update</span><span class="p">));</span>
        <span class="nx">unwatchers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">scope</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_ROW_TEMPLATE_CHANGE</span><span class="p">,</span> <span class="nx">onRowTemplateChange</span><span class="p">));</span>
        <span class="nx">unwatchers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">scope</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="s2">&quot;$destroy&quot;</span><span class="p">,</span> <span class="nx">destroy</span><span class="p">));</span>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">setupChangeWatcher</span><span class="p">,</span> <span class="p">[],</span> <span class="mi">0</span><span class="p">);</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_LISTENERS_READY</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">isStartupComplete</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">startupComplete</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">onStartupComplete</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">startupComplete</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="nx">dispatch</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_STARTUP_COMPLETE</span><span class="p">);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="setupchangewatcher">
  <h3>
    <a href="#setupchangewatcher" name="setupchangewatcher" class="pilcrow">&#182;</a>
    <a name="setupChangeWatcher">setupChangeWatcher</a>
  </h3>
</div>


<p>When a change happens update the dom.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">setupChangeWatcher</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">changeWatcherSet</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;setupChangeWatcher&quot;</span><span class="p">);</span>
            <span class="nx">changeWatcherSet</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="nx">unwatchers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">scope</span><span class="p">.</span><span class="nx">$watchCollection</span><span class="p">(</span><span class="nx">attr</span><span class="p">.</span><span class="nx">uxDatagrid</span><span class="p">,</span> <span class="nx">onDataChangeFromWatcher</span><span class="p">));</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-111" id="section-111">&#182;</a>
</div>
<p>force intial watcher.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="kd">var</span> <span class="nx">d</span> <span class="o">=</span> <span class="nx">scope</span><span class="p">.</span><span class="nx">$eval</span><span class="p">(</span><span class="nx">attr</span><span class="p">.</span><span class="nx">uxDatagrid</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">d</span> <span class="o">&amp;&amp;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">render</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="ondatachangefromwatcher">
  <h3>
    <a href="#ondatachangefromwatcher" name="ondatachangefromwatcher" class="pilcrow">&#182;</a>
    <a name="onDataChangeFromWatcher">onDataChangeFromWatcher</a>
  </h3>
</div>


<p>when the watcher fires.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">newValue</span>
      <span class="dox_type">*</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">oldValue</span>
      <span class="dox_type">*</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">scope
</span>
      <span class="dox_type">Scope</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">onDataChangeFromWatcher</span><span class="p">(</span><span class="nx">newValue</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">,</span> <span class="nx">scope</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">onDataChanged</span><span class="p">,</span> <span class="p">[</span> <span class="nx">newValue</span><span class="p">,</span> <span class="nx">oldValue</span> <span class="p">]);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="updateviewportheight">
  <h3>
    <a href="#updateviewportheight" name="updateviewportheight" class="pilcrow">&#182;</a>
    <a name="updateViewportHeight">updateViewportHeight</a>
  </h3>
</div>


<p>This function can be used to force update the viewHeight.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">updateViewportHeight</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">viewHeight</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">calculateViewportHeight</span><span class="p">();</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="isready">
  <h3>
    <a href="#isready" name="isready" class="pilcrow">&#182;</a>
    <a name="isReady">isReady</a>
  </h3>
</div>


<p>return if grid state is <a href="#states.READY">states.READY</a>.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">isReady</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">state</span> <span class="o">===</span> <span class="nx">states</span><span class="p">.</span><span class="nx">READY</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="calculateviewportheight">
  <h3>
    <a href="#calculateviewportheight" name="calculateviewportheight" class="pilcrow">&#182;</a>
    <a name="calculateViewportHeight">calculateViewportHeight</a>
  </h3>
</div>


<p>Calculate Viewport Height can be expensive. Depending on the number of dom elemnts.
so if you need to use this method, use it sparingly because you may experience performance
issues if overused.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">calculateViewportHeight</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">element</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">offsetHeight</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="onresize">
  <h3>
    <a href="#onresize" name="onresize" class="pilcrow">&#182;</a>
    <a name="onResize">onResize</a>
  </h3>
</div>


<p>When a resize happens dispatch that event for addons to listen to so events happen after
the grid has performed it's changes.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">event
</span>
      <span class="dox_type">Event</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">onResize</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-117" id="section-117">&#182;</a>
</div>
<p>we need to wait a moment for the browser to finish the resize, then adjust and fire the event.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">updateHeights</span><span class="p">,</span> <span class="p">[],</span> <span class="mi">100</span><span class="p">);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="swapitem">
  <h2>
    <a href="#swapitem" name="swapitem" class="pilcrow">&#182;</a>
    <a name="swapItem">swapItem</a>
  </h2>
</div>


<p>swap out an old item with a new item without causing a data change. Quick swap of items.
this will only work if the item already exists in the datagrid. You cannot add or remove items
this way. Only change them to a different reference. Adding or Removing requires a re-chunking.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">oldItem</span>
      <span class="dox_type">Object</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">newItem</span>
      <span class="dox_type">Object</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">keepTemplate
</span>
      <span class="dox_type">Boolean=</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">swapItem</span><span class="p">(</span><span class="nx">oldItem</span><span class="p">,</span> <span class="nx">newItem</span><span class="p">,</span> <span class="nx">keepTemplate</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-119" id="section-119">&#182;</a>
</div>
<p>TODO: needs unit test.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">getRowIndex</span><span class="p">(</span><span class="nx">oldItem</span><span class="p">),</span> <span class="nx">oldTpl</span><span class="p">,</span> <span class="nx">newTpl</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">index</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">oldTpl</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">.</span><span class="nx">getTemplate</span><span class="p">(</span><span class="nx">oldItem</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">keepTemplate</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">newTpl</span> <span class="o">=</span> <span class="nx">oldTpl</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">newTpl</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">.</span><span class="nx">getTemplate</span><span class="p">(</span><span class="nx">newItem</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">normalizeModel</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">newItem</span><span class="p">,</span> <span class="nx">index</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">oldTpl</span> <span class="o">!==</span> <span class="nx">newTpl</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">.</span><span class="nx">setTemplate</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">newTpl</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-120" id="section-120">&#182;</a>
</div>
<p>nothing changed except the reference. So just update the scope and digest.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">scopes</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="nx">newTpl</span><span class="p">.</span><span class="nx">item</span><span class="p">]</span> <span class="o">=</span> <span class="nx">newItem</span><span class="p">;</span>
                <span class="nx">safeDigest</span><span class="p">(</span><span class="nx">scopes</span><span class="p">[</span><span class="nx">index</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="getscope">
  <h3>
    <a href="#getscope" name="getscope" class="pilcrow">&#182;</a>
    <a name="getScope">getScope</a>
  </h3>
</div>


<p>Return the scope of the row at that index.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">index</span>
      <span class="dox_type">Number</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getScope</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">scopes</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="getrowitem">
  <h3>
    <a href="#getrowitem" name="getrowitem" class="pilcrow">&#182;</a>
    <a name="getRowItem">getRowItem</a>
  </h3>
</div>


<p>Return the data item of that row.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">index</span>
      <span class="dox_type">Number</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getRowItem</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">getData</span><span class="p">()[</span><span class="nx">index</span><span class="p">];</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="getrowelm">
  <h3>
    <a href="#getrowelm" name="getrowelm" class="pilcrow">&#182;</a>
    <a name="getRowElm">getRowElm</a>
  </h3>
</div>


<p>Return the dom element at that row index.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">index</span>
      <span class="dox_type">Number</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getRowElm</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">element</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">chunkModel</span><span class="p">.</span><span class="nx">getRow</span><span class="p">(</span><span class="nx">index</span><span class="p">));</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="iscompiled">
  <h3>
    <a href="#iscompiled" name="iscompiled" class="pilcrow">&#182;</a>
    <a name="isCompiled">isCompiled</a>
  </h3>
</div>


<p>Return if the row is compiled or not.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">index</span>
      <span class="dox_type">Number</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">isCompiled</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">!!</span><span class="nx">scopes</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="getrowindex">
  <h3>
    <a href="#getrowindex" name="getrowindex" class="pilcrow">&#182;</a>
    <a name="getRowIndex">getRowIndex</a>
  </h3>
</div>


<p>Get the index of a row from a reference the data object of a row.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">item</span>
      <span class="dox_type">Number</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getRowIndex</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getNormalizedIndex</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="getrowindexfromelement">
  <h3>
    <a href="#getrowindexfromelement" name="getrowindexfromelement" class="pilcrow">&#182;</a>
    <a name="getRowIndexFromElement">getRowIndexFromElement</a>
  </h3>
</div>


<p>Get the index of a row from a reference to a dom element that is contained within a row.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">el</span>
      <span class="dox_type">JQLite</span>
      <span class="dox_type">DOMElement</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getRowIndexFromElement</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">element</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">contains</span><span class="p">(</span><span class="nx">el</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">||</span> <span class="nx">el</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">el</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">scope</span> <span class="o">?</span> <span class="nx">el</span> <span class="o">:</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">element</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span>
            <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">scope</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">s</span> <span class="o">===</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">scope</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;Unable to get row scope... something went wrong.&quot;</span><span class="p">);</span>
            <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-127" id="section-127">&#182;</a>
</div>
<p>make sure we get the right scope to grab the index from. We need to get it from a row.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">while</span> <span class="p">(</span><span class="nx">s</span> <span class="o">&amp;&amp;</span> <span class="nx">s</span><span class="p">.</span><span class="nx">$parent</span> <span class="o">&amp;&amp;</span> <span class="nx">s</span><span class="p">.</span><span class="nx">$parent</span> <span class="o">!==</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">scope</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">s</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">$parent</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="nx">s</span><span class="p">.</span><span class="nx">$index</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="getrowoffset">
  <h3>
    <a href="#getrowoffset" name="getrowoffset" class="pilcrow">&#182;</a>
    <a name="getRowOffset">getRowOffset</a>
  </h3>
</div>


<p>Return the scroll offset of a row by it's index. All offsets are cached, they get updated if
a row template changes, because it may change it height as well.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">index</span>
      <span class="dox_type">Number</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getRowOffset</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">rowOffsets</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">dynamicRowHeights</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-129" id="section-129">&#182;</a>
</div>
<p>dynamicRowHeights should be set by the templates.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">updateHeightValues</span><span class="p">();</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">rowOffsets</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">=</span> <span class="nx">index</span> <span class="o">*</span> <span class="nx">options</span><span class="p">.</span><span class="nx">rowHeight</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">rowOffsets</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="getrowheight">
  <h3>
    <a href="#getrowheight" name="getrowheight" class="pilcrow">&#182;</a>
    <a name="getRowHeight">getRowHeight</a>
  </h3>
</div>


<p>Return the cached height of a row by index.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">index</span>
      <span class="dox_type">Number</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getRowHeight</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">.</span><span class="nx">getTemplateHeight</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">index</span><span class="p">]);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="getviewportheight">
  <h3>
    <a href="#getviewportheight" name="getviewportheight" class="pilcrow">&#182;</a>
    <a name="getViewportHeight">getViewportHeight</a>
  </h3>
</div>


<p>Return the height of the viewable area of the datagrid.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getViewportHeight</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">viewHeight</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="getcontentheight">
  <h3>
    <a href="#getcontentheight" name="getcontentheight" class="pilcrow">&#182;</a>
    <a name="getConentHeight">getContentHeight</a>
  </h3>
</div>


<p>Return the total height of the content of the datagrid.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getContentHeight</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">list</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">chunkModel</span><span class="p">.</span><span class="nx">getChunkList</span><span class="p">();</span>
        <span class="k">return</span> <span class="nx">list</span> <span class="o">&amp;&amp;</span> <span class="nx">list</span><span class="p">.</span><span class="nx">height</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="createdom">
  <h3>
    <a href="#createdom" name="createdom" class="pilcrow">&#182;</a>
    <a name="createDom">createDom</a>
  </h3>
</div>


<p>This starts off the chunking. It creates all of the dom chunks, rows, etc for the datagrid.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">list
</span>
      <span class="dox_type">Array</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">createDom</span><span class="p">(</span><span class="nx">list</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-134" id="section-134">&#182;</a>
</div>
<p>TODO: if there is any dom. It needs destroyed first.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;OVERWRITE DOM!!!&quot;</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-135" id="section-135">&#182;</a>
</div>
<p>this async is important because it allows the updateRowWatchers on first digest to escape the current digest.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">chunkModel</span><span class="p">.</span><span class="nx">chunkDom</span><span class="p">(</span><span class="nx">list</span><span class="p">,</span> <span class="nx">options</span><span class="p">.</span><span class="nx">chunks</span><span class="p">.</span><span class="nx">size</span><span class="p">,</span> <span class="s1">&#39;&lt;div class=&quot;&#39;</span> <span class="o">+</span> <span class="nx">options</span><span class="p">.</span><span class="nx">chunks</span><span class="p">.</span><span class="nx">chunkClass</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&#39;</span><span class="p">,</span> <span class="s2">&quot;&lt;/div&gt;&quot;</span><span class="p">,</span> <span class="nx">content</span><span class="p">);</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">rowsLength</span> <span class="o">=</span> <span class="nx">len</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;created %s dom elements&quot;</span><span class="p">,</span> <span class="nx">len</span><span class="p">);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="compilerow">
  <h3>
    <a href="#compilerow" name="compilerow" class="pilcrow">&#182;</a>
    <a name="compileRow">compileRow</a>
  </h3>
</div>


<p>Compile a row at that index. This creates the scope for that row when compiled. It does not perform a digest.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">index</span>
      <span class="dox_type">Number</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">compileRow</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">scopes</span><span class="p">[</span><span class="nx">index</span><span class="p">],</span> <span class="nx">prev</span><span class="p">,</span> <span class="nx">tpl</span><span class="p">,</span> <span class="nx">el</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">s</span> <span class="o">=</span> <span class="nx">scope</span><span class="p">.</span><span class="nx">$new</span><span class="p">();</span>
            <span class="nx">prev</span> <span class="o">=</span> <span class="nx">getScope</span><span class="p">(</span><span class="nx">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
            <span class="nx">tpl</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">.</span><span class="nx">getTemplate</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">index</span><span class="p">]);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">prev</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">prev</span><span class="p">.</span><span class="nx">$$nextSibling</span> <span class="o">=</span> <span class="nx">s</span><span class="p">;</span>
                <span class="nx">s</span><span class="p">.</span><span class="nx">$$prevSibling</span> <span class="o">=</span> <span class="nx">prev</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">s</span><span class="p">.</span><span class="nx">$status</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">compiledClass</span><span class="p">;</span>
            <span class="nx">s</span><span class="p">[</span><span class="nx">tpl</span><span class="p">.</span><span class="nx">item</span><span class="p">]</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-137" id="section-137">&#182;</a>
</div>
<p>set the data to the scope.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">s</span><span class="p">.</span><span class="nx">$index</span> <span class="o">=</span> <span class="nx">index</span><span class="p">;</span>
            <span class="nx">scopes</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">=</span> <span class="nx">s</span><span class="p">;</span>
            <span class="nx">el</span> <span class="o">=</span> <span class="nx">getRowElm</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span>
            <span class="nx">el</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">uncompiledClass</span><span class="p">);</span>
            <span class="nx">$compile</span><span class="p">(</span><span class="nx">el</span><span class="p">)(</span><span class="nx">s</span><span class="p">);</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_ROW_COMPILE</span><span class="p">,</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">el</span><span class="p">);</span>
            <span class="nx">deactivateScope</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">s</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="buildrows">
  <h3>
    <a href="#buildrows" name="buildrows" class="pilcrow">&#182;</a>
    <a name="buildRows">buildRows</a>
  </h3>
</div>


<p>Set the state to <a name="states.BUILDING">states.BUILDING</a>. Then build the dom.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">list</span>
      <span class="dox_type">Array</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">forceRender
</span>
      <span class="dox_type">Boolean=</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">buildRows</span><span class="p">(</span><span class="nx">list</span><span class="p">,</span> <span class="nx">forceRender</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;  buildRows %s&quot;</span><span class="p">,</span> <span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
        <span class="nx">state</span> <span class="o">=</span> <span class="nx">states</span><span class="p">.</span><span class="nx">BUILDING</span><span class="p">;</span>
        <span class="nx">createDom</span><span class="p">(</span><span class="nx">list</span><span class="p">);</span>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">updateHeightValues</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isReady</span><span class="p">())</span> <span class="p">{</span>
            <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">ready</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">forceRender</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">render</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="ready">
  <h3>
    <a href="#ready" name="ready" class="pilcrow">&#182;</a>
    <a name="ready">ready</a>
  </h3>
</div>


<p>Set the state to <a href="states.ON_READY">states.READY</a> and start the first render.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">ready</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;  ready&quot;</span><span class="p">);</span>
        <span class="nx">state</span> <span class="o">=</span> <span class="nx">states</span><span class="p">.</span><span class="nx">READY</span><span class="p">;</span>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">fireReadyEvent</span><span class="p">);</span>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">safeDigest</span><span class="p">,</span> <span class="p">[</span> <span class="nx">scope</span> <span class="p">]);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="firereadyevent">
  <h3>
    <a href="#firereadyevent" name="firereadyevent" class="pilcrow">&#182;</a>
    <a name="fireReadyEvent">fireReadyEvent</a>
  </h3>
</div>


<p>Fire the <a name="events.ON_READY">events.ON_READY</a></p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">fireReadyEvent</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">scope</span><span class="p">.</span><span class="nx">$emit</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_READY</span><span class="p">);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="safedigest">
  <h3>
    <a href="#safedigest" name="safedigest" class="pilcrow">&#182;</a>
    <a name="safeDigest">safeDigest</a>
  </h3>
</div>


<p>SafeDigest by checking the render phase of the scope before rendering.
while this is not recommended by angular it is effective.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">s
</span>
      <span class="dox_type">Scope</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">safeDigest</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-142" id="section-142">&#182;</a>
</div>

<div class="highlight"><pre><code>   <span class="n">s</span><span class="p">.</span><span class="err">$</span><span class="n">evalAsync</span><span class="p">();</span><span class="c1">// this sometimes takes too long so I see {{}} brackets briefly.</span>
</code></pre></div>


        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="kd">var</span> <span class="nx">ds</span> <span class="o">=</span> <span class="nx">s</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">ds</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">ds</span><span class="p">.</span><span class="nx">$$phase</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">ds</span> <span class="o">=</span> <span class="nx">ds</span><span class="p">.</span><span class="nx">$parent</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">s</span><span class="p">.</span><span class="nx">$digest</span><span class="p">();</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="applyeventcounts">
  <h3>
    <a href="#applyeventcounts" name="applyeventcounts" class="pilcrow">&#182;</a>
    <a name="applyEventCounts">applyEventCounts</a>
  </h3>
</div>


<p>Take all of the counts that we have and move up the parent chain subtracting them from the totals
so that event listeners do not get stuck on broadcast.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">s</span>
      <span class="dox_type">Scope</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">listenerCounts</span>
      <span class="dox_type">Object</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">fn
</span>
      <span class="dox_type">Function</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">applyEventCounts</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">listenerCounts</span><span class="p">,</span> <span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">eventName</span> <span class="k">in</span> <span class="nx">listenerCounts</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">listenerCounts</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">eventName</span><span class="p">))</span> <span class="p">{</span>
                    <span class="nx">fn</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">listenerCounts</span><span class="p">,</span> <span class="nx">eventName</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="nx">s</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">$parent</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="addevents">
  <h3>
    <a href="#addevents" name="addevents" class="pilcrow">&#182;</a>
    <a name="addEvents">addEvents</a>
  </h3>
</div>


<p>Take all of the counts that we have and move up the parent chain adding them from the totals
so that event listeners have them back for broadcast events.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">s</span>
      <span class="dox_type">Scope</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">listenerCounts
</span>
      <span class="dox_type">Object</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">addEvents</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">listenerCounts</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">applyEventCounts</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">listenerCounts</span><span class="p">,</span> <span class="nx">addEvent</span><span class="p">);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="addevent">
  <h3>
    <a href="#addevent" name="addevent" class="pilcrow">&#182;</a>
    <a name="addEvent">addEvent</a>
  </h3>
</div>


<p>Add the event to the $$listenerCount.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">s</span>
      <span class="dox_type">Scope</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">listenerCounts</span>
      <span class="dox_type">Object</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">eventName
</span>
      <span class="dox_type">String</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">addEvent</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">listenerCounts</span><span class="p">,</span> <span class="nx">eventName</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-146" id="section-146">&#182;</a>
</div>
<p>console.log("%c%s.$$listenerCount[%s] %s + %s = %s", "color:#009900", s.$id, eventName, s.$$listenerCount[eventName], listenerCounts[eventName], s.$$listenerCount[eventName] + listenerCounts[eventName]);</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">s</span><span class="p">.</span><span class="nx">$$listenerCount</span><span class="p">[</span><span class="nx">eventName</span><span class="p">]</span> <span class="o">+=</span> <span class="nx">listenerCounts</span><span class="p">[</span><span class="nx">eventName</span><span class="p">];</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="subtractevents">
  <h3>
    <a href="#subtractevents" name="subtractevents" class="pilcrow">&#182;</a>
    <a name="subtractEvents">subtractEvents</a>
  </h3>
</div>


<p>Take all of the counts that we have and move up the parent chain subtracting them from the totals
so that event listeners do not get stuck on broadcast.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">s</span>
      <span class="dox_type">Scope</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">listenerCounts
</span>
      <span class="dox_type">Object</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">subtractEvents</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">listenerCounts</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">applyEventCounts</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">listenerCounts</span><span class="p">,</span> <span class="nx">subtractEvent</span><span class="p">);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="subtractevent">
  <h3>
    <a href="#subtractevent" name="subtractevent" class="pilcrow">&#182;</a>
    <a name="subtractEvent">subtractEvent</a>
  </h3>
</div>


<p>Take the count of events away from the $$listenerCount</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">s</span>
      <span class="dox_type">Scope</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">listenerCounts</span>
      <span class="dox_type">Object</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">eventName
</span>
      <span class="dox_type">String</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">subtractEvent</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">listenerCounts</span><span class="p">,</span> <span class="nx">eventName</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">s</span><span class="p">.</span><span class="nx">$$listenerCount</span><span class="p">[</span><span class="nx">eventName</span><span class="p">]</span> <span class="o">-=</span> <span class="nx">listenerCounts</span><span class="p">[</span><span class="nx">eventName</span><span class="p">];</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="deactivatescope">
  <h3>
    <a href="#deactivatescope" name="deactivatescope" class="pilcrow">&#182;</a>
    <a name="desctivateScope">deactivateScope</a>
  </h3>
</div>


<p>One of the core features to the datagrid's performance it the ability to make only the scopes
that are in view to render. This deactivates a scope by removing it's $$watchers that angular
uses to know that it needs to digest. Thus inactivating the row. We also remove all watchers from
child scopes recursively storing them on each child in a separate variable to activation later.
They need to be reactivated before being destroyed for proper cleanup.
$$childHead and $$nextSibling variables are also updated for angular so that it will not even iterate
over a scope that is deactivated. It becomes completely hidden from the digest.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">s</span>
      <span class="dox_type">Scope</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">depth</span>
      <span class="dox_type">Number=</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">deactivateScope</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">depth</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">child</span><span class="p">;</span>
        <span class="nx">depth</span> <span class="o">=</span> <span class="nx">depth</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-150" id="section-150">&#182;</a>
</div>
<p>if the scope is not created yet. just skip.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="nx">s</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">isActive</span><span class="p">(</span><span class="nx">s</span><span class="p">))</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-151" id="section-151">&#182;</a>
</div>
<p>do not deactivate one that is already deactivated.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">depth</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">s</span><span class="p">.</span><span class="nx">$emit</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_BEFORE_ROW_DEACTIVATE</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="nx">s</span><span class="p">.</span><span class="nx">$$$watchers</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">$$watchers</span><span class="p">;</span>
            <span class="nx">s</span><span class="p">.</span><span class="nx">$$watchers</span> <span class="o">=</span> <span class="p">[];</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">depth</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-152" id="section-152">&#182;</a>
</div>
<p>only do this on the first depth so we do not recursively reset counts.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">s</span><span class="p">.</span><span class="nx">$$$listenerCount</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">$$listenerCount</span><span class="p">;</span>
                <span class="nx">s</span><span class="p">.</span><span class="nx">$$listenerCount</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">copy</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">$$$listenerCount</span><span class="p">);</span>
                <span class="nx">subtractEvents</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">s</span><span class="p">.</span><span class="nx">$$$listenerCount</span><span class="p">);</span>
            <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-153" id="section-153">&#182;</a>
</div>
<p>RECURSIVE deactivate/activate memory tests show that it doesn't improve anything. So unless there is a good reason leave
this code commented out, because it does affect performance. It adds 30% to destroy time and time to rendering.
recursively go through children and deactivate them.
           if (s.$$childHead) {
               child = s.$$childHead;
               while (child) {
                   deactivateScope(child, depth + 1);
                   child = child.$$nextSibling;
               }
           }</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="activatescope">
  <h3>
    <a href="#activatescope" name="activatescope" class="pilcrow">&#182;</a>
    <a name="activateScope">activateScope</a>
  </h3>
</div>


<p>Taking a scope that is deactivated the watchers that it did have are now stored on $$$watchers and
can be put back to $$watchers so angular will pick up this scope on a digest. This is done recursively
though child scopes as well to activate them. It also updates the linking $$childHead and $$nextSiblings
to fully make sure the scope is as if it was before it was deactivated.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">s</span>
      <span class="dox_type">Scope</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">depth</span>
      <span class="dox_type">Number=</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">activateScope</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">depth</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">child</span><span class="p">;</span>
        <span class="nx">depth</span> <span class="o">=</span> <span class="nx">depth</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">s</span> <span class="o">&amp;&amp;</span> <span class="nx">s</span><span class="p">.</span><span class="nx">$$$watchers</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-155" id="section-155">&#182;</a>
</div>
<p>do not activate one that is already active.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">s</span><span class="p">.</span><span class="nx">$$watchers</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">$$$watchers</span><span class="p">;</span>
            <span class="nx">s</span><span class="p">.</span><span class="nx">$$$watchers</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">depth</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">addEvents</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">s</span><span class="p">.</span><span class="nx">$$$listenerCount</span><span class="p">);</span>
                <span class="nx">s</span><span class="p">.</span><span class="nx">$$$listenerCount</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-156" id="section-156">&#182;</a>
</div>
<p>recursively go through children and activate them.
           if (s.$$childHead) {
               child = s.$$childHead;
               while (child) {
                   activateScope(child, depth + 1);
                   child = child.$$nextSibling;
               }
           }</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">depth</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">s</span><span class="p">.</span><span class="nx">$emit</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_AFTER_ROW_ACTIVATE</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="o">!!</span><span class="p">(</span><span class="nx">s</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">s</span><span class="p">.</span><span class="nx">$$$watchers</span><span class="p">);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="isactive">
  <h3>
    <a href="#isactive" name="isactive" class="pilcrow">&#182;</a>
    <a name="isActive">isActive</a>
  </h3>
</div>


<p>Check a scope by index to see if it is active.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">index</span>
      <span class="dox_type">Number</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">isActive</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">scopes</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>
        <span class="k">return</span> <span class="o">!!</span><span class="p">(</span><span class="nx">s</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">s</span><span class="p">.</span><span class="nx">$$$watchers</span><span class="p">);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="getoffsetindex">
  <h3>
    <a href="#getoffsetindex" name="getoffsetindex" class="pilcrow">&#182;</a>
    <a name="getOffsetIndex">getOffsetIndex</a>
  </h3>
</div>


<p>Given a scroll offset, get the index that is closest to that scroll offset value.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">offset</span>
      <span class="dox_type">Number</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getOffsetIndex</span><span class="p">(</span><span class="nx">offset</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-159" id="section-159">&#182;</a>
</div>
<p>updateHeightValues must be called before this.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="kd">var</span> <span class="nx">est</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">offset</span> <span class="o">/</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">.</span><span class="nx">averageTemplateHeight</span><span class="p">()),</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">rowsLength</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">offset</span> <span class="o">||</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">rowsLength</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">i</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">rowOffsets</span><span class="p">[</span><span class="nx">est</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">rowOffsets</span><span class="p">[</span><span class="nx">est</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="nx">offset</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">i</span> <span class="o">=</span> <span class="nx">est</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">rowOffsets</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="nx">offset</span> <span class="o">&amp;&amp;</span> <span class="nx">rowOffsets</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="nx">offset</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">i</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">i</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="getstartingindex">
  <h3>
    <a href="#getstartingindex" name="getstartingindex" class="pilcrow">&#182;</a>
    <a name="getStartingIndex">getStartingIndex</a>
  </h3>
</div>


<p>Because the datagrid can render as many as 50k rows. It becomes necessary to optimize loops by
determining the index to start checking for deactivated and activated scopes at instead of iterating
all of the items. This greatly improves a render because it only iterates from where the last render was.
It does this by taking the last first active element and then counting from there till we get to the top
of the start area. So we never have to loop the whole thing.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getStartingIndex</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">values</span><span class="p">.</span><span class="nx">dirty</span> <span class="o">&amp;&amp;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">chunkModel</span><span class="p">.</span><span class="nx">getChunkList</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">chunkModel</span><span class="p">.</span><span class="nx">getChunkList</span><span class="p">().</span><span class="nx">height</span> <span class="o">-</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getViewportHeight</span><span class="p">()</span> <span class="o">&lt;</span> <span class="nx">values</span><span class="p">.</span><span class="nx">scroll</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-161" id="section-161">&#182;</a>
</div>
<p>We are trying to start the scroll off at a height that is taller than we have in the list.
reset scroll to 0.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;Scroll reset because either there is no data or the scroll is taller than there is scroll area&quot;</span><span class="p">);</span>
            <span class="nx">values</span><span class="p">.</span><span class="nx">scroll</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">height</span> <span class="o">=</span> <span class="nx">viewHeight</span><span class="p">,</span> <span class="nx">scroll</span> <span class="o">=</span> <span class="nx">values</span><span class="p">.</span><span class="nx">scroll</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">values</span><span class="p">.</span><span class="nx">scroll</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">startIndex</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nx">i</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nx">inc</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="nx">end</span><span class="o">:</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">rowsLength</span><span class="p">,</span>
            <span class="nx">visibleScrollStart</span><span class="o">:</span> <span class="nx">scroll</span> <span class="o">+</span> <span class="nx">options</span><span class="p">.</span><span class="nx">cushion</span><span class="p">,</span>
            <span class="nx">visibleScrollEnd</span><span class="o">:</span> <span class="nx">scroll</span> <span class="o">+</span> <span class="nx">height</span> <span class="o">-</span> <span class="nx">options</span><span class="p">.</span><span class="nx">cushion</span>
        <span class="p">};</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">startIndex</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">i</span> <span class="o">=</span> <span class="nx">getOffsetIndex</span><span class="p">(</span><span class="nx">scroll</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">rowsLength</span> <span class="o">&amp;&amp;</span> <span class="nx">result</span><span class="p">.</span><span class="nx">startIndex</span> <span class="o">===</span> <span class="nx">result</span><span class="p">.</span><span class="nx">end</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">errors</span><span class="p">.</span><span class="nx">E1002</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="updateheightvalues">
  <h3>
    <a href="#updateheightvalues" name="updateheightvalues" class="pilcrow">&#182;</a>
    <a name="updateHeightValues">updateHeightValues</a>
  </h3>
</div>


<p>invalidate and update all height values of the chunks and rows.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">updateHeightValues</span><span class="p">()</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-163" id="section-163">&#182;</a>
</div>
<p>TODO: this is going to be updated to use ChunkArray data to be faster.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="kd">var</span> <span class="nx">height</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">contentHeight</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">rowsLength</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">rowOffsets</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">height</span><span class="p">;</span>
            <span class="nx">height</span> <span class="o">+=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">.</span><span class="nx">getTemplateHeight</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
            <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">options</span><span class="p">.</span><span class="nx">rowHeight</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">rowsLength</span> <span class="o">?</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">.</span><span class="nx">getTemplateHeight</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">contentHeight</span> <span class="o">=</span> <span class="nx">getContentHeight</span><span class="p">();</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">getContent</span><span class="p">()[</span><span class="mi">0</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">contentHeight</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;heights: viewport %s content %s&quot;</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getViewportHeight</span><span class="p">(),</span> <span class="nx">contentHeight</span><span class="p">);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="updaterowwatchers">
  <h3>
    <a href="#updaterowwatchers" name="updaterowwatchers" class="pilcrow">&#182;</a>
    <a name="updateRowWatchers">updateRowWatchers</a>
  </h3>
</div>


<p>This is the core of the datagird rendering. It determines the range of scopes to be activated and
deactivates any scopes that were active before that are not still active.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">updateRowWatchers</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">loop</span> <span class="o">=</span> <span class="nx">getStartingIndex</span><span class="p">(),</span> <span class="nx">offset</span> <span class="o">=</span> <span class="nx">loop</span><span class="p">.</span><span class="nx">i</span> <span class="o">*</span> <span class="mi">40</span><span class="p">,</span> <span class="nx">lastActive</span> <span class="o">=</span> <span class="p">[].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">active</span><span class="p">),</span> <span class="nx">lastActiveIndex</span><span class="p">,</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">prevS</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">loop</span><span class="p">.</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-165" id="section-165">&#182;</a>
</div>
<p>then scroll is negative. ignore it.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_BEFORE_UPDATE_WATCHERS</span><span class="p">,</span> <span class="nx">loop</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-166" id="section-166">&#182;</a>
</div>
<p>we only want to update stuff if we are scrolling slow.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">resetMinMax</span><span class="p">();</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-167" id="section-167">&#182;</a>
</div>
<p>this needs to always be set after the dispatch of before update watchers in case they need the before activeRange.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">active</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-168" id="section-168">&#182;</a>
</div>
<p>make sure not to reset until after getStartingIndex.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;  scroll %s visibleScrollStart %s visibleScrollEnd %s&quot;</span><span class="p">,</span> <span class="nx">values</span><span class="p">.</span><span class="nx">scroll</span><span class="p">,</span> <span class="nx">loop</span><span class="p">.</span><span class="nx">visibleScrollStart</span><span class="p">,</span> <span class="nx">loop</span><span class="p">.</span><span class="nx">visibleScrollEnd</span><span class="p">);</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">loop</span><span class="p">.</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">rowsLength</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">prevS</span> <span class="o">=</span> <span class="nx">scope</span><span class="p">.</span><span class="nx">$$childHead</span> <span class="o">?</span> <span class="nx">scopes</span><span class="p">[</span><span class="nx">loop</span><span class="p">.</span><span class="nx">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span>
            <span class="nx">offset</span> <span class="o">=</span> <span class="nx">getRowOffset</span><span class="p">(</span><span class="nx">loop</span><span class="p">.</span><span class="nx">i</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-169" id="section-169">&#182;</a>
</div>
<p>this is where the chunks and rows get created is when they are requested if they don't exist.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">offset</span> <span class="o">&gt;=</span> <span class="nx">loop</span><span class="p">.</span><span class="nx">visibleScrollStart</span> <span class="o">&amp;&amp;</span> <span class="nx">offset</span> <span class="o">&lt;=</span> <span class="nx">loop</span><span class="p">.</span><span class="nx">visibleScrollEnd</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">s</span> <span class="o">=</span> <span class="nx">compileRow</span><span class="p">(</span><span class="nx">loop</span><span class="p">.</span><span class="nx">i</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-170" id="section-170">&#182;</a>
</div>
<p>only compiles if it is not already compiled. Still returns the scope.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="k">if</span> <span class="p">(</span><span class="nx">loop</span><span class="p">.</span><span class="nx">started</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">loop</span><span class="p">.</span><span class="nx">started</span> <span class="o">=</span> <span class="nx">loop</span><span class="p">.</span><span class="nx">i</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="nx">updateMinMax</span><span class="p">(</span><span class="nx">loop</span><span class="p">.</span><span class="nx">i</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">activateScope</span><span class="p">(</span><span class="nx">s</span><span class="p">))</span> <span class="p">{</span>
                    <span class="nx">inst</span><span class="p">.</span><span class="nx">getRowElm</span><span class="p">(</span><span class="nx">loop</span><span class="p">.</span><span class="nx">i</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="s2">&quot;active&quot;</span><span class="p">);</span>
                    <span class="nx">lastActiveIndex</span> <span class="o">=</span> <span class="nx">lastActive</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">loop</span><span class="p">.</span><span class="nx">i</span><span class="p">);</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">lastActiveIndex</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">lastActive</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">lastActiveIndex</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
                    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-171" id="section-171">&#182;</a>
</div>
<p>make sure to put them into active in the right order.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                    <span class="nx">active</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">loop</span><span class="p">.</span><span class="nx">i</span><span class="p">);</span>
                    <span class="nx">safeDigest</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span>
                    <span class="nx">s</span><span class="p">.</span><span class="nx">$digested</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="nx">loop</span><span class="p">.</span><span class="nx">i</span> <span class="o">+=</span> <span class="nx">loop</span><span class="p">.</span><span class="nx">inc</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-172" id="section-172">&#182;</a>
</div>
<p>optimize the loop</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">loop</span><span class="p">.</span><span class="nx">inc</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">offset</span> <span class="o">&gt;</span> <span class="nx">loop</span><span class="p">.</span><span class="nx">visibleScrollEnd</span> <span class="o">||</span> <span class="nx">loop</span><span class="p">.</span><span class="nx">inc</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">offset</span> <span class="o">&lt;</span> <span class="nx">loop</span><span class="p">.</span><span class="nx">visibleScrollStart</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="nx">loop</span><span class="p">.</span><span class="nx">ended</span> <span class="o">=</span> <span class="nx">loop</span><span class="p">.</span><span class="nx">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">rowsLength</span> <span class="o">&amp;&amp;</span> <span class="nx">values</span><span class="p">.</span><span class="nx">activeRange</span><span class="p">.</span><span class="nx">min</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">values</span><span class="p">.</span><span class="nx">activeRange</span><span class="p">.</span><span class="nx">max</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">errors</span><span class="p">.</span><span class="nx">E1002</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;  startIndex %s endIndex %s&quot;</span><span class="p">,</span> <span class="nx">loop</span><span class="p">.</span><span class="nx">startIndex</span><span class="p">,</span> <span class="nx">loop</span><span class="p">.</span><span class="nx">i</span><span class="p">);</span>
        <span class="nx">deactivateList</span><span class="p">(</span><span class="nx">lastActive</span><span class="p">);</span>
        <span class="nx">lastVisibleScrollStart</span> <span class="o">=</span> <span class="nx">loop</span><span class="p">.</span><span class="nx">visibleScrollStart</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;  activated %s&quot;</span><span class="p">,</span> <span class="nx">active</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">));</span>
        <span class="nx">updateLinks</span><span class="p">();</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-173" id="section-173">&#182;</a>
</div>
<p>update the $$childHead and $$nextSibling values to keep digest loops at a minimum count.
this dispatch needs to be after the digest so that it doesn't cause {} to show up in the render.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_AFTER_UPDATE_WATCHERS</span><span class="p">,</span> <span class="nx">loop</span><span class="p">);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="deactivatelist">
  <h3>
    <a href="#deactivatelist" name="deactivatelist" class="pilcrow">&#182;</a>
    <a name="deactivateList">deactivateList</a>
  </h3>
</div>


<p>Deactivate a list of scopes.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">deactivateList</span><span class="p">(</span><span class="nx">lastActive</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">lastActiveIndex</span><span class="p">,</span> <span class="nx">deactivated</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">lastActive</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">lastActiveIndex</span> <span class="o">=</span> <span class="nx">lastActive</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
            <span class="nx">deactivated</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">lastActiveIndex</span><span class="p">);</span>
            <span class="nx">deactivateScope</span><span class="p">(</span><span class="nx">scopes</span><span class="p">[</span><span class="nx">lastActiveIndex</span><span class="p">]);</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">getRowElm</span><span class="p">(</span><span class="nx">lastActiveIndex</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="s2">&quot;inactive&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;  deactivated %s&quot;</span><span class="p">,</span> <span class="nx">deactivated</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">));</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="updatelinks">
  <h3>
    <a href="#updatelinks" name="updatelinks" class="pilcrow">&#182;</a>
    <a name="updateLinks">updateLinks</a>
  </h3>
</div>


<p>Updates the $$childHead, $$childTail, $$nextSibling, and $$prevSibling values from the parent scope to completely
hide scopes that are deactivated from angular's knowledge so digest loops are as small as possible.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">updateLinks</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">active</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">lastIndex</span> <span class="o">=</span> <span class="nx">active</span><span class="p">[</span><span class="nx">active</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">active</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="nx">s</span><span class="p">;</span>
            <span class="nx">scope</span><span class="p">.</span><span class="nx">$$childHead</span> <span class="o">=</span> <span class="nx">scopes</span><span class="p">[</span><span class="nx">active</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span>
            <span class="nx">scope</span><span class="p">.</span><span class="nx">$$childTail</span> <span class="o">=</span> <span class="nx">scopes</span><span class="p">[</span><span class="nx">lastIndex</span><span class="p">];</span>
            <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">s</span> <span class="o">=</span> <span class="nx">scopes</span><span class="p">[</span><span class="nx">active</span><span class="p">[</span><span class="nx">i</span><span class="p">]];</span>
                <span class="nx">s</span><span class="p">.</span><span class="nx">$$prevSibling</span> <span class="o">=</span> <span class="nx">scopes</span><span class="p">[</span><span class="nx">active</span><span class="p">[</span><span class="nx">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]];</span>
                <span class="nx">s</span><span class="p">.</span><span class="nx">$$nextSibling</span> <span class="o">=</span> <span class="nx">scopes</span><span class="p">[</span><span class="nx">active</span><span class="p">[</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]];</span>
                <span class="nx">s</span><span class="p">.</span><span class="nx">$parent</span> <span class="o">=</span> <span class="nx">scope</span><span class="p">;</span>
                <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="resetminmax">
  <h3>
    <a href="#resetminmax" name="resetminmax" class="pilcrow">&#182;</a>
    <a name="resetMinMax">resetMinMax</a>
  </h3>
</div>


<p>resets the min and max of the activeRange for what is activated.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">resetMinMax</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">values</span><span class="p">.</span><span class="nx">activeRange</span><span class="p">.</span><span class="nx">min</span> <span class="o">=</span> <span class="nx">values</span><span class="p">.</span><span class="nx">activeRange</span><span class="p">.</span><span class="nx">max</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="updateminmax">
  <h3>
    <a href="#updateminmax" name="updateminmax" class="pilcrow">&#182;</a>
    <a name="updateMinMax">updateMinMax</a>
  </h3>
</div>


<p>takes an index that has just been activated and updates the min and max</p>
  </div>
  <div class="body">
  </div>
</div>

<p>values for later calculations to know the range.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">updateMinMax</span><span class="p">(</span><span class="nx">activeIndex</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">values</span><span class="p">.</span><span class="nx">activeRange</span><span class="p">.</span><span class="nx">min</span> <span class="o">=</span> <span class="nx">values</span><span class="p">.</span><span class="nx">activeRange</span><span class="p">.</span><span class="nx">min</span> <span class="o">&lt;</span> <span class="nx">activeIndex</span> <span class="o">&amp;&amp;</span> <span class="nx">values</span><span class="p">.</span><span class="nx">activeRange</span><span class="p">.</span><span class="nx">min</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">values</span><span class="p">.</span><span class="nx">activeRange</span><span class="p">.</span><span class="nx">min</span> <span class="o">:</span> <span class="nx">activeIndex</span><span class="p">;</span>
        <span class="nx">values</span><span class="p">.</span><span class="nx">activeRange</span><span class="p">.</span><span class="nx">max</span> <span class="o">=</span> <span class="nx">values</span><span class="p">.</span><span class="nx">activeRange</span><span class="p">.</span><span class="nx">max</span> <span class="o">&gt;</span> <span class="nx">activeIndex</span> <span class="o">&amp;&amp;</span> <span class="nx">values</span><span class="p">.</span><span class="nx">activeRange</span><span class="p">.</span><span class="nx">max</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">values</span><span class="p">.</span><span class="nx">activeRange</span><span class="p">.</span><span class="nx">max</span> <span class="o">:</span> <span class="nx">activeIndex</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="beforerenderafterdatachange">
  <h3>
    <a href="#beforerenderafterdatachange" name="beforerenderafterdatachange" class="pilcrow">&#182;</a>
    <a name="beforeRenderAfterDataChange">beforeRenderAfterDataChange</a>
  </h3>
</div>


<p>fired just before the update watchers are applied if the data has changed.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">beforeRenderAfterDataChange</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">values</span><span class="p">.</span><span class="nx">dirty</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">dispatch</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_BEFORE_RENDER_AFTER_DATA_CHANGE</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="afterrenderafterdatachange">
  <h3>
    <a href="#afterrenderafterdatachange" name="afterrenderafterdatachange" class="pilcrow">&#182;</a>
    <a name="afterRenderAfterDataChange">afterRenderAfterDataChange</a>
  </h3>
</div>


<p>after the data has changed this is fired after the following render.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">afterRenderAfterDataChange</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">tplHeight</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">values</span><span class="p">.</span><span class="nx">dirty</span> <span class="o">&amp;&amp;</span> <span class="nx">values</span><span class="p">.</span><span class="nx">activeRange</span><span class="p">.</span><span class="nx">max</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">values</span><span class="p">.</span><span class="nx">dirty</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
            <span class="nx">tplHeight</span> <span class="o">=</span> <span class="nx">getRowElm</span><span class="p">(</span><span class="nx">values</span><span class="p">.</span><span class="nx">activeRange</span><span class="p">.</span><span class="nx">min</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">offsetHeight</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">getData</span><span class="p">().</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">tplHeight</span> <span class="o">!==</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">.</span><span class="nx">getTemplateHeight</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">getData</span><span class="p">()[</span><span class="nx">values</span><span class="p">.</span><span class="nx">activeRange</span><span class="p">.</span><span class="nx">min</span><span class="p">]))</span> <span class="p">{</span>
                <span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">.</span><span class="nx">updateTemplateHeights</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="nx">dispatch</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_RENDER_AFTER_DATA_CHANGE</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="readytorender">
  <h3>
    <a href="#readytorender" name="readytorender" class="pilcrow">&#182;</a>
    <a name="readyToRender">readyToRender</a>
  </h3>
</div>


<p>the datagrid requires a height to be able to render. If the datagrid is compiled
and not added to the dom it will not have a height until added to the dom. If this fails it will wait till the next
frame to check the height. If that fails it exits.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">readyToRender</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">viewHeight</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">waitCount</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">waitCount</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">inst</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;datagrid is waiting for element to have a height.&quot;</span><span class="p">);</span>
                <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">updateViewportHeight</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-181" id="section-181">&#182;</a>
</div>
<p>have it wait a moment for the height to change.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">render</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">flow</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s2">&quot;Datagrid: Unable to determine a height for the datagrid. Cannot render. Exiting.&quot;</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">waitCount</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;datagrid has height of %s.&quot;</span><span class="p">,</span> <span class="nx">viewHeight</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="render">
  <h3>
    <a href="#render" name="render" class="pilcrow">&#182;</a>
    <a name="render">render</a>
  </h3>
</div>


<p>depending on the state of the datagrid this will create necessary dom, compile rows, or
digest <a href="#activeRange">activeRange</a> of rows.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;render&quot;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">readyToRender</span><span class="p">())</span> <span class="p">{</span>
            <span class="nx">waitCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;  render %s&quot;</span><span class="p">,</span> <span class="nx">state</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-183" id="section-183">&#182;</a>
</div>
<p>Where <a href="#states.BUILDING">states.BUILDING</a> is used</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">state</span> <span class="o">===</span> <span class="nx">states</span><span class="p">.</span><span class="nx">BUILDING</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">buildRows</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">state</span> <span class="o">===</span> <span class="nx">states</span><span class="p">.</span><span class="nx">READY</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">inst</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_BEFORE_RENDER</span><span class="p">);</span>
                <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">beforeRenderAfterDataChange</span><span class="p">);</span>
                <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">updateRowWatchers</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-184" id="section-184">&#182;</a>
</div>
<p>this wait allows rows to finish calculating their heights and finish the digest before firing.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">afterRenderAfterDataChange</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-185" id="section-185">&#182;</a>
</div>

<div class="highlight"><pre><code>           <span class="n">flow</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">destroyOldContent</span><span class="p">);</span>
</code></pre></div>


        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">,</span> <span class="p">[</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_AFTER_RENDER</span> <span class="p">]);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">errors</span><span class="p">.</span><span class="nx">E1001</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;  not ready to render.&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="update">
  <h3>
    <a href="#update" name="update" class="pilcrow">&#182;</a>
    <a name="update">update</a>
  </h3>
</div>


<p>force the datagrid to fire a data change update.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">update</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s2">&quot;force update&quot;</span><span class="p">);</span>
        <span class="nx">onDataChanged</span><span class="p">(</span><span class="nx">scope</span><span class="p">.</span><span class="nx">$eval</span><span class="p">(</span><span class="nx">attr</span><span class="p">.</span><span class="nx">uxDatagrid</span><span class="p">),</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="dirtycheckdata">
  <h3>
    <a href="#dirtycheckdata" name="dirtycheckdata" class="pilcrow">&#182;</a>
    <a name="dirtyCheckData">dirtyCheckData</a>
  </h3>
</div>


<p>Compare the new and the old value. If the item number is the same, and no templates
have changed. Than just update the scopes and run the watchers instead of doing a reset.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">newVal</span>
      <span class="dox_type">Array</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">oldVal
</span>
      <span class="dox_type">Array</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">dirtyCheckData</span><span class="p">(</span><span class="nx">newVal</span><span class="p">,</span> <span class="nx">oldVal</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-188" id="section-188">&#182;</a>
</div>
<p>TODO: this needs unit tested.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="nx">newVal</span> <span class="o">&amp;&amp;</span> <span class="nx">oldVal</span> <span class="o">&amp;&amp;</span> <span class="nx">newVal</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="nx">oldVal</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">newVal</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
            <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">dirtyCheckItemTemplate</span><span class="p">(</span><span class="nx">newVal</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">oldVal</span><span class="p">[</span><span class="nx">i</span><span class="p">]))</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span> <span class="o">!==</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">normalize</span><span class="p">(</span><span class="nx">newVal</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">grouped</span><span class="p">).</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;  dirtyCheckData length is different&quot;</span><span class="p">);</span>
                <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="dirtycheckitemtemplate">
  <h3>
    <a href="#dirtycheckitemtemplate" name="dirtycheckitemtemplate" class="pilcrow">&#182;</a>
    <a name="dirtyCheckItemTemplate">dirtyCheckItemTemplate</a>
  </h3>
</div>


<p>check to see if the template for the item has changed</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">newItem</span>
      <span class="dox_type">*</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">oldItem
</span>
      <span class="dox_type">*</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">dirtyCheckItemTemplate</span><span class="p">(</span><span class="nx">newItem</span><span class="p">,</span> <span class="nx">oldItem</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">.</span><span class="nx">getTemplate</span><span class="p">(</span><span class="nx">newItem</span><span class="p">)</span> <span class="o">!==</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">.</span><span class="nx">getTemplate</span><span class="p">(</span><span class="nx">oldItem</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;  dirtyCheckData row template changed&quot;</span><span class="p">);</span>
            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="mapdata">
  <h3>
    <a href="#mapdata" name="mapdata" class="pilcrow">&#182;</a>
    <a name="mapData">mapData</a>
  </h3>
</div>


<p>map the new data to the old data object and update the scopes.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">mapData</span><span class="p">(</span><span class="nx">newVal</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;  mapData()&quot;</span><span class="p">);</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="nx">newVal</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">grouped</span><span class="p">)</span> <span class="o">||</span> <span class="p">[];</span>
        <span class="nx">exports</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">getData</span><span class="p">(),</span> <span class="nx">updateScope</span><span class="p">);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="updatescope">
  <h3>
    <a href="#updatescope" name="updatescope" class="pilcrow">&#182;</a>
    <a name="updateScope">updateScope</a>
  </h3>
</div>


<p>update the scope at that index with the new item.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">updateScope</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">tpl</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">scopes</span><span class="p">[</span><span class="nx">index</span><span class="p">])</span> <span class="p">{</span>
            <span class="nx">tpl</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">.</span><span class="nx">getTemplate</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
            <span class="nx">scopes</span><span class="p">[</span><span class="nx">index</span><span class="p">][</span><span class="nx">tpl</span><span class="p">.</span><span class="nx">item</span><span class="p">]</span> <span class="o">=</span> <span class="nx">item</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="ondatachanged">
  <h3>
    <a href="#ondatachanged" name="ondatachanged" class="pilcrow">&#182;</a>
    <a name="onDataChanged">onDataChanged</a>
  </h3>
</div>


<p>when the data changes. It is compared by reference, not value for speed
(this is the default angular setting).</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">onDataChanged</span><span class="p">(</span><span class="nx">newVal</span><span class="p">,</span> <span class="nx">oldVal</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;onDataChanged&quot;</span><span class="p">);</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">grouped</span> <span class="o">=</span> <span class="nx">scope</span><span class="p">.</span><span class="nx">$eval</span><span class="p">(</span><span class="nx">attr</span><span class="p">.</span><span class="nx">grouped</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">oldVal</span> <span class="o">!==</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getOriginalData</span><span class="p">())</span> <span class="p">{</span>
            <span class="nx">oldVal</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getOriginalData</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">smartUpdate</span> <span class="o">||</span> <span class="o">!</span><span class="nx">inst</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span> <span class="o">||</span> <span class="nx">dirtyCheckData</span><span class="p">(</span><span class="nx">newVal</span><span class="p">,</span> <span class="nx">oldVal</span><span class="p">))</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">evt</span> <span class="o">=</span> <span class="nx">dispatch</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_BEFORE_DATA_CHANGE</span><span class="p">,</span> <span class="nx">newVal</span><span class="p">,</span> <span class="nx">oldVal</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">defaultPrevented</span> <span class="o">&amp;&amp;</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">newValue</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">newVal</span> <span class="o">=</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">newValue</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">values</span><span class="p">.</span><span class="nx">dirty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">changeData</span><span class="p">,</span> <span class="p">[</span> <span class="nx">newVal</span><span class="p">,</span> <span class="nx">oldVal</span> <span class="p">]);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-193" id="section-193">&#182;</a>
</div>
<p>we just want to update the data values and scope values, because no tempaltes changed.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">values</span><span class="p">.</span><span class="nx">dirty</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="nx">mapData</span><span class="p">(</span><span class="nx">newVal</span><span class="p">);</span>
            <span class="nx">render</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">changeData</span><span class="p">(</span><span class="nx">newVal</span><span class="p">,</span> <span class="nx">oldVal</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;  changeData&quot;</span><span class="p">);</span>
        <span class="nx">dispatch</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_BEFORE_RESET</span><span class="p">);</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="nx">newVal</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">grouped</span><span class="p">)</span> <span class="o">||</span> <span class="p">[];</span>
        <span class="nx">dispatch</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_AFTER_DATA_CHANGE</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="nx">oldVal</span><span class="p">);</span>
        <span class="nx">reset</span><span class="p">();</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="reset">
  <h3>
    <a href="#reset" name="reset" class="pilcrow">&#182;</a>
    <a name="reset">reset</a>
  </h3>
</div>


<p>clear all and rebuild.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">reset</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;reset start&quot;</span><span class="p">);</span>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-195" id="section-195">&#182;</a>
</div>
<p>we are going to clear all in the flow before doing a reset.
       state = states.BUILDING;</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">destroyScopes</span><span class="p">();</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-196" id="section-196">&#182;</a>
</div>
<p>now destroy all of the dom.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">rowOffsets</span> <span class="o">=</span> <span class="p">{};</span>
        <span class="nx">active</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">scopes</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-197" id="section-197">&#182;</a>
</div>
<p>keep reference to the old content and add a class to it so we can tell it is old. We will remove it after the render.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">content</span><span class="p">.</span><span class="nx">children</span><span class="p">().</span><span class="nx">unbind</span><span class="p">();</span>
        <span class="nx">content</span><span class="p">.</span><span class="nx">children</span><span class="p">().</span><span class="nx">remove</span><span class="p">();</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-198" id="section-198">&#182;</a>
</div>
<p>make sure scopes are destroyed before this level and listeners as well or this will create a memory leak.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">chunkModel</span><span class="p">.</span><span class="nx">getChunkList</span><span class="p">())</span> <span class="p">{</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">chunkModel</span><span class="p">.</span><span class="nx">reset</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="nx">content</span><span class="p">,</span> <span class="nx">scopes</span><span class="p">);</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">rowsLength</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
            <span class="nx">updateHeights</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">buildRows</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">info</span><span class="p">,</span> <span class="p">[</span> <span class="s2">&quot;reset complete&quot;</span> <span class="p">]);</span>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">dispatch</span><span class="p">,</span> <span class="p">[</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_AFTER_RESET</span> <span class="p">],</span> <span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="forcerenderscope">
  <h3>
    <a href="#forcerenderscope" name="forcerenderscope" class="pilcrow">&#182;</a>
    <a name="forceRenderScope">forceRenderScope</a>
  </h3>
</div>


<p>used to force a row to render and digest that may not be within
the <a href="#values.activeRange">activeRange</a></p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">index
</span>
      <span class="dox_type">Number</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">forceRenderScope</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">scopes</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-200" id="section-200">&#182;</a>
</div>

<div class="highlight"><pre><code>   <span class="n">inst</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">forceRenderScope %s&quot;</span><span class="p">,</span> <span class="n">index</span><span class="p">);</span>
</code></pre></div>


        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">s</span> <span class="o">&amp;&amp;</span> <span class="nx">index</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">index</span> <span class="o">&lt;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">rowsLength</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">s</span> <span class="o">=</span> <span class="nx">compileRow</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">s</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">scope</span><span class="p">.</span><span class="nx">$$phase</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">activateScope</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span>
            <span class="nx">s</span><span class="p">.</span><span class="nx">$digest</span><span class="p">();</span>
            <span class="nx">deactivateScope</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span>
            <span class="nx">s</span><span class="p">.</span><span class="nx">$digested</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="onrowtemplatechange">
  <h3>
    <a href="#onrowtemplatechange" name="onrowtemplatechange" class="pilcrow">&#182;</a>
    <a name="onRowTemplateChange">onRowTemplateChange</a>
  </h3>
</div>


<p>when changing the template for an individual row.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">evt</span>
      <span class="dox_type">Event</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">{*)item</span>
      <span class="dox_type">*)item</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">oldTemplate</span>
      <span class="dox_type">Object</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">newTemplate</span>
      <span class="dox_type">Object</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">classes
</span>
      <span class="dox_type">Array</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">onRowTemplateChange</span><span class="p">(</span><span class="nx">evt</span><span class="p">,</span> <span class="nx">item</span><span class="p">,</span> <span class="nx">oldTemplate</span><span class="p">,</span> <span class="nx">newTemplate</span><span class="p">,</span> <span class="nx">classes</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getNormalizedIndex</span><span class="p">(</span><span class="nx">item</span><span class="p">),</span> <span class="nx">el</span> <span class="o">=</span> <span class="nx">getRowElm</span><span class="p">(</span><span class="nx">index</span><span class="p">),</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">uncompiledClass</span><span class="p">)</span> <span class="o">?</span> <span class="nx">compileRow</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="o">:</span> <span class="nx">el</span><span class="p">.</span><span class="nx">scope</span><span class="p">(),</span> <span class="nx">replaceEl</span><span class="p">,</span> <span class="nx">newScope</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">s</span> <span class="o">!==</span> <span class="nx">scope</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">replaceEl</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">element</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">.</span><span class="nx">getTemplateByName</span><span class="p">(</span><span class="nx">newTemplate</span><span class="p">).</span><span class="nx">template</span><span class="p">);</span>
            <span class="nx">replaceEl</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">uncompiledClass</span><span class="p">);</span>
            <span class="k">while</span> <span class="p">(</span><span class="nx">classes</span> <span class="o">&amp;&amp;</span> <span class="nx">classes</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">replaceEl</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">classes</span><span class="p">.</span><span class="nx">shift</span><span class="p">());</span>
            <span class="p">}</span>
            <span class="nx">el</span><span class="p">.</span><span class="nx">parent</span><span class="p">()[</span><span class="mi">0</span><span class="p">].</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">replaceEl</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">el</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
            <span class="nx">s</span><span class="p">.</span><span class="nx">$destroy</span><span class="p">();</span>
            <span class="nx">el</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
            <span class="nx">scopes</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="nx">updateHeights</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="updateheights">
  <h3>
    <a href="#updateheights" name="updateheights" class="pilcrow">&#182;</a>
    <a name="updateHeights">updateHeights</a>
  </h3>
</div>


<p>force invalidation of heights and recalculate them then render.
If a rowIndex is specified, only update ones affected by that row, otherwise update all.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">rowIndex
</span>
      <span class="dox_type">Number=</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">updateHeights</span><span class="p">(</span><span class="nx">rowIndex</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">updateViewportHeight</span><span class="p">);</span>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">chunkModel</span><span class="p">.</span><span class="nx">updateAllChunkHeights</span><span class="p">,</span> <span class="p">[</span> <span class="nx">rowIndex</span> <span class="p">]);</span>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">updateHeightValues</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">updateViewportHeight</span><span class="p">);</span>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">maxScrollHeight</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getContentHeight</span><span class="p">()</span> <span class="o">-</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getViewportHeight</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">values</span><span class="p">.</span><span class="nx">scroll</span> <span class="o">&gt;</span> <span class="nx">maxScrollHeight</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">values</span><span class="p">.</span><span class="nx">scroll</span> <span class="o">=</span> <span class="nx">maxScrollHeight</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">});</span>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">,</span> <span class="p">[</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_AFTER_HEIGHTS_UPDATED</span> <span class="p">]);</span>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">render</span><span class="p">);</span>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">,</span> <span class="p">[</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_AFTER_HEIGHTS_UPDATED_RENDER</span> <span class="p">]);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="islogevent">
  <h3>
    <a href="#islogevent" name="islogevent" class="pilcrow">&#182;</a>
    <a name="isLogEvent">isLogEvent</a>
  </h3>
</div>


<p>used to compare events to detect log events.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">evt</span>
      <span class="dox_type">String</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">isLogEvent</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">logEvents</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="dispatch">
  <h3>
    <a href="#dispatch" name="dispatch" class="pilcrow">&#182;</a>
    <a name="dispatch">dispatch</a>
  </h3>
</div>


<p>handle dispaching of events from the datagrid.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">event</span>
      <span class="dox_type">String</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">dispatch</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isLogEvent</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">options</span><span class="p">.</span><span class="nx">debug</span><span class="p">)</span> <span class="nx">eventLogger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;$emit %s&quot;</span><span class="p">,</span> <span class="nx">event</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-205" id="section-205">&#182;</a>
</div>
<p>THIS SHOULD ONLY EMIT. Broadcast could perform very poorly especially if there are a lot of rows.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">return</span> <span class="nx">scope</span><span class="p">.</span><span class="nx">$emit</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">forceGarbageCollection</span><span class="p">()</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-206" id="section-206">&#182;</a>
</div>
<p>concept is to crate a large object that will cause the browser to garbage collect before creating it.
then since it has no reference it gets removed.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">gcIntv</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">inst</span><span class="p">.</span><span class="nx">shuttingDown</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">gcIntv</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">inst</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;GC&quot;</span><span class="p">);</span>
                    <span class="kd">var</span> <span class="nx">a</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">total</span> <span class="o">=</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="p">.</span><span class="mi">5</span><span class="p">;</span>
                    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">total</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">a</span> <span class="o">=</span> <span class="p">.</span><span class="mi">5</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">},</span> <span class="mi">1</span><span class="nx">e3</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="destroyscopes">
  <h3>
    <a href="#destroyscopes" name="destroyscopes" class="pilcrow">&#182;</a>
    <a name="destroyScopes">destroyScopes</a>
  </h3>
</div>


<p>used to destroy the scopes of all rows in the datagrid that are compiled.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">destroyScopes</span><span class="p">()</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-208" id="section-208">&#182;</a>
</div>
<p>because child scopes may not be in order because of rendering techniques. We must loop through
all scopes and destroy them manually.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="kd">var</span> <span class="nx">lastScope</span><span class="p">,</span> <span class="nx">nextScope</span><span class="p">,</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">each</span><span class="p">(</span><span class="nx">scopes</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-209" id="section-209">&#182;</a>
</div>
<p>listeners should be destroyed with the angular destroy.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">s</span><span class="p">.</span><span class="nx">$$prevSibling</span> <span class="o">=</span> <span class="nx">lastScope</span> <span class="o">||</span> <span class="kc">undefined</span><span class="p">;</span>
                <span class="nx">i</span> <span class="o">=</span> <span class="nx">index</span><span class="p">;</span>
                <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="nx">nextScope</span> <span class="o">&amp;&amp;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">rowsLength</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
                    <span class="nx">nextScope</span> <span class="o">=</span> <span class="nx">scopes</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">||</span> <span class="kc">undefined</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="nx">activateScope</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span>
                <span class="nx">lastScope</span> <span class="o">=</span> <span class="nx">s</span><span class="p">;</span>
                <span class="nx">s</span><span class="p">.</span><span class="nx">$destroy</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">});</span>
        <span class="nx">scope</span><span class="p">.</span><span class="nx">$$childHead</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
        <span class="nx">scope</span><span class="p">.</span><span class="nx">$$childTail</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
        <span class="nx">scopes</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="destroy">
  <h3>
    <a href="#destroy" name="destroy" class="pilcrow">&#182;</a>
    <a name="destroy">destroy</a>
  </h3>
</div>


<p>needs to put all watcher back before destroying or it will not destroy child scopes, or remove watchers.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">destroy</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">shuttingDown</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="nx">getContent</span><span class="p">()[</span><span class="mi">0</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">;</span>
        <span class="nx">scope</span><span class="p">.</span><span class="nx">datagrid</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-211" id="section-211">&#182;</a>
</div>
<p>we have a circular reference. break it on destroy.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;destroying grid&quot;</span><span class="p">);</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s2">&quot;resize&quot;</span><span class="p">,</span> <span class="nx">onResize</span><span class="p">);</span>
        <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">values</span><span class="p">.</span><span class="nx">scrollingStopIntv</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-212" id="section-212">&#182;</a>
</div>
<p>destroy flow.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">flow</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">flow</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
        <span class="nx">flow</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-213" id="section-213">&#182;</a>
</div>
<p>destroy watchers.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">while</span> <span class="p">(</span><span class="nx">unwatchers</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">unwatchers</span><span class="p">.</span><span class="nx">pop</span><span class="p">()();</span>
        <span class="p">}</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">destroyLogger</span><span class="p">();</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-214" id="section-214">&#182;</a>
</div>
<p>now remove every property on exports.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="k">in</span> <span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">inst</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s2">&quot;destroy&quot;</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">inst</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">destroy</span><span class="p">();</span>
                <span class="nx">inst</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-215" id="section-215">&#182;</a>
</div>
<p>activate scopes so they can be destroyed by angular.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">destroyScopes</span><span class="p">();</span>
        <span class="nx">element</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-216" id="section-216">&#182;</a>
</div>
<p>this seems to be the most memory efficient way to remove elements.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">delete</span> <span class="nx">scope</span><span class="p">.</span><span class="nx">$parent</span><span class="p">[</span><span class="nx">inst</span><span class="p">.</span><span class="nx">name</span><span class="p">];</span>
        <span class="nx">rowOffsets</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">inst</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">scope</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">element</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">attr</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">unwatchers</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">content</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">active</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">active</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">scopes</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">scopes</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">values</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">states</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">events</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">options</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">values</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">logEvents</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">$compile</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">exports</span><span class="p">.</span><span class="nx">logWrapper</span><span class="p">(</span><span class="s2">&quot;datagrid&quot;</span><span class="p">,</span> <span class="nx">inst</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="nx">dispatch</span><span class="p">);</span>
    <span class="nx">exports</span><span class="p">.</span><span class="nx">logWrapper</span><span class="p">(</span><span class="s2">&quot;events&quot;</span><span class="p">,</span> <span class="nx">eventLogger</span><span class="p">,</span> <span class="s2">&quot;light&quot;</span><span class="p">,</span> <span class="nx">dispatch</span><span class="p">);</span>
    <span class="nx">scope</span><span class="p">.</span><span class="nx">datagrid</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">;</span>
    <span class="nx">setupExports</span><span class="p">();</span>
    <span class="k">return</span> <span class="nx">inst</span><span class="p">;</span>
<span class="p">}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="uxdatagrid">
  <h3>
    <a href="#uxdatagrid" name="uxdatagrid" class="pilcrow">&#182;</a>
    <a name="uxDatagrid">uxDatagrid</a>
  </h3>
</div>


<p>define the directive, setup addons, apply core addons then optional addons.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">module</span><span class="p">.</span><span class="nx">directive</span><span class="p">(</span><span class="s2">&quot;uxDatagrid&quot;</span><span class="p">,</span> <span class="p">[</span> <span class="s2">&quot;$compile&quot;</span><span class="p">,</span> <span class="s2">&quot;gridAddons&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$compile</span><span class="p">,</span> <span class="nx">gridAddons</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="nx">restrict</span><span class="o">:</span> <span class="s2">&quot;AE&quot;</span><span class="p">,</span>
        <span class="nx">scope</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">link</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">pre</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">attr</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">inst</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Datagrid</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">attr</span><span class="p">,</span> <span class="nx">$compile</span><span class="p">);</span>
                <span class="nx">each</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">coreAddons</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">method</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">method</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="p">[</span> <span class="nx">inst</span> <span class="p">]);</span>
                <span class="p">});</span>
                <span class="nx">gridAddons</span><span class="p">(</span><span class="nx">inst</span><span class="p">,</span> <span class="nx">attr</span><span class="p">.</span><span class="nx">addons</span><span class="p">);</span>
            <span class="p">},</span>
            <span class="nx">post</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">attr</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">scope</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">};</span>
<span class="p">}</span> <span class="p">]);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="chunkmodel">
  <h3>
    <a href="#chunkmodel" name="chunkmodel" class="pilcrow">&#182;</a>
    chunkModel
  </h3>
</div>


<p>Because the browser has low performance on dom elements that exist in high numbers and are all
siblings chunking is used to break them up into limits of their number and their parents and so on.
So think of it as every chunk not having more than X number of children weather those children be
chunks or they be rows.</p>
  </div>
  <div class="body"><p>This speeds up the browser significantly because a resize event from a dom element will not affect
all of them, but just those direct siblings and then it's parents siblings and so on up the chain.</p>
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">inst</span>
      <span class="dox_type">Datagrid</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">coreAddons</span><span class="p">.</span><span class="nx">chunkModel</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">chunkModel</span><span class="p">(</span><span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">_list</span><span class="p">,</span> <span class="nx">_rows</span><span class="p">,</span> <span class="nx">_chunkSize</span><span class="p">,</span> <span class="nx">_el</span><span class="p">,</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">logWrapper</span><span class="p">(</span><span class="s2">&quot;chunkModel&quot;</span><span class="p">,</span> <span class="p">{},</span> <span class="s2">&quot;purple&quot;</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">),</span> <span class="nx">_templateStartCache</span><span class="p">,</span> <span class="nx">_templateEndCache</span><span class="p">,</span> <span class="nx">_cachedDomRows</span> <span class="o">=</span> <span class="p">[];</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-219" id="section-219">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p><strong>getChunkList</strong>
Return the list that was created.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getChunkList</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">_list</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-220" id="section-220">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>Create a ChunkArray from the array of data that is passed.
The array that is passed should not be multi-dimensional. This will only work with a single
dimensional array.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">list</span>
      <span class="dox_type">Array</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">size</span>
      <span class="dox_type">Number</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">templateStart</span>
      <span class="dox_type">String</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">templateEnd</span>
      <span class="dox_type">String</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">chunkList</span><span class="p">(</span><span class="nx">list</span><span class="p">,</span> <span class="nx">size</span><span class="p">,</span> <span class="nx">templateStart</span><span class="p">,</span> <span class="nx">templateEnd</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ChunkArray</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">chunks</span><span class="p">.</span><span class="nx">detachDom</span><span class="p">),</span> <span class="nx">childAry</span><span class="p">,</span> <span class="nx">item</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">item</span> <span class="o">=</span> <span class="nx">list</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">%</span> <span class="nx">size</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">childAry</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">childAry</span><span class="p">.</span><span class="nx">updateHeight</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">,</span> <span class="nx">_rows</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="nx">childAry</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ChunkArray</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">chunks</span><span class="p">.</span><span class="nx">detachDom</span><span class="p">);</span>
                <span class="nx">childAry</span><span class="p">.</span><span class="nx">min</span> <span class="o">=</span> <span class="nx">item</span><span class="p">.</span><span class="nx">min</span> <span class="o">||</span> <span class="nx">i</span><span class="p">;</span>
                <span class="nx">childAry</span><span class="p">.</span><span class="nx">templateModel</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">;</span>
                <span class="nx">childAry</span><span class="p">.</span><span class="nx">templateStart</span> <span class="o">=</span> <span class="nx">templateStart</span><span class="p">;</span>
                <span class="nx">childAry</span><span class="p">.</span><span class="nx">templateEnd</span> <span class="o">=</span> <span class="nx">templateEnd</span><span class="p">;</span>
                <span class="nx">childAry</span><span class="p">.</span><span class="nx">parent</span> <span class="o">=</span> <span class="nx">result</span><span class="p">;</span>
                <span class="nx">childAry</span><span class="p">.</span><span class="nx">index</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
                <span class="nx">result</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">childAry</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">item</span> <span class="k">instanceof</span> <span class="nx">ChunkArray</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">item</span><span class="p">.</span><span class="nx">parent</span> <span class="o">=</span> <span class="nx">childAry</span><span class="p">;</span>
                <span class="nx">item</span><span class="p">.</span><span class="nx">index</span> <span class="o">=</span> <span class="nx">childAry</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">childAry</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
            <span class="nx">childAry</span><span class="p">.</span><span class="nx">max</span> <span class="o">=</span> <span class="nx">item</span><span class="p">.</span><span class="nx">max</span> <span class="o">||</span> <span class="nx">i</span><span class="p">;</span>
            <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">childAry</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">childAry</span><span class="p">.</span><span class="nx">updateHeight</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">,</span> <span class="nx">_rows</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">result</span><span class="p">.</span><span class="nx">min</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">result</span><span class="p">.</span><span class="nx">min</span> <span class="o">=</span> <span class="nx">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">?</span> <span class="nx">result</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">min</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
            <span class="nx">result</span><span class="p">.</span><span class="nx">max</span> <span class="o">=</span> <span class="nx">result</span><span class="p">[</span><span class="nx">result</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">?</span> <span class="nx">result</span><span class="p">[</span><span class="nx">result</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="nx">max</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
            <span class="nx">result</span><span class="p">.</span><span class="nx">templateStart</span> <span class="o">=</span> <span class="nx">templateStart</span><span class="p">;</span>
            <span class="nx">result</span><span class="p">.</span><span class="nx">templateEnd</span> <span class="o">=</span> <span class="nx">templateEnd</span><span class="p">;</span>
            <span class="nx">result</span><span class="p">.</span><span class="nx">updateHeight</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">,</span> <span class="nx">_rows</span><span class="p">);</span>
            <span class="nx">result</span><span class="p">.</span><span class="nx">dirtyHeight</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">result</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="nx">size</span> <span class="o">?</span> <span class="nx">chunkList</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="nx">size</span><span class="p">,</span> <span class="nx">templateStart</span><span class="p">,</span> <span class="nx">templateEnd</span><span class="p">)</span> <span class="o">:</span> <span class="nx">result</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="updateallchunkheights">
  <h3>
    <a href="#updateallchunkheights" name="updateallchunkheights" class="pilcrow">&#182;</a>
    <a name="updateAllChunkHeights">updateAllChunkHeights</a>
  </h3>
</div>


<p>Update rows affected by this particular index change. if rowIndex is undefined, update all.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">rowIndex
</span>
      <span class="dox_type">Number=</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">updateAllChunkHeights</span><span class="p">(</span><span class="nx">rowIndex</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">indexes</span><span class="p">,</span> <span class="nx">ary</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">rowIndex</span> <span class="o">===</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">chunks</span><span class="p">.</span><span class="nx">detachDom</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-222" id="section-222">&#182;</a>
</div>
<p>TODO: unit test needed.
detach dom must enter here, because it is absolute positioned so it will not push down
the other chunks automatically like relative positioning will.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="nx">_list</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">_list</span><span class="p">.</span><span class="nx">forceHeightReCalc</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">,</span> <span class="nx">_rows</span><span class="p">);</span>
                <span class="nx">_list</span><span class="p">.</span><span class="nx">updateHeight</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">,</span> <span class="nx">_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">_list</span><span class="p">.</span><span class="nx">detachDom</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">_list</span><span class="p">.</span><span class="nx">updateDomHeight</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">indexes</span> <span class="o">=</span> <span class="nx">getRowIndexes</span><span class="p">(</span><span class="nx">rowIndex</span><span class="p">,</span> <span class="nx">_list</span><span class="p">);</span>
            <span class="nx">ary</span> <span class="o">=</span> <span class="nx">getArrayFromIndexes</span><span class="p">(</span><span class="nx">indexes</span><span class="p">,</span> <span class="nx">_list</span><span class="p">);</span>
            <span class="nx">ary</span><span class="p">.</span><span class="nx">updateHeight</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">,</span> <span class="nx">_rows</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="getarrayfromindexes">
  <h3>
    <a href="#getarrayfromindexes" name="getarrayfromindexes" class="pilcrow">&#182;</a>
    <a name="getArrayFromIndexes">getArrayFromIndexes</a>
  </h3>
</div>


<p>Look up the chunkArray given an indexes array.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">indexes</span>
      <span class="dox_type">Array</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">ary</span>
      <span class="dox_type">ChunkArray</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getArrayFromIndexes</span><span class="p">(</span><span class="nx">indexes</span><span class="p">,</span> <span class="nx">ary</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">index</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">indexes</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">index</span> <span class="o">=</span> <span class="nx">indexes</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">ary</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="k">instanceof</span> <span class="nx">ChunkArray</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">ary</span> <span class="o">=</span> <span class="nx">ary</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">ary</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-224" id="section-224">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>Create the chunkList so that it is ready for dom. Set properties needed to create the dom.
The dom gets created when the rows are accessed.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">list</span>
      <span class="dox_type">Array</span>
      <span>// single dimensional array only.</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">size</span>
      <span class="dox_type">Number</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">templateStart</span>
      <span class="dox_type">String</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">templateEnd</span>
      <span class="dox_type">String</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">el</span>
      <span class="dox_type">DomElement</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">chunkDom</span><span class="p">(</span><span class="nx">list</span><span class="p">,</span> <span class="nx">size</span><span class="p">,</span> <span class="nx">templateStart</span><span class="p">,</span> <span class="nx">templateEnd</span><span class="p">,</span> <span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;chunkDom&quot;</span><span class="p">);</span>
        <span class="nx">_el</span> <span class="o">=</span> <span class="nx">el</span><span class="p">;</span>
        <span class="nx">_chunkSize</span> <span class="o">=</span> <span class="nx">size</span><span class="p">;</span>
        <span class="nx">_rows</span> <span class="o">=</span> <span class="nx">list</span><span class="p">;</span>
        <span class="nx">_templateStartCache</span> <span class="o">=</span> <span class="nx">templateStart</span><span class="p">;</span>
        <span class="nx">_templateEndCache</span> <span class="o">=</span> <span class="nx">templateEnd</span><span class="p">;</span>
        <span class="nx">_list</span> <span class="o">=</span> <span class="nx">chunkList</span><span class="p">(</span><span class="nx">list</span><span class="p">,</span> <span class="nx">size</span><span class="p">,</span> <span class="nx">templateStart</span><span class="p">,</span> <span class="nx">templateEnd</span><span class="p">);</span>
        <span class="nx">updateDom</span><span class="p">(</span><span class="nx">_list</span><span class="p">);</span>
        <span class="nx">_list</span><span class="p">.</span><span class="nx">updateDomHeight</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">el</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-225" id="section-225">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>Generate an array of indexes that point to that row.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">rowIndex</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">chunkList</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">indexes</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getRowIndexes</span><span class="p">(</span><span class="nx">rowIndex</span><span class="p">,</span> <span class="nx">chunkList</span><span class="p">,</span> <span class="nx">indexes</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">chunkList</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="nx">chunk</span><span class="p">;</span>
        <span class="nx">indexes</span> <span class="o">=</span> <span class="nx">indexes</span> <span class="o">||</span> <span class="p">[];</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">chunk</span> <span class="o">=</span> <span class="nx">chunkList</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">chunk</span> <span class="k">instanceof</span> <span class="nx">ChunkArray</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">rowIndex</span> <span class="o">&gt;=</span> <span class="nx">chunk</span><span class="p">.</span><span class="nx">min</span> <span class="o">&amp;&amp;</span> <span class="nx">rowIndex</span> <span class="o">&lt;=</span> <span class="nx">chunk</span><span class="p">.</span><span class="nx">max</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">indexes</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
                    <span class="nx">getRowIndexes</span><span class="p">(</span><span class="nx">rowIndex</span><span class="p">,</span> <span class="nx">chunk</span><span class="p">,</span> <span class="nx">indexes</span><span class="p">);</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-226" id="section-226">&#182;</a>
</div>
<p>we are at the end. So we just need the last index.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">indexes</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">rowIndex</span> <span class="o">%</span> <span class="nx">_chunkSize</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">indexes</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-227" id="section-227">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>Get the dom row element.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">rowIndex</span>
      <span>{Number}</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getRow</span><span class="p">(</span><span class="nx">rowIndex</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">indexes</span> <span class="o">=</span> <span class="nx">getRowIndexes</span><span class="p">(</span><span class="nx">rowIndex</span><span class="p">,</span> <span class="nx">_list</span><span class="p">),</span> <span class="nx">el</span> <span class="o">=</span> <span class="nx">buildDomByIndexes</span><span class="p">(</span><span class="nx">indexes</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">el</span> <span class="o">&amp;&amp;</span> <span class="nx">el</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;row-id&quot;</span><span class="p">)</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;row-id&quot;</span><span class="p">,</span> <span class="nx">rowIndex</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">el</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="getitembyindexes">
  <h3>
    <a href="#getitembyindexes" name="getitembyindexes" class="pilcrow">&#182;</a>
    <a name="getItemByIndexes">getItemByIndexes</a>
  </h3>
</div>


<p>Get the chunk or item given the indexes.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">indexes</span>
      <span class="dox_type">Array</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getItemByIndexes</span><span class="p">(</span><span class="nx">indexes</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">indxs</span> <span class="o">=</span> <span class="nx">indexes</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="nx">ca</span> <span class="o">=</span> <span class="nx">_list</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">indxs</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">ca</span> <span class="o">=</span> <span class="nx">ca</span><span class="p">[</span><span class="nx">indxs</span><span class="p">.</span><span class="nx">shift</span><span class="p">()];</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">ca</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="getdomrowbyindexes">
  <h3>
    <a href="#getdomrowbyindexes" name="getdomrowbyindexes" class="pilcrow">&#182;</a>
    <a name="getDomRowByIndexes">getDomRowByIndexes</a>
  </h3>
</div>


<p>Get the dom element given the indexes array. This cannot be exposed because public api should use the
buildDomByIndexes that is called from getRow.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">indexes</span>
      <span class="dox_type">Array</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">unrendered</span>
      <span class="dox_type">Function</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">getDomRowByIndexes</span><span class="p">(</span><span class="nx">indexes</span><span class="p">,</span> <span class="nx">unrendered</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">indxs</span> <span class="o">=</span> <span class="nx">indexes</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="nx">ca</span> <span class="o">=</span> <span class="nx">_list</span><span class="p">,</span> <span class="nx">el</span> <span class="o">=</span> <span class="nx">_el</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">indxs</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">index</span> <span class="o">=</span> <span class="nx">indxs</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">ca</span><span class="p">.</span><span class="nx">rendered</span> <span class="o">&amp;&amp;</span> <span class="nx">unrendered</span> <span class="o">||</span> <span class="nx">shouldRecompileDecompiledRows</span><span class="p">(</span><span class="nx">ca</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">unrendered</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">ca</span><span class="p">);</span>
                <span class="nx">updateDom</span><span class="p">(</span><span class="nx">ca</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">indxs</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">checkAllCompiled</span><span class="p">(</span><span class="nx">ca</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="nx">ca</span> <span class="o">=</span> <span class="nx">ca</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>
            <span class="nx">el</span> <span class="o">=</span> <span class="nx">ca</span><span class="p">.</span><span class="nx">rendered</span> <span class="o">||</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">element</span><span class="p">(</span><span class="nx">el</span><span class="p">.</span><span class="nx">children</span><span class="p">()[</span><span class="nx">index</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">el</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">shouldRecompileDecompiledRows</span><span class="p">(</span><span class="nx">ca</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">recompile</span> <span class="o">=</span> <span class="o">!</span><span class="nx">ca</span><span class="p">.</span><span class="nx">hasChildChunks</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">ca</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">ca</span><span class="p">.</span><span class="nx">rendered</span> <span class="o">&amp;&amp;</span> <span class="nx">ca</span><span class="p">.</span><span class="nx">rendered</span><span class="p">.</span><span class="nx">children</span><span class="p">().</span><span class="nx">length</span> <span class="o">!==</span> <span class="nx">ca</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">recompile</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">result</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;recompile chunk %s&quot;</span><span class="p">,</span> <span class="nx">ca</span><span class="p">.</span><span class="nx">getId</span><span class="p">());</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">recompile</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="unrendered">
  <h3>
    <a href="#unrendered" name="unrendered" class="pilcrow">&#182;</a>
    <a name="unrendered">unrendered</a>
  </h3>
</div>


<p>How to handle array chunks that have not been rendered yet. They may copy from cache or even create new
dom from html strings.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">el</span>
      <span class="dox_type">JQLite</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">ca
</span>
      <span class="dox_type">ChunkArray</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">unrendered</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">ca</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">children</span><span class="p">,</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">iLen</span><span class="p">;</span>
        <span class="nx">el</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">ca</span><span class="p">.</span><span class="nx">getChildrenStr</span><span class="p">());</span>
        <span class="nx">children</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">children</span><span class="p">();</span>
        <span class="nx">ca</span><span class="p">.</span><span class="nx">rendered</span> <span class="o">=</span> <span class="nx">el</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">ca</span><span class="p">.</span><span class="nx">hasChildChunks</span><span class="p">())</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-231" id="section-231">&#182;</a>
</div>
<p>assign the dom element.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">iLen</span> <span class="o">=</span> <span class="nx">children</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
            <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">iLen</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">ca</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">dom</span> <span class="o">=</span> <span class="nx">children</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
                <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">ca</span><span class="p">.</span><span class="nx">detachDom</span> <span class="o">&amp;&amp;</span> <span class="nx">ca</span><span class="p">.</span><span class="nx">dirtyHeight</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">ca</span><span class="p">.</span><span class="nx">updateDomHeight</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="nx">exports</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">children</span><span class="p">,</span> <span class="nx">computeStyles</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">ca</span><span class="p">.</span><span class="nx">hasChildChunks</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">children</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">className</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">chunks</span><span class="p">.</span><span class="nx">chunkClass</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-232" id="section-232">&#182;</a>
</div>
<p>need to calculate css styles before adding this class to make transitions work.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">children</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">chunks</span><span class="p">.</span><span class="nx">chunkReadyClass</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">ca</span><span class="p">.</span><span class="nx">rendered</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">chunks</span><span class="p">.</span><span class="nx">chunkReadyClass</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">ca</span><span class="p">.</span><span class="nx">rendered</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">chunks</span><span class="p">.</span><span class="nx">chunkReadyClass</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-233" id="section-233">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>Get the domElement by indexes, create the dom if it doesn't exist.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">indexes</span>
      <span class="dox_type">Array</span>
      <span><ul>
<li>an array of int values.</li>
</ul></span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">buildDomByIndexes</span><span class="p">(</span><span class="nx">indexes</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">getDomRowByIndexes</span><span class="p">(</span><span class="nx">indexes</span><span class="p">,</span> <span class="nx">unrendered</span><span class="p">);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="computedstyles">
  <h2>
    <a href="#computedstyles" name="computedstyles" class="pilcrow">&#182;</a>
    <a name="computedStyles">computedStyles</a>
  </h2>
</div>


<p>calculate the computed styles of each element</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">computeStyles</span><span class="p">(</span><span class="nx">elm</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">elm</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">style</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">getComputedStyle</span><span class="p">(</span><span class="nx">elm</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">style</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">style</span><span class="p">.</span><span class="nx">getPropertyValue</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="checkallcompiled">
  <h2>
    <a href="#checkallcompiled" name="checkallcompiled" class="pilcrow">&#182;</a>
    <a name="checkAllCompiled">checkAllCompiled</a>
  </h2>
</div>


<p>Each ChunkArray keeps track of weather or not it's dom has been compiled. Since each
ChunkArray generates the values and updates properties of the dom. The dom chunks are a
reflection of the ChunkArrays.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">ca</span>
      <span class="dox_type">ChunkArray</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">checkAllCompiled</span><span class="p">(</span><span class="nx">ca</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">ca</span><span class="p">.</span><span class="nx">compiled</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">ca</span><span class="p">.</span><span class="nx">compiled</span> <span class="o">=</span> <span class="nx">isCompiled</span><span class="p">(</span><span class="nx">ca</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">ca</span><span class="p">.</span><span class="nx">compiled</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">ca</span><span class="p">.</span><span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-236" id="section-236">&#182;</a>
</div>
<p>a parent cannot be compiled till it's last child is done. So don't check until
a chunk child compiles.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                    <span class="nx">checkAllCompiled</span><span class="p">(</span><span class="nx">ca</span><span class="p">.</span><span class="nx">parent</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="nx">inst</span><span class="p">.</span><span class="nx">flow</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">disableNonVisibleChunks</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">ca</span><span class="p">.</span><span class="nx">compiled</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="iscompiled">
  <h2>
    <a href="#iscompiled" name="iscompiled" class="pilcrow">&#182;</a>
    <a name="isCompiled">isCompiled</a>
  </h2>
</div>


<p>Validate that the chunk is compiled.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">ca</span>
      <span class="dox_type">ChunkArray</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">isCompiled</span><span class="p">(</span><span class="nx">ca</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">min</span><span class="p">,</span> <span class="nx">max</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">ca</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">instanceof</span> <span class="nx">ChunkArray</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">min</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="nx">max</span> <span class="o">=</span> <span class="nx">ca</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
            <span class="k">while</span> <span class="p">(</span><span class="nx">min</span> <span class="o">&lt;</span> <span class="nx">max</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">ca</span><span class="p">[</span><span class="nx">min</span><span class="p">].</span><span class="nx">compiled</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="nx">min</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">min</span> <span class="o">=</span> <span class="nx">ca</span><span class="p">.</span><span class="nx">min</span><span class="p">;</span>
        <span class="nx">max</span> <span class="o">=</span> <span class="nx">ca</span><span class="p">.</span><span class="nx">max</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">min</span> <span class="o">&lt;</span> <span class="nx">max</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">inst</span><span class="p">.</span><span class="nx">isCompiled</span><span class="p">(</span><span class="nx">min</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">min</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">updateDom</span><span class="p">(</span><span class="nx">ca</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">ca</span><span class="p">.</span><span class="nx">updateDom</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">chunks</span><span class="p">.</span><span class="nx">chunkDisabledClass</span><span class="p">);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="reset">
  <h3>
    <a href="#reset" name="reset" class="pilcrow">&#182;</a>
    <a name="reset">reset</a>
  </h3>
</div>


<p>Remove all dom, and all other references.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">newList</span>
      <span class="dox_type">Array=</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">content</span>
      <span class="dox_type">JQLite=</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">scopes
</span>
      <span class="dox_type">Array=</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">reset</span><span class="p">(</span><span class="nx">newList</span><span class="p">,</span> <span class="nx">content</span><span class="p">,</span> <span class="nx">scopes</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;reset&quot;</span><span class="p">);</span>
        <span class="nx">_cachedDomRows</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">newList</span> <span class="o">=</span> <span class="nx">newList</span> <span class="o">||</span> <span class="p">[];</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-239" id="section-239">&#182;</a>
</div>
<p>TODO: this needs to make sure it destroys things properly</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="nx">_list</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">_list</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
            <span class="nx">_list</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="nx">_el</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="nx">_rows</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">chunkDom</span><span class="p">(</span><span class="nx">newList</span><span class="p">,</span> <span class="nx">_chunkSize</span><span class="p">,</span> <span class="nx">_templateStartCache</span><span class="p">,</span> <span class="nx">_templateEndCache</span><span class="p">,</span> <span class="nx">content</span><span class="p">);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="disablenonvisiblechunks">
  <h2>
    <a href="#disablenonvisiblechunks" name="disablenonvisiblechunks" class="pilcrow">&#182;</a>
    <a name="disableNonVislbieChunks">disableNonVisibleChunks</a>
  </h2>
</div>


<p>disable all chunks that are outside of the values.activeRange.min/max.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">disableNonVisibleChunks</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">r</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">activeRange</span><span class="p">,</span> <span class="nx">o</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">chunks</span><span class="p">;</span>
        <span class="nx">_list</span><span class="p">.</span><span class="nx">enableRange</span><span class="p">(</span><span class="nx">r</span><span class="p">.</span><span class="nx">min</span><span class="p">,</span> <span class="nx">r</span><span class="p">.</span><span class="nx">max</span><span class="p">,</span> <span class="nx">o</span><span class="p">.</span><span class="nx">chunkDisabledClass</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">detachDom</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-241" id="section-241">&#182;</a>
</div>
<p>we need to update which chunks are compiled.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">updateDom</span><span class="p">(</span><span class="nx">_list</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="destroy">
  <h3>
    <a href="#destroy" name="destroy" class="pilcrow">&#182;</a>
    <a name="destroy">destroy</a>
  </h3>
</div>


<p>Clean up the chunking and recycling.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">destroy</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">reset</span><span class="p">();</span>
        <span class="nx">_list</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">_rows</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">_chunkSize</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">_el</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">_templateStartCache</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">_templateEndCache</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">_cachedDomRows</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">_cachedDomRows</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">chunkModel</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">destroyLogger</span><span class="p">();</span>
        <span class="nx">result</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">inst</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">flow</span><span class="p">.</span><span class="nx">unique</span><span class="p">(</span><span class="nx">updateDom</span><span class="p">);</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">chunkDom</span> <span class="o">=</span> <span class="nx">chunkDom</span><span class="p">;</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">getChunkList</span> <span class="o">=</span> <span class="nx">getChunkList</span><span class="p">;</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">getRowIndexes</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">rowIndex</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">getRowIndexes</span><span class="p">(</span><span class="nx">rowIndex</span><span class="p">,</span> <span class="nx">_list</span><span class="p">);</span>
    <span class="p">};</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">getItemByIndexes</span> <span class="o">=</span> <span class="nx">getItemByIndexes</span><span class="p">;</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">getRow</span> <span class="o">=</span> <span class="nx">getRow</span><span class="p">;</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">reset</span> <span class="o">=</span> <span class="nx">reset</span><span class="p">;</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">updateAllChunkHeights</span> <span class="o">=</span> <span class="nx">updateAllChunkHeights</span><span class="p">;</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">destroy</span> <span class="o">=</span> <span class="nx">destroy</span><span class="p">;</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_AFTER_UPDATE_WATCHERS</span><span class="p">,</span> <span class="nx">disableNonVisibleChunks</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-243" id="section-243">&#182;</a>
</div>
<p>apply event dispatching.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">dispatcher</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">chunkModel</span> <span class="o">=</span> <span class="nx">result</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">coreAddons</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">coreAddons</span><span class="p">.</span><span class="nx">chunkModel</span><span class="p">);</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="chunkarray">
  <h4>
    <a href="#chunkarray" name="chunkarray" class="pilcrow">&#182;</a>
    ChunkArray
  </h4>
</div>


<p>is an array with additional properties needed by the chunkModel to generate and access chunks
of the dom with high performance.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="kd">function</span> <span class="nx">ChunkArray</span><span class="p">(</span><span class="nx">detachDom</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">uid</span> <span class="o">=</span> <span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">uid</span><span class="o">++</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">enabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">min</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">max</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">templateStart</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">templateStartWithPos</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">templateEnd</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">parent</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">mode</span> <span class="o">=</span> <span class="nx">detachDom</span> <span class="o">?</span> <span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">DETACHED</span> <span class="o">:</span> <span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">ATTACHED</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">detachDom</span> <span class="o">=</span> <span class="nx">detachDom</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">uid</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">DETACHED</span> <span class="o">=</span> <span class="s2">&quot;chunkArray:detached&quot;</span><span class="p">;</span>

<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">ATTACHED</span> <span class="o">=</span> <span class="s2">&quot;chunkArray:attached&quot;</span><span class="p">;</span>

<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="p">[];</span>

<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getStub</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">getStub</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">templateStartWithPos</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">createDomTemplates</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">templateStartWithPos</span> <span class="o">+</span> <span class="nx">str</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">templateEnd</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">inRange</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">value</span> <span class="o">&gt;=</span> <span class="k">this</span><span class="p">.</span><span class="nx">min</span> <span class="o">&amp;&amp;</span> <span class="nx">value</span> <span class="o">&lt;=</span> <span class="k">this</span><span class="p">.</span><span class="nx">max</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">rangeOverlap</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">min</span><span class="p">,</span> <span class="nx">max</span><span class="p">,</span> <span class="nx">cushion</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">overlap</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="nx">cushion</span> <span class="o">=</span> <span class="nx">cushion</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">cushion</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">min</span> <span class="o">-=</span> <span class="nx">cushion</span><span class="p">;</span>
    <span class="nx">max</span> <span class="o">+=</span> <span class="nx">cushion</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">min</span> <span class="o">&lt;</span> <span class="nx">max</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">inRange</span><span class="p">(</span><span class="nx">min</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">overlap</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">min</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">overlap</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">each</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">method</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">args</span><span class="p">);</span>
        <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="chunkarray.prototype.getchildstr">
  <h5>
    <a href="#chunkarray.prototype.getchildstr" name="chunkarray.prototype.getchildstr" class="pilcrow">&#182;</a>
    ChunkArray.prototype.getChildStr
  </h5>
</div>


<p>Get the HTML string representation of the children in this array.
If deep then return this and all children down.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">deep</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getChildrenStr</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">deep</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="nx">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nx">ca</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">ca</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="k">instanceof</span> <span class="nx">ChunkArray</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">str</span> <span class="o">+=</span> <span class="nx">ca</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">getStub</span><span class="p">(</span><span class="nx">deep</span> <span class="o">?</span> <span class="nx">ca</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">getChildrenStr</span><span class="p">(</span><span class="nx">deep</span><span class="p">)</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">str</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">.</span><span class="nx">getTemplate</span><span class="p">(</span><span class="nx">ca</span><span class="p">[</span><span class="nx">i</span><span class="p">]).</span><span class="nx">template</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">str</span><span class="p">;</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="updateheight">
  <h5>
    <a href="#updateheight" name="updateheight" class="pilcrow">&#182;</a>
    <a name="updateHeight">updateHeight</a>
  </h5>
</div>


<p>Recalculate the height of this chunk.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">templateModel</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">_rows
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">updateHeight</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">templateModel</span><span class="p">,</span> <span class="nx">_rows</span><span class="p">,</span> <span class="nx">recurse</span><span class="p">,</span> <span class="nx">updateDomHeight</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span><span class="p">,</span> <span class="nx">height</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">instanceof</span> <span class="nx">ChunkArray</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">len</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">recurse</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">updateHeight</span><span class="p">(</span><span class="nx">templateModel</span><span class="p">,</span> <span class="nx">_rows</span><span class="p">,</span> <span class="nx">recurse</span><span class="p">,</span> <span class="nx">updateDomHeight</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="nx">height</span> <span class="o">+=</span> <span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">height</span><span class="p">;</span>
            <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">height</span> <span class="o">=</span> <span class="nx">templateModel</span><span class="p">.</span><span class="nx">getHeight</span><span class="p">(</span><span class="nx">_rows</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">min</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">max</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">height</span> <span class="o">!==</span> <span class="nx">height</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">dirtyHeight</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">height</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">recurse</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">dirtyHeight</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">updateHeight</span><span class="p">(</span><span class="nx">templateModel</span><span class="p">,</span> <span class="nx">_rows</span><span class="p">,</span> <span class="nx">recurse</span><span class="p">,</span> <span class="nx">updateDomHeight</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">updateDomHeight</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">dirtyHeight</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">updateDomHeight</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getPreviousSibling</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">prevSibling</span><span class="p">,</span> <span class="nx">prevIndex</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">prevIndex</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
        <span class="nx">prevSibling</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">[</span><span class="nx">prevIndex</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">prevSibling</span> <span class="o">||</span> <span class="nx">prevSibling</span><span class="p">.</span><span class="nx">index</span> <span class="o">!==</span> <span class="k">this</span><span class="p">.</span><span class="nx">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-247" id="section-247">&#182;</a>
</div>
<p>we must the first in the array. so we have to jump up higher. Or we are the first item in the first chunk.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">prevSibling</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">getPreviousSibling</span><span class="p">();</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">prevSibling</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">prevSibling</span> <span class="o">=</span> <span class="nx">prevSibling</span><span class="p">.</span><span class="nx">last</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">prevSibling</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getNextSibling</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">nextSibling</span><span class="p">,</span> <span class="nx">nextIndex</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">nextIndex</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
        <span class="nx">nextSibling</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">[</span><span class="nx">nextIndex</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">nextSibling</span> <span class="o">||</span> <span class="nx">nextSibling</span><span class="p">.</span><span class="nx">index</span> <span class="o">!==</span> <span class="k">this</span><span class="p">.</span><span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-248" id="section-248">&#182;</a>
</div>
<p>we must be at the end of the array. So we need to jump up higher. Or we could be at the very end.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">nextSibling</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">getNextSibling</span><span class="p">();</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">nextSibling</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">nextSibling</span> <span class="o">=</span> <span class="nx">nextSibling</span><span class="p">.</span><span class="nx">first</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">nextSibling</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">first</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">last</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="calculatetop">
  <h5>
    <a href="#calculatetop" name="calculatetop" class="pilcrow">&#182;</a>
    <a name="calculateTop">calculateTop</a>
  </h5>
</div>


<p>Calculate the top value relative to it's parent.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">calculateTop</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">top</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">prevSibling</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">index</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">prevSibling</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getPreviousSibling</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">prevSibling</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">top</span> <span class="o">=</span> <span class="nx">prevSibling</span><span class="p">.</span><span class="nx">top</span> <span class="o">+</span> <span class="nx">prevSibling</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="nx">top</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">top</span><span class="p">;</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="forceheightrecal">
  <h5>
    <a href="#forceheightrecal" name="forceheightrecal" class="pilcrow">&#182;</a>
    <a name="forceHeightReCalc">forceHeightReCal</a>
  </h5>
</div>


<p>Ignore any cached values and update the height of this chunk.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">templateModel</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">_rows</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">forceHeightReCalc</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">templateModel</span><span class="p">,</span> <span class="nx">_rows</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span><span class="p">,</span> <span class="nx">height</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">instanceof</span> <span class="nx">ChunkArray</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">len</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">height</span> <span class="o">+=</span> <span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">forceHeightReCalc</span><span class="p">(</span><span class="nx">templateModel</span><span class="p">,</span> <span class="nx">_rows</span><span class="p">);</span>
            <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">height</span> <span class="o">=</span> <span class="nx">templateModel</span><span class="p">.</span><span class="nx">getHeight</span><span class="p">(</span><span class="nx">_rows</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">min</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">max</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">height</span> <span class="o">!==</span> <span class="nx">height</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">height</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">detachDom</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-251" id="section-251">&#182;</a>
</div>
<p>we need to update all siblings if we change.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">this</span><span class="p">.</span><span class="nx">dirtySiblings</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">setDirtyHeight</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="setdirtyheight">
  <h5>
    <a href="#setdirtyheight" name="setdirtyheight" class="pilcrow">&#182;</a>
    <a name="setDirtyHeight">setDirtyHeight</a>
  </h5>
</div>


<p>Set this chunk as dirty so heights need calculated.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setDirtyHeight</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">p</span><span class="p">.</span><span class="nx">dirtyHeight</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">parent</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">dirtySiblings</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">dirtyHeight</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">iLen</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">iLen</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">dirtyHeight</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">dirtySiblings</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="getid">
  <h5>
    <a href="#getid" name="getid" class="pilcrow">&#182;</a>
    <a name="getId">getId</a>
  </h5>
</div>

  </div>
  <div class="body">
  </div>
  <div class="details">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getId</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_index</span> <span class="o">!==</span> <span class="k">this</span><span class="p">.</span><span class="nx">index</span> <span class="o">||</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_id</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span> <span class="nx">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_index</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">index</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-254" id="section-254">&#182;</a>
</div>
<p>keep the last index so if it changes. We change the id.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">while</span> <span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">s</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="nx">p</span><span class="p">.</span><span class="nx">index</span> <span class="o">+</span> <span class="nx">s</span><span class="p">;</span>
            <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">parent</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_id</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">s</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_id</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">hasChildChunks</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_hasChildChunks</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_hasChildChunks</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">first</span><span class="p">()</span> <span class="k">instanceof</span> <span class="nx">ChunkArray</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_hasChildChunks</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">enableRange</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">min</span><span class="p">,</span> <span class="nx">max</span><span class="p">,</span> <span class="nx">disabledClass</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rangeOverlap</span><span class="p">(</span><span class="nx">min</span><span class="p">,</span> <span class="nx">max</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">detachDom</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">enable</span><span class="p">(</span><span class="nx">disabledClass</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">disable</span><span class="p">(</span><span class="nx">disabledClass</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hasChildChunks</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">enableRange</span><span class="p">,</span> <span class="p">[</span> <span class="nx">min</span><span class="p">,</span> <span class="nx">max</span><span class="p">,</span> <span class="nx">disabledClass</span> <span class="p">]);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">enable</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">disabledClass</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">enabled</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">enabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">updateDom</span><span class="p">(</span><span class="nx">disabledClass</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">enable</span><span class="p">(</span><span class="nx">disabledClass</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">disable</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">disabledClass</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">compiled</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hasChildChunks</span><span class="p">())</span> <span class="p">{</span>
            <span class="nx">len</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
            <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">disable</span><span class="p">(</span><span class="nx">disabledClass</span><span class="p">);</span>
                <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">enabled</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">enabled</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">updateDom</span><span class="p">(</span><span class="nx">disabledClass</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">updateDom</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">disabledClass</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rendered</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">compiled</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">rendered</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;compiled&quot;</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">rendered</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;compiled&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">detachDom</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">enabled</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">detached</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">detached</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">rendered</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rendered</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">enabled</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">detached</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">parent</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">compiled</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">rendered</span><span class="p">.</span><span class="nx">parent</span><span class="p">().</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">detached</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-255" id="section-255">&#182;</a>
</div>
<p>jquery detach is just 2nd param pass true to keep data around.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
                    <span class="k">this</span><span class="p">.</span><span class="nx">rendered</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="kc">undefined</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">rendered</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;enabled&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">enabled</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">enabled</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">rendered</span><span class="p">.</span><span class="nx">removeAttr</span><span class="p">(</span><span class="s2">&quot;disabled&quot;</span><span class="p">);</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">rendered</span><span class="p">.</span><span class="nx">removeAttr</span><span class="p">(</span><span class="s2">&quot;read-only&quot;</span><span class="p">);</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">rendered</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="nx">disabledClass</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">rendered</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;disabled&quot;</span><span class="p">,</span> <span class="s2">&quot;disabled&quot;</span><span class="p">);</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">rendered</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;read-only&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">rendered</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">disabledClass</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">updateDom</span><span class="p">,</span> <span class="p">[</span> <span class="nx">disabledClass</span> <span class="p">]);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">updateDomHeight</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">recursiveDirection</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">dom</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">rendered</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">rendered</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">dom</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">dom</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">dirtyHeight</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">mode</span> <span class="o">===</span> <span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">DETACHED</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">calculateTop</span><span class="p">();</span>
            <span class="nx">dom</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">top</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">dom</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">height</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">createDomTemplates</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">recursiveDirection</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">updateDomHeight</span><span class="p">(</span><span class="nx">recursiveDirection</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">recursiveDirection</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">hasChildChunks</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">updateDomHeight</span><span class="p">,</span> <span class="p">[</span> <span class="nx">recursiveDirection</span> <span class="p">]);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">createDomTemplates</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">templateReady</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">templateStart</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">templateStart</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; style=&quot;&#39;</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">mode</span> <span class="o">===</span> <span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">DETACHED</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">calculateTop</span><span class="p">();</span>
            <span class="nx">str</span> <span class="o">+=</span> <span class="s2">&quot;position:absolute;top:&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">top</span> <span class="o">+</span> <span class="s2">&quot;px;left:0px;&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">templateStartWithPos</span> <span class="o">=</span> <span class="nx">str</span> <span class="o">+</span> <span class="s2">&quot;width:100%;height:&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">height</span> <span class="o">+</span> <span class="s1">&#39;px;&quot; chunk-id=&quot;&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">getId</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;&quot; range=&quot;&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">min</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">max</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&#39;</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">templateReady</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-256" id="section-256">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>Return an array of the children created from the rendered properties of the children.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">children</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">children</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">children</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rendered</span><span class="p">);</span>
    <span class="p">},</span> <span class="p">[]);</span>
<span class="p">};</span>

<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">decompile</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">chunkReadyClass</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hasChildChunks</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="s2">&quot;decompile&quot;</span><span class="p">,</span> <span class="p">[</span> <span class="nx">chunkReadyClass</span> <span class="p">]);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-257" id="section-257">&#182;</a>
</div>
<p>we are going to remove all dom rows to free up memory.
this can only be done if the chunk has no rows for children instead of chunks.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rendered</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">rendered</span><span class="p">.</span><span class="nx">children</span><span class="p">().</span><span class="nx">remove</span><span class="p">();</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">rendered</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="nx">chunkReadyClass</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="destroy">
  <h5>
    <a href="#destroy" name="destroy" class="pilcrow">&#182;</a>
    <a name="destroy">destroy</a>
  </h5>
</div>


<p>Perform proper cleanup.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">ChunkArray</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">destroy</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">hasChildChunks</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">destroy</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">templateStart</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">templateEnd</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">templateModel</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">rendered</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">dom</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">parent</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_RENDER_PROGRESS</span> <span class="o">=</span> <span class="s2">&quot;datagrid:onRenderProgress&quot;</span><span class="p">;</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">STOP_CREEP</span> <span class="o">=</span> <span class="s2">&quot;datagrid:stopCreep&quot;</span><span class="p">;</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ENABLE_CREEP</span> <span class="o">=</span> <span class="s2">&quot;datagrid:enableCreep&quot;</span><span class="p">;</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">DISABLE_CREEP</span> <span class="o">=</span> <span class="s2">&quot;datagrid:disableCreep&quot;</span><span class="p">;</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">coreAddons</span><span class="p">.</span><span class="nx">creepRenderModel</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">creepRenderModel</span><span class="p">(</span><span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">intv</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">creepCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">model</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">logWrapper</span><span class="p">(</span><span class="s2">&quot;creepModel&quot;</span><span class="p">,</span> <span class="p">{},</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">),</span> <span class="nx">upIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">downIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">waitHandle</span><span class="p">,</span> <span class="nx">waitingOnReset</span><span class="p">,</span> <span class="nx">time</span><span class="p">,</span> <span class="nx">lastPercent</span><span class="p">,</span> <span class="nx">unwatchers</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">function</span> <span class="nx">digest</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getScope</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">s</span> <span class="o">||</span> <span class="o">!</span><span class="nx">s</span><span class="p">.</span><span class="nx">$digested</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-259" id="section-259">&#182;</a>
</div>
<p>just skip if already digested.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">forceRenderScope</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">calculatePercent</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">count</span><span class="o">:</span> <span class="mi">0</span>
        <span class="p">};</span>
        <span class="nx">each</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">scopes</span><span class="p">,</span> <span class="nx">calculateScopePercent</span><span class="p">,</span> <span class="nx">result</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">count</span> <span class="o">&gt;=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">rowsLength</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">model</span><span class="p">.</span><span class="nx">disable</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="nx">count</span><span class="o">:</span> <span class="nx">result</span><span class="p">.</span><span class="nx">count</span><span class="p">,</span>
            <span class="nx">len</span><span class="o">:</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">rowsLength</span>
        <span class="p">};</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">calculateScopePercent</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">,</span> <span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">count</span> <span class="o">+=</span> <span class="nx">s</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">onInterval</span><span class="p">(</span><span class="nx">started</span><span class="p">,</span> <span class="nx">ended</span><span class="p">,</span> <span class="nx">force</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">touchDown</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">waitingOnReset</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
            <span class="nx">time</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">+</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">renderThreshold</span><span class="p">;</span>
            <span class="nx">upIndex</span> <span class="o">=</span> <span class="nx">started</span><span class="p">;</span>
            <span class="nx">downIndex</span> <span class="o">=</span> <span class="nx">ended</span><span class="p">;</span>
            <span class="nx">render</span><span class="p">(</span><span class="nx">onComplete</span><span class="p">,</span> <span class="nx">force</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">wait</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">time</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">array</span><span class="p">.</span><span class="nx">toArray</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);</span>
        <span class="nx">args</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">async</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">waitHandle</span><span class="p">);</span>
            <span class="nx">waitHandle</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">method</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
            <span class="p">},</span> <span class="nx">time</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">method</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">waitHandle</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">findUncompiledIndex</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">dir</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">index</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">index</span> <span class="o">&lt;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">rowsLength</span> <span class="o">&amp;&amp;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">isCompiled</span><span class="p">(</span><span class="nx">index</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">index</span> <span class="o">+=</span> <span class="nx">dir</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">index</span> <span class="o">&lt;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">rowsLength</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">index</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">dir</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">rowsLength</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">render</span><span class="p">(</span><span class="nx">complete</span><span class="p">,</span> <span class="nx">force</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">now</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">time</span> <span class="o">&gt;</span> <span class="nx">now</span> <span class="o">&amp;&amp;</span> <span class="nx">hasIndexesLeft</span><span class="p">())</span> <span class="p">{</span>
            <span class="nx">upIndex</span> <span class="o">=</span> <span class="nx">force</span> <span class="o">?</span> <span class="nx">upIndex</span> <span class="o">:</span> <span class="nx">findUncompiledIndex</span><span class="p">(</span><span class="nx">upIndex</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">upIndex</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">digest</span><span class="p">(</span><span class="nx">upIndex</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">force</span><span class="p">)</span> <span class="nx">upIndex</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">downIndex</span> <span class="o">=</span> <span class="nx">force</span> <span class="o">?</span> <span class="nx">downIndex</span> <span class="o">:</span> <span class="nx">findUncompiledIndex</span><span class="p">(</span><span class="nx">downIndex</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">downIndex</span> <span class="o">!==</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">rowsLength</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">digest</span><span class="p">(</span><span class="nx">downIndex</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">force</span><span class="p">)</span> <span class="nx">downIndex</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">render</span><span class="p">(</span><span class="nx">complete</span><span class="p">,</span> <span class="nx">force</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">complete</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">onComplete</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">stop</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">hasIndexesLeft</span><span class="p">())</span> <span class="p">{</span>
            <span class="nx">creepCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="nx">model</span><span class="p">.</span><span class="nx">disable</span><span class="p">();</span>
            <span class="nx">lastPercent</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_RENDER_PROGRESS</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">creepCount</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">touchDown</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">speed</span> <span class="o">&amp;&amp;</span> <span class="nx">hasIndexesLeft</span><span class="p">())</span> <span class="p">{</span>
                <span class="nx">resetInterval</span><span class="p">(</span><span class="nx">upIndex</span><span class="p">,</span> <span class="nx">downIndex</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="kd">var</span> <span class="nx">percent</span> <span class="o">=</span> <span class="nx">calculatePercent</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">percent</span> <span class="o">!==</span> <span class="nx">lastPercent</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">inst</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_RENDER_PROGRESS</span><span class="p">,</span> <span class="nx">percent</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">hasIndexesLeft</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">!!</span><span class="p">(</span><span class="nx">upIndex</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="o">||</span> <span class="nx">downIndex</span> <span class="o">&lt;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">rowsLength</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">stop</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">time</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">intv</span><span class="p">);</span>
        <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">waitHandle</span><span class="p">);</span>
        <span class="nx">intv</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">resetInterval</span><span class="p">(</span><span class="nx">started</span><span class="p">,</span> <span class="nx">ended</span><span class="p">,</span> <span class="nx">waitTime</span><span class="p">,</span> <span class="nx">forceCompileRowRender</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">stop</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">creepCount</span> <span class="o">&lt;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">creepLimit</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">intv</span> <span class="o">=</span> <span class="nx">wait</span><span class="p">(</span><span class="nx">onInterval</span><span class="p">,</span> <span class="nx">waitTime</span> <span class="o">||</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">renderThresholdWait</span><span class="p">,</span> <span class="nx">started</span><span class="p">,</span> <span class="nx">ended</span><span class="p">,</span> <span class="nx">forceCompileRowRender</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">renderLater</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">forceCompileRowRender</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">resetInterval</span><span class="p">(</span><span class="nx">upIndex</span><span class="p">,</span> <span class="nx">downIndex</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">creepStartDelay</span><span class="p">,</span> <span class="nx">forceCompileRowRender</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">onBeforeRender</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">stop</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">onAfterRender</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">loopData</span><span class="p">,</span> <span class="nx">forceCompileRowRender</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">creepCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">upIndex</span> <span class="o">=</span> <span class="nx">loopData</span><span class="p">.</span><span class="nx">started</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">downIndex</span> <span class="o">=</span> <span class="nx">loopData</span><span class="p">.</span><span class="nx">ended</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">renderLater</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">forceCompileRowRender</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">onBeforeReset</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">onBeforeRender</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">creepRender</span> <span class="o">&amp;&amp;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">creepRender</span><span class="p">.</span><span class="nx">enable</span> <span class="o">!==</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">model</span><span class="p">.</span><span class="nx">enable</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">model</span><span class="p">.</span><span class="nx">stop</span> <span class="o">=</span> <span class="nx">stop</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-260" id="section-260">&#182;</a>
</div>
<p>allow external stop of creep render.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">model</span><span class="p">.</span><span class="nx">destroy</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">destroy</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">model</span><span class="p">.</span><span class="nx">disable</span><span class="p">();</span>
        <span class="nx">stop</span><span class="p">();</span>
        <span class="nx">inst</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">model</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">};</span>
    <span class="nx">model</span><span class="p">.</span><span class="nx">enable</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">unwatchers</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">unwatchers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">BEFORE_VIRTUAL_SCROLL_START</span><span class="p">,</span> <span class="nx">onBeforeRender</span><span class="p">));</span>
            <span class="nx">unwatchers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_VIRTUAL_SCROLL_UPDATE</span><span class="p">,</span> <span class="nx">onBeforeRender</span><span class="p">));</span>
            <span class="nx">unwatchers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_TOUCH_DOWN</span><span class="p">,</span> <span class="nx">onBeforeRender</span><span class="p">));</span>
            <span class="nx">unwatchers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_SCROLL_START</span><span class="p">,</span> <span class="nx">onBeforeRender</span><span class="p">));</span>
            <span class="nx">unwatchers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_AFTER_UPDATE_WATCHERS</span><span class="p">,</span> <span class="nx">onAfterRender</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="nx">model</span><span class="p">.</span><span class="nx">disable</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">stop</span><span class="p">();</span>
        <span class="nx">model</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;creep Disabled&quot;</span><span class="p">);</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">unwatchers</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">unwatchers</span><span class="p">.</span><span class="nx">pop</span><span class="p">()();</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">unwatchers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">DISABLE_CREEP</span><span class="p">,</span> <span class="nx">model</span><span class="p">.</span><span class="nx">disable</span><span class="p">));</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">unwatchers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_BEFORE_RESET</span><span class="p">,</span> <span class="nx">onBeforeReset</span><span class="p">));</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">unwatchers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">STOP_CREEP</span><span class="p">,</span> <span class="nx">stop</span><span class="p">));</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">creepRenderModel</span> <span class="o">=</span> <span class="nx">model</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-261" id="section-261">&#182;</a>
</div>
<p>do not add listeners if it is not enabled.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">creepRender</span> <span class="o">&amp;&amp;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">creepRender</span><span class="p">.</span><span class="nx">enable</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">model</span><span class="p">.</span><span class="nx">enable</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">model</span><span class="p">.</span><span class="nx">disable</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">coreAddons</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">coreAddons</span><span class="p">.</span><span class="nx">creepRenderModel</span><span class="p">);</span>

<span class="cm">/*global ux */</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">coreAddons</span><span class="p">.</span><span class="nx">normalizeModel</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">normalizeModel</span><span class="p">(</span><span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-262" id="section-262">&#182;</a>
</div>
<p>TODO: this needs to be put on exp.normalizedModel</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">var</span> <span class="nx">originalData</span><span class="p">,</span> <span class="nx">normalizedData</span><span class="p">,</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">logWrapper</span><span class="p">(</span><span class="s2">&quot;normalizeModel&quot;</span><span class="p">,</span> <span class="p">{},</span> <span class="s2">&quot;grey&quot;</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="normalize">
  <h3>
    <a href="#normalize" name="normalize" class="pilcrow">&#182;</a>
    <a name="normalize">normalize</a>
  </h3>
</div>


<p>Convert a hierarchical data structure into a flattened array so that headers, rows, and however deep the data is
will all be able to represented by template rows.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">data</span>
      <span class="dox_type">Array</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">grouped</span>
      <span class="dox_type">String</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">normalized</span>
      <span class="dox_type">Array=</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">normalize</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">normalize</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">grouped</span><span class="p">,</span> <span class="nx">normalized</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">data</span> <span class="o">=</span> <span class="nx">data</span> <span class="o">||</span> <span class="p">[];</span>
        <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="nx">normalized</span> <span class="o">=</span> <span class="nx">normalized</span> <span class="o">||</span> <span class="p">[];</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">normalized</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">grouped</span><span class="p">])</span> <span class="p">{</span>
                <span class="nx">inst</span><span class="p">.</span><span class="nx">normalize</span><span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">grouped</span><span class="p">],</span> <span class="nx">grouped</span><span class="p">,</span> <span class="nx">normalized</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">normalized</span><span class="p">;</span>
    <span class="p">};</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="setdata">
  <h3>
    <a href="#setdata" name="setdata" class="pilcrow">&#182;</a>
    <a name="setData">setData</a>
  </h3>
</div>


<p>Set the data so that it can be normalized.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">data</span>
      <span class="dox_type">Array</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">grouped</span>
      <span class="dox_type">String</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">setData</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">grouped</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;setData %s&quot;</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
        <span class="nx">originalData</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">grouped</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">normalizedData</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">normalize</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">grouped</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">normalizedData</span> <span class="o">=</span> <span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">||</span> <span class="p">[];</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">normalizedData</span><span class="p">;</span>
    <span class="p">};</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="getdata">
  <h3>
    <a href="#getdata" name="getdata" class="pilcrow">&#182;</a>
    <a name="getData">getData</a>
  </h3>
</div>


<p>Get the data the datagrid is using. This is normalized data.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">getData</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">normalizedData</span><span class="p">;</span>
    <span class="p">};</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="getoriginaldata">
  <h3>
    <a href="#getoriginaldata" name="getoriginaldata" class="pilcrow">&#182;</a>
    <a name="getOriginalData">getOriginalData</a>
  </h3>
</div>


<p>Get the data that the normalized data was created from.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">getOriginalData</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">originalData</span><span class="p">;</span>
    <span class="p">};</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="getoriginalindexofitem">
  <h2>
    <a href="#getoriginalindexofitem" name="getoriginalindexofitem" class="pilcrow">&#182;</a>
    <a name="getOriginalIndexOfItem">getOriginalIndexOfItem</a>
  </h2>
</div>


<p>get the index or indexes of the item from the original data that the normalized array was created from.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">getOriginalIndexOfItem</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">getOriginalIndexOfItem</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">indexes</span> <span class="o">=</span> <span class="nx">ux</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">originalData</span><span class="p">,</span> <span class="nx">findItem</span><span class="p">,</span> <span class="nx">item</span><span class="p">,</span> <span class="p">[]);</span>
        <span class="k">return</span> <span class="nx">indexes</span> <span class="o">&amp;&amp;</span> <span class="nx">indexes</span> <span class="o">!==</span> <span class="nx">originalData</span> <span class="o">?</span> <span class="nx">indexes</span> <span class="o">:</span> <span class="p">[];</span>
    <span class="p">};</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="finditem">
  <h3>
    <a href="#finditem" name="finditem" class="pilcrow">&#182;</a>
    <a name="findItem">findItem</a>
  </h3>
</div>


<p>find the item in the list of items and recursively search the child arrays if they have the grouped property</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">item</span>
      <span class="dox_type">*</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">index</span>
      <span class="dox_type">Number</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">list</span>
      <span class="dox_type">Array</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">targetItem</span>
      <span class="dox_type">*</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">indexes</span>
      <span class="dox_type">Array</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">findItem</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">list</span><span class="p">,</span> <span class="nx">targetItem</span><span class="p">,</span> <span class="nx">indexes</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">found</span><span class="p">;</span>
        <span class="nx">indexes</span> <span class="o">=</span> <span class="nx">indexes</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
        <span class="nx">indexes</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">item</span> <span class="o">===</span> <span class="nx">targetItem</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">indexes</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">item</span><span class="p">[</span><span class="nx">inst</span><span class="p">.</span><span class="nx">grouped</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">item</span><span class="p">[</span><span class="nx">inst</span><span class="p">.</span><span class="nx">grouped</span><span class="p">].</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">found</span> <span class="o">=</span> <span class="nx">ux</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">item</span><span class="p">[</span><span class="nx">inst</span><span class="p">.</span><span class="nx">grouped</span><span class="p">],</span> <span class="nx">findItem</span><span class="p">,</span> <span class="nx">targetItem</span><span class="p">,</span> <span class="nx">indexes</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">found</span> <span class="o">&amp;&amp;</span> <span class="nx">found</span> <span class="o">!==</span> <span class="nx">item</span><span class="p">[</span><span class="nx">inst</span><span class="p">.</span><span class="nx">grouped</span><span class="p">])</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">found</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">undefined</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="getnormalizedindex">
  <h3>
    <a href="#getnormalizedindex" name="getnormalizedindex" class="pilcrow">&#182;</a>
    <a name="getNormalizedIndex">getNormalizedIndex</a>
  </h3>
</div>


<p>Get the normalized index for an item.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">item</span>
      <span class="dox_type">*</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">startIndex
</span>
      <span class="dox_type">Number=</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">getNormalizedIndex</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">getNormalizedIndex</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">startIndex</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">startIndex</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">rowsLength</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">i</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">startIndex</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">i</span> <span class="o">=</span> <span class="nx">startIndex</span><span class="p">;</span>
            <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="nx">i</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="nx">i</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">};</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="replace">
  <h3>
    <a href="#replace" name="replace" class="pilcrow">&#182;</a>
    <a name="replace">replace</a>
  </h3>
</div>


<p>Replace at the index, the newItem.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">item</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">index
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">result</span><span class="p">.</span><span class="nx">replace</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-271" id="section-271">&#182;</a>
</div>
<p>first get the original item index.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="kd">var</span> <span class="nx">indexes</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getOriginalIndexOfItem</span><span class="p">(</span><span class="nx">normalizedData</span><span class="p">[</span><span class="nx">index</span><span class="p">]),</span> <span class="nx">origItem</span><span class="p">,</span> <span class="nx">list</span> <span class="o">=</span> <span class="nx">originalData</span><span class="p">,</span> <span class="nx">lastIndex</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nx">indexes</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">lastIndex</span> <span class="o">=</span> <span class="nx">indexes</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
            <span class="nx">origItem</span> <span class="o">=</span> <span class="nx">list</span><span class="p">[</span><span class="nx">lastIndex</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">indexes</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">list</span><span class="p">[</span><span class="nx">lastIndex</span><span class="p">]</span> <span class="o">=</span> <span class="nx">item</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">grouped</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">list</span> <span class="o">=</span> <span class="nx">origItem</span><span class="p">[</span><span class="nx">inst</span><span class="p">.</span><span class="nx">grouped</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="nx">normalizedData</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">=</span> <span class="nx">item</span><span class="p">;</span>
    <span class="p">};</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="destroy">
  <h3>
    <a href="#destroy" name="destroy" class="pilcrow">&#182;</a>
    <a name="destroy">destroy</a>
  </h3>
</div>


<p>Make sure all variables are cleaned up.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">result</span><span class="p">.</span><span class="nx">destroy</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">destroy</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">destroyLogger</span><span class="p">();</span>
        <span class="nx">originalData</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">normalizedData</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">normalizeModel</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">inst</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">result</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">};</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">normalizeModel</span> <span class="o">=</span> <span class="nx">result</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">inst</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">coreAddons</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">coreAddons</span><span class="p">.</span><span class="nx">normalizeModel</span><span class="p">);</span>

<span class="cm">/*global ux */</span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_SCROLL_START</span> <span class="o">=</span> <span class="s2">&quot;datagrid:scrollStart&quot;</span><span class="p">;</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_SCROLL_STOP</span> <span class="o">=</span> <span class="s2">&quot;datagrid:scrollStop&quot;</span><span class="p">;</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_TOUCH_DOWN</span> <span class="o">=</span> <span class="s2">&quot;datagrid:touchDown&quot;</span><span class="p">;</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_TOUCH_UP</span> <span class="o">=</span> <span class="s2">&quot;datagrid:touchUp&quot;</span><span class="p">;</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">coreAddons</span><span class="p">.</span><span class="nx">scrollModel</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">scrollModel</span><span class="p">(</span><span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">logWrapper</span><span class="p">(</span><span class="s2">&quot;scrollModel&quot;</span><span class="p">,</span> <span class="p">{},</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">),</span> <span class="nx">setup</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">unwatchSetup</span><span class="p">,</span> <span class="nx">waitForStopIntv</span><span class="p">,</span> <span class="nx">hasScrollListener</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">lastScroll</span><span class="p">,</span> <span class="nx">lastRenderTime</span><span class="p">,</span> <span class="c1">// start easing</span>
    <span class="nx">startOffsetY</span><span class="p">,</span> <span class="nx">startOffsetX</span><span class="p">,</span> <span class="nx">offsetY</span><span class="p">,</span> <span class="nx">offsetX</span><span class="p">,</span> <span class="nx">startScroll</span><span class="p">,</span> <span class="nx">lastDeltaY</span><span class="p">,</span> <span class="nx">lastDeltaX</span><span class="p">,</span> <span class="nx">speed</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">startTime</span><span class="p">,</span> <span class="nx">distance</span><span class="p">,</span> <span class="nx">scrollingIntv</span><span class="p">,</span> <span class="c1">// end easing</span>
    <span class="nx">listenerData</span> <span class="o">=</span> <span class="p">[</span> <span class="p">{</span>
        <span class="nx">event</span><span class="o">:</span> <span class="s2">&quot;touchstart&quot;</span><span class="p">,</span>
        <span class="nx">method</span><span class="o">:</span> <span class="s2">&quot;onTouchStart&quot;</span><span class="p">,</span>
        <span class="nx">enabled</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span> <span class="p">{</span>
        <span class="nx">event</span><span class="o">:</span> <span class="s2">&quot;touchmove&quot;</span><span class="p">,</span>
        <span class="nx">method</span><span class="o">:</span> <span class="s2">&quot;onTouchMove&quot;</span><span class="p">,</span>
        <span class="nx">enabled</span><span class="o">:</span> <span class="kc">false</span>
    <span class="p">},</span> <span class="p">{</span>
        <span class="nx">event</span><span class="o">:</span> <span class="s2">&quot;touchend&quot;</span><span class="p">,</span>
        <span class="nx">method</span><span class="o">:</span> <span class="s2">&quot;onTouchEnd&quot;</span><span class="p">,</span>
        <span class="nx">enabled</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">},</span> <span class="p">{</span>
        <span class="nx">event</span><span class="o">:</span> <span class="s2">&quot;touchcancel&quot;</span><span class="p">,</span>
        <span class="nx">method</span><span class="o">:</span> <span class="s2">&quot;onTouchEnd&quot;</span><span class="p">,</span>
        <span class="nx">enabled</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">}</span> <span class="p">];</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-273" id="section-273">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>Listen for scrollingEvents.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="kd">function</span> <span class="nx">setupScrolling</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">unwatchSetup</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">inst</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;overflow&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;overflow&quot;</span><span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;visible&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">css</span><span class="p">({</span>
                <span class="nx">overflow</span><span class="o">:</span> <span class="s2">&quot;auto&quot;</span>
            <span class="p">});</span>
        <span class="p">}</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;addScrollListener&quot;</span><span class="p">);</span>
        <span class="nx">addScrollListener</span><span class="p">();</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">unwatchers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">SCROLL_TO_INDEX</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">scrollModel</span><span class="p">.</span><span class="nx">scrollToIndex</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">}));</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">unwatchers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">SCROLL_TO_ITEM</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">scrollModel</span><span class="p">.</span><span class="nx">scrollToItem</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">}));</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">unwatchers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">SCROLL_INTO_VIEW</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">itemOrIndex</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">scrollModel</span><span class="p">.</span><span class="nx">scrollIntoView</span><span class="p">(</span><span class="nx">itemOrIndex</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">}));</span>
        <span class="nx">addTouchEvents</span><span class="p">();</span>
        <span class="nx">setup</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">addScrollListener</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;addScrollListener&quot;</span><span class="p">);</span>
        <span class="nx">hasScrollListener</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">element</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;scroll&quot;</span><span class="p">,</span> <span class="nx">onUpdateScrollHandler</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">onBeforeReset</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scrollModel</span> <span class="o">&amp;&amp;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scrollModel</span><span class="p">.</span><span class="nx">manual</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">listenerData</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">enabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">hasScrollListener</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">result</span><span class="p">.</span><span class="nx">removeScrollListener</span><span class="p">();</span>
            <span class="nx">hasScrollListener</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">removeTouchEvents</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">onAfterReset</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">hasScrollListener</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">addScrollListener</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="nx">addTouchEvents</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">addTouchEvents</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;addTouchEvents&quot;</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">content</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getContent</span><span class="p">();</span>
        <span class="nx">exports</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">listenerData</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">enabled</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">result</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;  add %s&quot;</span><span class="p">,</span> <span class="nx">item</span><span class="p">.</span><span class="nx">event</span><span class="p">);</span>
                <span class="nx">content</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">event</span><span class="p">,</span> <span class="nx">result</span><span class="p">[</span><span class="nx">item</span><span class="p">.</span><span class="nx">method</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">});</span>
    <span class="p">}</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">fireOnScroll</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">fireOnScroll</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">scroll</span> <span class="o">!==</span> <span class="nx">lastScroll</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">lastScroll</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">scroll</span><span class="p">;</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_SCROLL</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">removeScrollListener</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">removeScrollListener</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;removeScrollListener&quot;</span><span class="p">);</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">element</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s2">&quot;scroll&quot;</span><span class="p">,</span> <span class="nx">onUpdateScrollHandler</span><span class="p">);</span>
    <span class="p">};</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">removeTouchEvents</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">removeTouchEvents</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">setup</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">result</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;removeTouchEvents&quot;</span><span class="p">);</span>
            <span class="kd">var</span> <span class="nx">content</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getContent</span><span class="p">();</span>
            <span class="nx">exports</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">listenerData</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">result</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;  remove %s&quot;</span><span class="p">,</span> <span class="nx">item</span><span class="p">.</span><span class="nx">event</span><span class="p">);</span>
                <span class="nx">content</span><span class="p">.</span><span class="nx">unbind</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">event</span><span class="p">,</span> <span class="nx">result</span><span class="p">[</span><span class="nx">item</span><span class="p">.</span><span class="nx">method</span><span class="p">]);</span>
            <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="kd">function</span> <span class="nx">getTouches</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">event</span><span class="p">.</span><span class="nx">touches</span> <span class="o">||</span> <span class="nx">event</span><span class="p">.</span><span class="nx">originalEvent</span><span class="p">.</span><span class="nx">touches</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">killEvent</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">)</span> <span class="nx">event</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">stopImmediatePropagation</span><span class="p">)</span> <span class="nx">event</span><span class="p">.</span><span class="nx">stopImmediatePropagation</span><span class="p">();</span>
    <span class="p">};</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">onTouchStart</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">onTouchStart</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">scrollingIntv</span><span class="p">);</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">touchDown</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="nx">offsetY</span> <span class="o">=</span> <span class="nx">startOffsetY</span> <span class="o">=</span> <span class="nx">getTouches</span><span class="p">(</span><span class="nx">event</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">clientY</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">offsetX</span> <span class="o">=</span> <span class="nx">startOffsetX</span> <span class="o">=</span> <span class="nx">getTouches</span><span class="p">(</span><span class="nx">event</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">clientX</span> <span class="o">||</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">startScroll</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">scroll</span><span class="p">;</span>
        <span class="nx">lastDeltaY</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">lastDeltaX</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_TOUCH_DOWN</span><span class="p">,</span> <span class="nx">event</span><span class="p">);</span>
    <span class="p">};</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">onTouchMove</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">killEvent</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">getTouches</span><span class="p">(</span><span class="nx">event</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">clientY</span><span class="p">,</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">getTouches</span><span class="p">(</span><span class="nx">event</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">clientX</span><span class="p">,</span> <span class="nx">deltaY</span> <span class="o">=</span> <span class="nx">offsetY</span> <span class="o">-</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">deltaX</span> <span class="o">=</span> <span class="nx">offsetX</span> <span class="o">-</span> <span class="nx">x</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">deltaY</span> <span class="o">!==</span> <span class="nx">lastDeltaY</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">result</span><span class="p">.</span><span class="nx">setScroll</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">capScrollValue</span><span class="p">(</span><span class="nx">startScroll</span> <span class="o">+</span> <span class="nx">deltaY</span><span class="p">));</span>
            <span class="nx">speed</span> <span class="o">=</span> <span class="nx">deltaY</span> <span class="o">-</span> <span class="nx">lastDeltaY</span><span class="p">;</span>
            <span class="nx">lastDeltaY</span> <span class="o">=</span> <span class="nx">deltaY</span><span class="p">;</span>
            <span class="nx">lastDeltaX</span> <span class="o">=</span> <span class="nx">deltaX</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">onTouchEnd</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">onTouchEnd</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">touchDown</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_TOUCH_UP</span><span class="p">,</span> <span class="nx">event</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">listenerData</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">enabled</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">lastDeltaY</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">lastDeltaX</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">result</span><span class="p">.</span><span class="nx">click</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">startTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
                <span class="nx">distance</span> <span class="o">=</span> <span class="nx">speed</span> <span class="o">*</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scrollModel</span><span class="p">.</span><span class="nx">speed</span><span class="p">;</span>
                <span class="nx">result</span><span class="p">.</span><span class="nx">scrollSlowDown</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="kd">var</span> <span class="nx">sTop</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">element</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">scrollTop</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">sTop</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getContentHeight</span><span class="p">()</span> <span class="o">&lt;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getViewportHeight</span><span class="p">())</span> <span class="p">{</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">element</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">sTop</span> <span class="o">&gt;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getContentHeight</span><span class="p">()</span> <span class="o">-</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getViewportHeight</span><span class="p">())</span> <span class="p">{</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">element</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getContentHeight</span><span class="p">()</span> <span class="o">-</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getViewportHeight</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">scrollSlowDown</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">wait</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">scrollingIntv</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">duration</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">speed</span><span class="p">)</span> <span class="o">*</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scrollModel</span><span class="p">.</span><span class="nx">speed</span><span class="p">,</span> <span class="nx">t</span> <span class="o">=</span> <span class="nx">duration</span> <span class="o">-</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">-</span> <span class="nx">startTime</span><span class="p">),</span> <span class="nx">prevDistance</span> <span class="o">=</span> <span class="nx">distance</span><span class="p">,</span> <span class="nx">change</span><span class="p">;</span>
        <span class="nx">distance</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">easeOut</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span> <span class="nx">distance</span><span class="p">,</span> <span class="nx">speed</span> <span class="o">||</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">duration</span><span class="p">);</span>
        <span class="nx">change</span> <span class="o">=</span> <span class="nx">distance</span> <span class="o">-</span> <span class="nx">prevDistance</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">change</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">t</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">value</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">capScrollValue</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">scroll</span> <span class="o">+</span> <span class="nx">change</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">wait</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-274" id="section-274">&#182;</a>
</div>

<div class="highlight"><pre><code>           <span class="n">result</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">scroll %s of %s&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">inst</span><span class="p">.</span><span class="n">element</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">scrollHeight</span><span class="p">);</span>
</code></pre></div>


        </td>
        <td class="code highlight"><div class="highlight"><pre>
                <span class="nx">inst</span><span class="p">.</span><span class="nx">element</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">scrollingIntv</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">scrollSlowDown</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">easeOut</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">easeOutQuad</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">d</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">-</span><span class="nx">c</span> <span class="o">*</span> <span class="p">(</span><span class="nx">t</span> <span class="o">/=</span> <span class="nx">d</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="nx">t</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span>
    <span class="p">};</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">click</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-275" id="section-275">&#182;</a>
</div>
<p>simulate click on android. Ignore on IOS.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">isIOS</span> <span class="o">||</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scrollModel</span><span class="p">.</span><span class="nx">simulateClick</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">scrollModel</span><span class="p">.</span><span class="nx">simulateClick</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">result</span><span class="p">.</span><span class="nx">killEvent</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="kd">var</span> <span class="nx">target</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span> <span class="nx">ev</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="sr">/(SELECT|INPUT|TEXTAREA)/i</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">target</span><span class="p">.</span><span class="nx">tagName</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">ev</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createEvent</span><span class="p">(</span><span class="s2">&quot;MouseEvents&quot;</span><span class="p">);</span>
                <span class="nx">ev</span><span class="p">.</span><span class="nx">initMouseEvent</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">view</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">target</span><span class="p">.</span><span class="nx">screenX</span><span class="p">,</span> <span class="nx">target</span><span class="p">.</span><span class="nx">screenY</span><span class="p">,</span> <span class="nx">target</span><span class="p">.</span><span class="nx">clientX</span><span class="p">,</span> <span class="nx">target</span><span class="p">.</span><span class="nx">clientY</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">ctrlKey</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">altKey</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">shiftKey</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="nx">metaKey</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
                <span class="nx">ev</span><span class="p">.</span><span class="nx">_constructed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                <span class="nx">target</span><span class="p">.</span><span class="nx">dispatchEvent</span><span class="p">(</span><span class="nx">ev</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">getScroll</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">getScroll</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="nx">el</span> <span class="o">||</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">element</span><span class="p">[</span><span class="mi">0</span><span class="p">]).</span><span class="nx">scrollTop</span><span class="p">;</span>
    <span class="p">};</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">setScroll</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">setScroll</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">unwatch</span><span class="p">,</span> <span class="nx">chunkList</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">chunkModel</span><span class="p">.</span><span class="nx">getChunkList</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">chunkList</span> <span class="o">||</span> <span class="o">!</span><span class="nx">chunkList</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-276" id="section-276">&#182;</a>
</div>
<p>wait until that height is ready then scroll.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">unwatch</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_AFTER_RENDER</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">unwatch</span><span class="p">();</span>
                <span class="nx">result</span><span class="p">.</span><span class="nx">setScroll</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">getContentHeight</span><span class="p">()</span> <span class="o">-</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getViewportHeight</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">element</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">scroll</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
    <span class="p">};</span>
    <span class="kd">function</span> <span class="nx">onUpdateScrollHandler</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">scrollModel</span><span class="p">.</span><span class="nx">onUpdateScroll</span><span class="p">(</span><span class="nx">event</span><span class="p">);</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-277" id="section-277">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>When a scrollEvent is fired, recalculate the values.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">event
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">result</span><span class="p">.</span><span class="nx">onUpdateScroll</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">onUpdateScroll</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">val</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">scrollModel</span><span class="p">.</span><span class="nx">getScroll</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span> <span class="o">||</span> <span class="nx">event</span><span class="p">.</span><span class="nx">srcElement</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">scroll</span> <span class="o">!==</span> <span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_SCROLL_START</span><span class="p">,</span> <span class="nx">val</span><span class="p">);</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">speed</span> <span class="o">=</span> <span class="nx">val</span> <span class="o">-</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">scroll</span><span class="p">;</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">absSpeed</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">speed</span><span class="p">);</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">scroll</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">scrollPercent</span> <span class="o">=</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">scroll</span> <span class="o">/</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getContentHeight</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span><span class="p">).</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">scrollModel</span><span class="p">.</span><span class="nx">waitForStop</span><span class="p">();</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">fireOnScroll</span><span class="p">();</span>
    <span class="p">};</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">capScrollValue</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">newVal</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">getContentHeight</span><span class="p">()</span> <span class="o">&lt;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getViewportHeight</span><span class="p">())</span> <span class="p">{</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;  CAPPED scroll value from %s to 0&quot;</span><span class="p">,</span> <span class="nx">value</span><span class="p">);</span>
            <span class="nx">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">getContentHeight</span><span class="p">()</span> <span class="o">-</span> <span class="nx">value</span> <span class="o">&lt;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getViewportHeight</span><span class="p">())</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-278" id="section-278">&#182;</a>
</div>
<p>don't allow to scroll past the bottom.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">newVal</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getContentHeight</span><span class="p">()</span> <span class="o">-</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getViewportHeight</span><span class="p">();</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-279" id="section-279">&#182;</a>
</div>
<p>this will be the bottom scroll.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;  CAPPED scroll value to keep it from scrolling past the bottom. changed %s to %s&quot;</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">newVal</span><span class="p">);</span>
            <span class="nx">value</span> <span class="o">=</span> <span class="nx">newVal</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">value</span><span class="p">;</span>
    <span class="p">};</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-280" id="section-280">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>Scroll to the numeric value.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">value</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">immediately
</span>
      <span class="dox_type">Boolean=</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">result</span><span class="p">.</span><span class="nx">scrollTo</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">scrollTo</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">immediately</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">value</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">capScrollValue</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">scrollModel</span><span class="p">.</span><span class="nx">setScroll</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">immediately</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">scrollModel</span><span class="p">.</span><span class="nx">onScrollingStop</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">scrollModel</span><span class="p">.</span><span class="nx">waitForStop</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">clearOnScrollingStop</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">clearOnScrollingStop</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">onScrollingStop</span><span class="p">();</span>
    <span class="p">};</span>
    <span class="kd">function</span> <span class="nx">flowWaitForStop</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">lastRenderTime</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">scrollModel</span><span class="p">.</span><span class="nx">onScrollingStop</span><span class="p">();</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-281" id="section-281">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>Wait for the datagrid to slow down enough to render.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">result</span><span class="p">.</span><span class="nx">waitForStop</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">waitForStop</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">forceRender</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">waitForStopIntv</span><span class="p">);</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;waitForStop scroll = %s&quot;</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">scroll</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">renderWhileScrolling</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">renderWhileScrolling</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nx">lastRenderTime</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">forceRender</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">forceRender</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">flow</span><span class="p">.</span><span class="nx">async</span> <span class="o">||</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">touchDown</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">waitForStopIntv</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">flowWaitForStop</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">updateDelay</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">flowWaitForStop</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">};</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-282" id="section-282">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>When it stops render.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">result</span><span class="p">.</span><span class="nx">onScrollingStop</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">onScrollingStop</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;onScrollingStop %s&quot;</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">scroll</span><span class="p">);</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">speed</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">absSpeed</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">fireOnScroll</span><span class="p">();</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_SCROLL_STOP</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">);</span>
    <span class="p">};</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-283" id="section-283">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>Scroll to the normalized index.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">index</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">immediately
</span>
      <span class="dox_type">Boolean=</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">result</span><span class="p">.</span><span class="nx">scrollToIndex</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">scrollToIndex</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">immediately</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;scrollToIndex&quot;</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">offset</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getRowOffset</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">scrollModel</span><span class="p">.</span><span class="nx">scrollTo</span><span class="p">(</span><span class="nx">offset</span><span class="p">,</span> <span class="nx">immediately</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">offset</span><span class="p">;</span>
    <span class="p">};</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-284" id="section-284">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>Scroll to an item by finding it's normalized index.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">item</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">immediately
</span>
      <span class="dox_type">Boolean=</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">result</span><span class="p">.</span><span class="nx">scrollToItem</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">scrollToItem</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">immediately</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;scrollToItem&quot;</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getNormalizedIndex</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">index</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">scrollModel</span><span class="p">.</span><span class="nx">scrollToIndex</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">immediately</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">scroll</span><span class="p">;</span>
    <span class="p">};</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-285" id="section-285">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>If the item is above or below the viewable area, scroll till it is in view.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">itemOrIndex</span>
    </div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">immediately
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">result</span><span class="p">.</span><span class="nx">scrollIntoView</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">scrollIntoView</span><span class="p">(</span><span class="nx">itemOrIndex</span><span class="p">,</span> <span class="nx">immediately</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;scrollIntoView&quot;</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">index</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">itemOrIndex</span> <span class="o">===</span> <span class="s2">&quot;number&quot;</span> <span class="o">?</span> <span class="nx">itemOrIndex</span> <span class="o">:</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getNormalizedIndex</span><span class="p">(</span><span class="nx">itemOrIndex</span><span class="p">),</span> <span class="nx">offset</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getRowOffset</span><span class="p">(</span><span class="nx">index</span><span class="p">),</span> <span class="nx">rowHeight</span><span class="p">,</span> <span class="nx">viewHeight</span><span class="p">;</span>
        <span class="nx">compileRowSiblings</span><span class="p">(</span><span class="nx">index</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">offset</span> <span class="o">&lt;</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">scroll</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-286" id="section-286">&#182;</a>
</div>
<p>it is above the view.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">scrollModel</span><span class="p">.</span><span class="nx">scrollTo</span><span class="p">(</span><span class="nx">offset</span><span class="p">,</span> <span class="nx">immediately</span><span class="p">);</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">updateViewportHeight</span><span class="p">();</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-287" id="section-287">&#182;</a>
</div>
<p>always update the height before calculating. onResize is not reliable</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">viewHeight</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getViewportHeight</span><span class="p">();</span>
        <span class="nx">rowHeight</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">.</span><span class="nx">getTemplateHeight</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">getData</span><span class="p">()[</span><span class="nx">index</span><span class="p">]);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">offset</span> <span class="o">&gt;=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">scroll</span> <span class="o">+</span> <span class="nx">viewHeight</span> <span class="o">-</span> <span class="nx">rowHeight</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-288" id="section-288">&#182;</a>
</div>
<p>it is below the view.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">scrollModel</span><span class="p">.</span><span class="nx">scrollTo</span><span class="p">(</span><span class="nx">offset</span> <span class="o">-</span> <span class="nx">viewHeight</span> <span class="o">+</span> <span class="nx">rowHeight</span><span class="p">,</span> <span class="nx">immediately</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="kd">function</span> <span class="nx">compileRowSiblings</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">inst</span><span class="p">.</span><span class="nx">isCompiled</span><span class="p">(</span><span class="nx">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">forceRenderScope</span><span class="p">(</span><span class="nx">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">inst</span><span class="p">.</span><span class="nx">isCompiled</span><span class="p">(</span><span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">forceRenderScope</span><span class="p">(</span><span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">function</span> <span class="nx">onAfterHeightsUpdated</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">hasScrollListener</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">result</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;onAfterHeightsUpdated force scroll to %s&quot;</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">scroll</span><span class="p">);</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">element</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">scroll</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-289" id="section-289">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>Scroll to top.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">immediately
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">result</span><span class="p">.</span><span class="nx">scrollToTop</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">immediately</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;scrollToTop&quot;</span><span class="p">);</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">scrollModel</span><span class="p">.</span><span class="nx">scrollTo</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">immediately</span><span class="p">);</span>
    <span class="p">};</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-290" id="section-290">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>Scroll to bottom.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">immediately
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">result</span><span class="p">.</span><span class="nx">scrollToBottom</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">immediately</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;scrollToBottom&quot;</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getContentHeight</span><span class="p">()</span> <span class="o">-</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getViewportHeight</span><span class="p">();</span>
        <span class="nx">inst</span><span class="p">.</span><span class="nx">scrollModel</span><span class="p">.</span><span class="nx">scrollTo</span><span class="p">(</span><span class="nx">value</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">value</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">immediately</span><span class="p">);</span>
    <span class="p">};</span>
    <span class="kd">function</span> <span class="nx">destroy</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">waitForStopIntv</span><span class="p">);</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">destroyLogger</span><span class="p">();</span>
        <span class="nx">unwatchSetup</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">setup</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">result</span><span class="p">.</span><span class="nx">removeScrollListener</span><span class="p">();</span>
            <span class="nx">result</span><span class="p">.</span><span class="nx">removeTouchEvents</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="nx">result</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">inst</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-291" id="section-291">&#182;</a>
</div>
<div class="dox">
  <div class="summary"><p>Wait till the grid is ready before we setup our listeners.</p>
  </div>
  <div class="body">
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">unwatchSetup</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_READY</span><span class="p">,</span> <span class="nx">setupScrolling</span><span class="p">);</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">unwatchers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_AFTER_HEIGHTS_UPDATED</span><span class="p">,</span> <span class="nx">onAfterHeightsUpdated</span><span class="p">));</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">unwatchers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_BEFORE_RESET</span><span class="p">,</span> <span class="nx">onBeforeReset</span><span class="p">));</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">unwatchers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">scope</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_AFTER_RESET</span><span class="p">,</span> <span class="nx">onAfterReset</span><span class="p">));</span>
    <span class="nx">result</span><span class="p">.</span><span class="nx">destroy</span> <span class="o">=</span> <span class="nx">destroy</span><span class="p">;</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">scrollModel</span> <span class="o">=</span> <span class="nx">result</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-292" id="section-292">&#182;</a>
</div>
<p>all models should try not to pollute the main model to keep it clean.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="k">return</span> <span class="nx">inst</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">coreAddons</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">coreAddons</span><span class="p">.</span><span class="nx">scrollModel</span><span class="p">);</span>

<span class="cm">/*global angular */</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="templatemodel">
  <h2>
    <a href="#templatemodel" name="templatemodel" class="pilcrow">&#182;</a>
    <a name="templateModel">templateModel</a>
  </h2>
</div>


<p>Management of templates for the datagrid.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">inst</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">coreAddons</span><span class="p">.</span><span class="nx">templateModel</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">templateModel</span><span class="p">(</span><span class="nx">inst</span><span class="p">)</span> <span class="p">{</span>
    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>
    <span class="kd">function</span> <span class="nx">trim</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-294" id="section-294">&#182;</a>
</div>
<p>remove newline / carriage return</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">str</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\n/g</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-295" id="section-295">&#182;</a>
</div>
<p>remove whitespace (space and tabs) before tags</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">str</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[\t ]+&lt;/g</span><span class="p">,</span> <span class="s2">&quot;&lt;&quot;</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-296" id="section-296">&#182;</a>
</div>
<p>remove whitespace between tags</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">str</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&gt;[\t ]+&lt;/g</span><span class="p">,</span> <span class="s2">&quot;&gt;&lt;&quot;</span><span class="p">);</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-297" id="section-297">&#182;</a>
</div>
<p>remove whitespace after tags</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">str</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&gt;[\t ]+$/g</span><span class="p">,</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">str</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">templates</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">totalHeight</span><span class="p">,</span> <span class="nx">defaultName</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">.</span><span class="nx">logWrapper</span><span class="p">(</span><span class="s2">&quot;templateModel&quot;</span><span class="p">,</span> <span class="p">{},</span> <span class="s2">&quot;teal&quot;</span><span class="p">,</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">),</span> <span class="nx">forcedTemplates</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">templatesKey</span><span class="p">;</span>
        <span class="kd">function</span> <span class="nx">getTemplatesKey</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">templatesKey</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">templatesKey</span> <span class="o">=</span> <span class="s2">&quot;$$template_&quot;</span> <span class="o">+</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">uid</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="nx">templatesKey</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kd">function</span> <span class="nx">createTemplates</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">result</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;createTemplates&quot;</span><span class="p">);</span>
            <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">scriptTemplates</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">element</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s2">&quot;script&quot;</span><span class="p">),</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">scriptTemplates</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">len</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">templates</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">errors</span><span class="p">.</span><span class="nx">E1102</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">createTemplateFromScriptTemplate</span><span class="p">(</span><span class="nx">scriptTemplates</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
            <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-298" id="section-298">&#182;</a>
</div>
<p>remove the script templates.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">while</span> <span class="p">(</span><span class="nx">scriptTemplates</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">inst</span><span class="p">.</span><span class="nx">element</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">scriptTemplates</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="kd">function</span> <span class="nx">createTemplateFromScriptTemplate</span><span class="p">(</span><span class="nx">scriptTemplate</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">getScriptTemplateAttribute</span><span class="p">(</span><span class="nx">scriptTemplate</span><span class="p">,</span> <span class="s2">&quot;template-name&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="nx">defaultName</span><span class="p">,</span> <span class="nx">base</span> <span class="o">=</span> <span class="nx">getScriptTemplateAttribute</span><span class="p">(</span><span class="nx">scriptTemplate</span><span class="p">,</span> <span class="s2">&quot;template-base&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">itemName</span> <span class="o">=</span> <span class="nx">getScriptTemplateAttribute</span><span class="p">(</span><span class="nx">scriptTemplate</span><span class="p">,</span> <span class="s2">&quot;template-item&quot;</span><span class="p">);</span>
            <span class="k">return</span> <span class="nx">createTemplate</span><span class="p">(</span><span class="nx">trim</span><span class="p">(</span><span class="nx">angular</span><span class="p">.</span><span class="nx">element</span><span class="p">(</span><span class="nx">scriptTemplate</span><span class="p">).</span><span class="nx">html</span><span class="p">()),</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">itemName</span><span class="p">,</span> <span class="nx">base</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="kd">function</span> <span class="nx">createTemplatesFromData</span><span class="p">(</span><span class="nx">templateData</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">exports</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">templateData</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">tpl</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">createTemplate</span><span class="p">(</span><span class="nx">tpl</span><span class="p">.</span><span class="nx">template</span><span class="p">,</span> <span class="nx">tpl</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">tpl</span><span class="p">.</span><span class="nx">item</span><span class="p">,</span> <span class="nx">tpl</span><span class="p">.</span><span class="nx">base</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">}</span>
        <span class="kd">function</span> <span class="nx">createTemplate</span><span class="p">(</span><span class="nx">template</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">itemName</span><span class="p">,</span> <span class="nx">base</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">originalTemplate</span> <span class="o">=</span> <span class="nx">template</span><span class="p">,</span> <span class="nx">wrapper</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">),</span> <span class="nx">templateData</span><span class="p">;</span>
            <span class="nx">wrapper</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s2">&quot;grid-template-wrapper&quot;</span><span class="p">;</span>
            <span class="nx">template</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">prepTemplate</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">template</span><span class="p">,</span> <span class="nx">base</span><span class="p">);</span>
            <span class="nx">template</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">element</span><span class="p">(</span><span class="nx">template</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">base</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">template</span><span class="p">.</span><span class="nx">className</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">rowClass</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">uncompiledClass</span> <span class="o">+</span> <span class="s2">&quot; {{$status}}&quot;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nx">template</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;template&quot;</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">getContent</span><span class="p">()[</span><span class="mi">0</span><span class="p">].</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">wrapper</span><span class="p">);</span>
            <span class="nx">wrapper</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">template</span><span class="p">);</span>
            <span class="nx">template</span> <span class="o">=</span> <span class="nx">trim</span><span class="p">(</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">);</span>
            <span class="nx">templateData</span> <span class="o">=</span> <span class="p">{</span>
                <span class="nx">name</span><span class="o">:</span> <span class="nx">name</span><span class="p">,</span>
                <span class="nx">item</span><span class="o">:</span> <span class="nx">itemName</span><span class="p">,</span>
                <span class="nx">template</span><span class="o">:</span> <span class="nx">template</span><span class="p">,</span>
                <span class="nx">originalTemplate</span><span class="o">:</span> <span class="nx">originalTemplate</span><span class="p">,</span>
                <span class="nx">height</span><span class="o">:</span> <span class="nx">wrapper</span><span class="p">.</span><span class="nx">offsetHeight</span>
            <span class="p">};</span>
            <span class="nx">result</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;template: %s %o&quot;</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">templateData</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">templateData</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">element</span><span class="p">.</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;display&quot;</span><span class="p">)</span> <span class="o">===</span> <span class="s2">&quot;none&quot;</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">result</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s2">&quot;Datagrid was intialized with a display:&#39;none&#39; value. Templates are unable to calculate heights. Grid will not render correctly.&quot;</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">inst</span><span class="p">.</span><span class="nx">element</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">offsetHeight</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">errors</span><span class="p">.</span><span class="nx">E1000</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">errors</span><span class="p">.</span><span class="nx">E1101</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="nx">templates</span><span class="p">[</span><span class="nx">templateData</span><span class="p">.</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">templateData</span><span class="p">;</span>
            <span class="nx">templates</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">templateData</span><span class="p">);</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">getContent</span><span class="p">()[</span><span class="mi">0</span><span class="p">].</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">wrapper</span><span class="p">);</span>
            <span class="nx">totalHeight</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-299" id="section-299">&#182;</a>
</div>
<p>reset cached value.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">return</span> <span class="nx">templateData</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kd">function</span> <span class="nx">prepTemplate</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">templateStr</span><span class="p">,</span> <span class="nx">base</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nx">baseTemplate</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">base</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">baseTemplate</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">getTemplateByName</span><span class="p">(</span><span class="nx">base</span><span class="p">);</span>
                <span class="nx">str</span> <span class="o">=</span> <span class="nx">baseTemplate</span><span class="p">.</span><span class="nx">originalTemplate</span><span class="p">;</span>
                <span class="nx">str</span> <span class="o">=</span> <span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s2">&quot;#{3}&quot;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot;#{3}&quot;</span><span class="p">,</span> <span class="s2">&quot;gi&quot;</span><span class="p">),</span> <span class="nx">templateStr</span><span class="p">);</span>
                <span class="k">return</span> <span class="nx">str</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="nx">templateStr</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\#{3}[\w\d\W]+\#{3}/</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="kd">function</span> <span class="nx">getScriptTemplateAttribute</span><span class="p">(</span><span class="nx">scriptTemplate</span><span class="p">,</span> <span class="nx">attrStr</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">node</span> <span class="o">=</span> <span class="nx">scriptTemplate</span><span class="p">.</span><span class="nx">attributes</span><span class="p">[</span><span class="s2">&quot;data-&quot;</span> <span class="o">+</span> <span class="nx">attrStr</span><span class="p">]</span> <span class="o">||</span> <span class="nx">scriptTemplate</span><span class="p">.</span><span class="nx">attributes</span><span class="p">[</span><span class="nx">attrStr</span><span class="p">];</span>
            <span class="k">return</span> <span class="nx">node</span> <span class="o">&amp;&amp;</span> <span class="nx">node</span><span class="p">.</span><span class="nx">nodeValue</span> <span class="o">||</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kd">function</span> <span class="nx">getTemplates</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">templates</span><span class="p">;</span>
        <span class="p">}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs"><div class="dox">
  <div class="summary">
<div class="pilwrap" id="gettemplate">
  <h3>
    <a href="#gettemplate" name="gettemplate" class="pilcrow">&#182;</a>
    <a name="getTemplate">getTemplate</a>
  </h3>
</div>


<p>Use the data object from each item in the array to determine the template for that item.</p>
  </div>
  <div class="body">
  </div>
  <div class="details">
    <div class="dox_tag_title">Params</div>
    <div class="dox_tag_detail">
      <span class="dox_tag_name">data
</span>
    </div>
  </div>
</div>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">result</span><span class="p">.</span><span class="nx">getTemplate</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">getTemplate</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">tpl</span> <span class="o">=</span> <span class="nx">data</span><span class="p">[</span><span class="nx">getTemplatesKey</span><span class="p">()]</span> <span class="o">||</span> <span class="nx">data</span><span class="p">.</span><span class="nx">_template</span><span class="p">;</span>
            <span class="k">return</span> <span class="nx">result</span><span class="p">.</span><span class="nx">getTemplateByName</span><span class="p">(</span><span class="nx">tpl</span><span class="p">);</span>
        <span class="p">};</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-301" id="section-301">&#182;</a>
</div>
<p>TODO: need to make this method so it can be overwritten to look up templates a different way.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="kd">function</span> <span class="nx">getTemplateName</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span> <span class="o">?</span> <span class="nx">el</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;template&quot;</span><span class="p">)</span> <span class="o">:</span> <span class="nx">el</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;template&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="kd">function</span> <span class="nx">getTemplateByName</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">templates</span><span class="p">[</span><span class="nx">name</span><span class="p">])</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">templates</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="nx">templates</span><span class="p">[</span><span class="nx">defaultName</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="kd">function</span> <span class="nx">dynamicHeights</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">h</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">templates</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">templates</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">i</span><span class="p">))</span> <span class="p">{</span>
                    <span class="nx">h</span> <span class="o">=</span> <span class="nx">h</span> <span class="o">||</span> <span class="nx">templates</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">height</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">h</span> <span class="o">!==</span> <span class="nx">templates</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">height</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kd">function</span> <span class="nx">averageTemplateHeight</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">templates</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">totalHeight</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">totalHeight</span> <span class="o">+=</span> <span class="nx">templates</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">height</span><span class="p">;</span>
                    <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="nx">totalHeight</span> <span class="o">/</span> <span class="nx">len</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kd">function</span> <span class="nx">countTemplates</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">templates</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kd">function</span> <span class="nx">getTemplateHeight</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">tpl</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">getTemplate</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
            <span class="k">return</span> <span class="nx">tpl</span> <span class="o">?</span> <span class="nx">tpl</span><span class="p">.</span><span class="nx">height</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kd">function</span> <span class="nx">getHeight</span><span class="p">(</span><span class="nx">list</span><span class="p">,</span> <span class="nx">startRowIndex</span><span class="p">,</span> <span class="nx">endRowIndex</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">startRowIndex</span><span class="p">,</span> <span class="nx">height</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">endRowIndex</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">height</span> <span class="o">+=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">getTemplateHeight</span><span class="p">(</span><span class="nx">list</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
                <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="nx">height</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kd">function</span> <span class="nx">setTemplateName</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">templateName</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">getTemplatesKey</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">item</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">forcedTemplates</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">forcedTemplates</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="nx">item</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">templateName</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kd">function</span> <span class="nx">setTemplate</span><span class="p">(</span><span class="nx">itemOrIndex</span><span class="p">,</span> <span class="nx">newTemplateName</span><span class="p">,</span> <span class="nx">classes</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">result</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;setTemplate %s %s&quot;</span><span class="p">,</span> <span class="nx">itemOrIndex</span><span class="p">,</span> <span class="nx">newTemplateName</span><span class="p">);</span>
            <span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">itemOrIndex</span> <span class="o">===</span> <span class="s2">&quot;number&quot;</span> <span class="o">?</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">itemOrIndex</span><span class="p">]</span> <span class="o">:</span> <span class="nx">itemOrIndex</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">oldTemplate</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">getTemplate</span><span class="p">(</span><span class="nx">item</span><span class="p">).</span><span class="nx">name</span><span class="p">;</span>
            <span class="nx">result</span><span class="p">.</span><span class="nx">setTemplateName</span><span class="p">(</span><span class="nx">item</span><span class="p">,</span> <span class="nx">newTemplateName</span><span class="p">);</span>
            <span class="nx">inst</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">events</span><span class="p">.</span><span class="nx">ON_ROW_TEMPLATE_CHANGE</span><span class="p">,</span> <span class="nx">item</span><span class="p">,</span> <span class="nx">oldTemplate</span><span class="p">,</span> <span class="nx">newTemplateName</span><span class="p">,</span> <span class="nx">classes</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="kd">function</span> <span class="nx">updateTemplateHeights</span><span class="p">()</span> <span class="p">{</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-302" id="section-302">&#182;</a>
</div>
<p>TODO: needs unit tested.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">activeRange</span><span class="p">.</span><span class="nx">min</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="nx">activeRange</span><span class="p">.</span><span class="nx">max</span> <span class="o">-</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">row</span><span class="p">,</span> <span class="nx">tpl</span><span class="p">,</span> <span class="nx">rowHeight</span><span class="p">,</span> <span class="nx">changed</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">heightCache</span> <span class="o">=</span> <span class="p">{};</span>
            <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">tpl</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">getTemplate</span><span class="p">(</span><span class="nx">inst</span><span class="p">.</span><span class="nx">getData</span><span class="p">()[</span><span class="nx">i</span><span class="p">]);</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">heightCache</span><span class="p">[</span><span class="nx">tpl</span><span class="p">.</span><span class="nx">name</span><span class="p">])</span> <span class="p">{</span>
                    <span class="nx">row</span> <span class="o">=</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">getRowElm</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
                    <span class="nx">rowHeight</span> <span class="o">=</span> <span class="nx">row</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">offsetHeight</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nx">rowHeight</span> <span class="o">!==</span> <span class="nx">tpl</span><span class="p">.</span><span class="nx">height</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">tpl</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="nx">rowHeight</span><span class="p">;</span>
                        <span class="nx">changed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">changed</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">inst</span><span class="p">.</span><span class="nx">updateHeights</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="kd">function</span> <span class="nx">clearTemplate</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">delete</span> <span class="nx">item</span><span class="p">[</span><span class="nx">getTemplatesKey</span><span class="p">()];</span>
        <span class="p">}</span>
        <span class="kd">function</span> <span class="nx">destroy</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">exports</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">forcedTemplates</span><span class="p">,</span> <span class="nx">clearTemplate</span><span class="p">);</span>
            <span class="nx">forcedTemplates</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="nx">result</span><span class="p">.</span><span class="nx">destroyLogger</span><span class="p">();</span>
            <span class="nx">result</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="nx">templates</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="nx">templates</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="nx">forcedTemplates</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">defaultName</span> <span class="o">=</span> <span class="nx">defaultName</span><span class="p">;</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">prepTemplate</span> <span class="o">=</span> <span class="nx">prepTemplate</span><span class="p">;</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">createTemplates</span> <span class="o">=</span> <span class="nx">createTemplates</span><span class="p">;</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">createTemplatesFromData</span> <span class="o">=</span> <span class="nx">createTemplatesFromData</span><span class="p">;</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">getTemplates</span> <span class="o">=</span> <span class="nx">getTemplates</span><span class="p">;</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">getTemplateName</span> <span class="o">=</span> <span class="nx">getTemplateName</span><span class="p">;</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">getTemplateByName</span> <span class="o">=</span> <span class="nx">getTemplateByName</span><span class="p">;</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">templateCount</span> <span class="o">=</span> <span class="nx">countTemplates</span><span class="p">;</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">dynamicHeights</span> <span class="o">=</span> <span class="nx">dynamicHeights</span><span class="p">;</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">averageTemplateHeight</span> <span class="o">=</span> <span class="nx">averageTemplateHeight</span><span class="p">;</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">getHeight</span> <span class="o">=</span> <span class="nx">getHeight</span><span class="p">;</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">getTemplateHeight</span> <span class="o">=</span> <span class="nx">getTemplateHeight</span><span class="p">;</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">setTemplate</span> <span class="o">=</span> <span class="nx">setTemplate</span><span class="p">;</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">setTemplateName</span> <span class="o">=</span> <span class="nx">setTemplateName</span><span class="p">;</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">updateTemplateHeights</span> <span class="o">=</span> <span class="nx">updateTemplateHeights</span><span class="p">;</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">getTemplatesKey</span> <span class="o">=</span> <span class="nx">getTemplatesKey</span><span class="p">;</span>
        <span class="nx">result</span><span class="p">.</span><span class="nx">destroy</span> <span class="o">=</span> <span class="nx">destroy</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="p">}();</span>
    <span class="k">return</span> <span class="nx">inst</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">;</span>
<span class="p">};</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">coreAddons</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">exports</span><span class="p">.</span><span class="nx">datagrid</span><span class="p">.</span><span class="nx">coreAddons</span><span class="p">.</span><span class="nx">templateModel</span><span class="p">);</span>
<span class="p">}(</span><span class="k">this</span><span class="p">.</span><span class="nx">ux</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">ux</span> <span class="o">||</span> <span class="p">{},</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span><span class="k">return</span> <span class="k">this</span><span class="p">;}()));</span>
</pre></div>
        </td>
      </tr>
  </tbody>
</table>
  </div>
</body>
</html>
